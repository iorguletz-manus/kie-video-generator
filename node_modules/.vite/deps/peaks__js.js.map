{
  "version": 3,
  "sources": ["../../.pnpm/konva@10.0.11/node_modules/konva/lib/Global.js", "../../.pnpm/konva@10.0.11/node_modules/konva/lib/Util.js", "../../.pnpm/konva@10.0.11/node_modules/konva/lib/Context.js", "../../.pnpm/konva@10.0.11/node_modules/konva/lib/Canvas.js", "../../.pnpm/konva@10.0.11/node_modules/konva/lib/DragAndDrop.js", "../../.pnpm/konva@10.0.11/node_modules/konva/lib/Validators.js", "../../.pnpm/konva@10.0.11/node_modules/konva/lib/Factory.js", "../../.pnpm/konva@10.0.11/node_modules/konva/lib/Node.js", "../../.pnpm/konva@10.0.11/node_modules/konva/lib/Container.js", "../../.pnpm/konva@10.0.11/node_modules/konva/lib/PointerEvents.js", "../../.pnpm/konva@10.0.11/node_modules/konva/lib/Stage.js", "../../.pnpm/konva@10.0.11/node_modules/konva/lib/Shape.js", "../../.pnpm/konva@10.0.11/node_modules/konva/lib/Layer.js", "../../.pnpm/konva@10.0.11/node_modules/konva/lib/FastLayer.js", "../../.pnpm/konva@10.0.11/node_modules/konva/lib/Group.js", "../../.pnpm/konva@10.0.11/node_modules/konva/lib/Animation.js", "../../.pnpm/konva@10.0.11/node_modules/konva/lib/Tween.js", "../../.pnpm/konva@10.0.11/node_modules/konva/lib/_CoreInternals.js", "../../.pnpm/konva@10.0.11/node_modules/konva/lib/Core.js", "../../.pnpm/konva@10.0.11/node_modules/konva/lib/shapes/Line.js", "../../.pnpm/konva@10.0.11/node_modules/konva/lib/shapes/Rect.js", "../../.pnpm/konva@10.0.11/node_modules/konva/lib/shapes/Text.js", "../../.pnpm/waveform-data@4.5.2/node_modules/waveform-data/dist/waveform-data.esm.js", "../../.pnpm/peaks.js@4.0.0_konva@10.0.11_waveform-data@4.5.2/node_modules/peaks.js/dist/peaks.esm.js"],
  "sourcesContent": ["const PI_OVER_180 = Math.PI / 180;\nfunction detectBrowser() {\n    return (typeof window !== 'undefined' &&\n        ({}.toString.call(window) === '[object Window]' ||\n            {}.toString.call(window) === '[object global]'));\n}\nexport const glob = typeof global !== 'undefined'\n    ? global\n    : typeof window !== 'undefined'\n        ? window\n        : typeof WorkerGlobalScope !== 'undefined'\n            ? self\n            : {};\nexport const Konva = {\n    _global: glob,\n    version: '10.0.11',\n    isBrowser: detectBrowser(),\n    isUnminified: /param/.test(function (param) { }.toString()),\n    dblClickWindow: 400,\n    getAngle(angle) {\n        return Konva.angleDeg ? angle * PI_OVER_180 : angle;\n    },\n    enableTrace: false,\n    pointerEventsEnabled: true,\n    autoDrawEnabled: true,\n    hitOnDragEnabled: false,\n    capturePointerEventsEnabled: false,\n    _mouseListenClick: false,\n    _touchListenClick: false,\n    _pointerListenClick: false,\n    _mouseInDblClickWindow: false,\n    _touchInDblClickWindow: false,\n    _pointerInDblClickWindow: false,\n    _mouseDblClickPointerId: null,\n    _touchDblClickPointerId: null,\n    _pointerDblClickPointerId: null,\n    _renderBackend: 'web',\n    legacyTextRendering: false,\n    pixelRatio: (typeof window !== 'undefined' && window.devicePixelRatio) || 1,\n    dragDistance: 3,\n    angleDeg: true,\n    showWarnings: true,\n    dragButtons: [0, 1],\n    isDragging() {\n        return Konva['DD'].isDragging;\n    },\n    isTransforming() {\n        var _a, _b;\n        return (_b = (_a = Konva['Transformer']) === null || _a === void 0 ? void 0 : _a.isTransforming()) !== null && _b !== void 0 ? _b : false;\n    },\n    isDragReady() {\n        return !!Konva['DD'].node;\n    },\n    releaseCanvasOnDestroy: true,\n    document: glob.document,\n    _injectGlobal(Konva) {\n        if (typeof glob.Konva !== 'undefined') {\n            console.error('Several Konva instances detected. It is not recommended to use multiple Konva instances in the same environment.');\n        }\n        glob.Konva = Konva;\n    },\n};\nexport const _registerNode = (NodeClass) => {\n    Konva[NodeClass.prototype.getClassName()] = NodeClass;\n};\nKonva._injectGlobal(Konva);\n", "import { Konva } from \"./Global.js\";\nconst NODE_ERROR = `Konva.js unsupported environment.\n\nLooks like you are trying to use Konva.js in Node.js environment. because \"document\" object is undefined.\n\nTo use Konva.js in Node.js environment, you need to use the \"canvas-backend\" or \"skia-backend\" module.\n\nbash: npm install canvas\njs: import \"konva/canvas-backend\";\n\nor\n\nbash: npm install skia-canvas\njs: import \"konva/skia-backend\";\n`;\nconst ensureBrowser = () => {\n    if (typeof document === 'undefined') {\n        throw new Error(NODE_ERROR);\n    }\n};\nexport class Transform {\n    constructor(m = [1, 0, 0, 1, 0, 0]) {\n        this.dirty = false;\n        this.m = (m && m.slice()) || [1, 0, 0, 1, 0, 0];\n    }\n    reset() {\n        this.m[0] = 1;\n        this.m[1] = 0;\n        this.m[2] = 0;\n        this.m[3] = 1;\n        this.m[4] = 0;\n        this.m[5] = 0;\n    }\n    copy() {\n        return new Transform(this.m);\n    }\n    copyInto(tr) {\n        tr.m[0] = this.m[0];\n        tr.m[1] = this.m[1];\n        tr.m[2] = this.m[2];\n        tr.m[3] = this.m[3];\n        tr.m[4] = this.m[4];\n        tr.m[5] = this.m[5];\n    }\n    point(point) {\n        const m = this.m;\n        return {\n            x: m[0] * point.x + m[2] * point.y + m[4],\n            y: m[1] * point.x + m[3] * point.y + m[5],\n        };\n    }\n    translate(x, y) {\n        this.m[4] += this.m[0] * x + this.m[2] * y;\n        this.m[5] += this.m[1] * x + this.m[3] * y;\n        return this;\n    }\n    scale(sx, sy) {\n        this.m[0] *= sx;\n        this.m[1] *= sx;\n        this.m[2] *= sy;\n        this.m[3] *= sy;\n        return this;\n    }\n    rotate(rad) {\n        const c = Math.cos(rad);\n        const s = Math.sin(rad);\n        const m11 = this.m[0] * c + this.m[2] * s;\n        const m12 = this.m[1] * c + this.m[3] * s;\n        const m21 = this.m[0] * -s + this.m[2] * c;\n        const m22 = this.m[1] * -s + this.m[3] * c;\n        this.m[0] = m11;\n        this.m[1] = m12;\n        this.m[2] = m21;\n        this.m[3] = m22;\n        return this;\n    }\n    getTranslation() {\n        return {\n            x: this.m[4],\n            y: this.m[5],\n        };\n    }\n    skew(sx, sy) {\n        const m11 = this.m[0] + this.m[2] * sy;\n        const m12 = this.m[1] + this.m[3] * sy;\n        const m21 = this.m[2] + this.m[0] * sx;\n        const m22 = this.m[3] + this.m[1] * sx;\n        this.m[0] = m11;\n        this.m[1] = m12;\n        this.m[2] = m21;\n        this.m[3] = m22;\n        return this;\n    }\n    multiply(matrix) {\n        const m11 = this.m[0] * matrix.m[0] + this.m[2] * matrix.m[1];\n        const m12 = this.m[1] * matrix.m[0] + this.m[3] * matrix.m[1];\n        const m21 = this.m[0] * matrix.m[2] + this.m[2] * matrix.m[3];\n        const m22 = this.m[1] * matrix.m[2] + this.m[3] * matrix.m[3];\n        const dx = this.m[0] * matrix.m[4] + this.m[2] * matrix.m[5] + this.m[4];\n        const dy = this.m[1] * matrix.m[4] + this.m[3] * matrix.m[5] + this.m[5];\n        this.m[0] = m11;\n        this.m[1] = m12;\n        this.m[2] = m21;\n        this.m[3] = m22;\n        this.m[4] = dx;\n        this.m[5] = dy;\n        return this;\n    }\n    invert() {\n        const d = 1 / (this.m[0] * this.m[3] - this.m[1] * this.m[2]);\n        const m0 = this.m[3] * d;\n        const m1 = -this.m[1] * d;\n        const m2 = -this.m[2] * d;\n        const m3 = this.m[0] * d;\n        const m4 = d * (this.m[2] * this.m[5] - this.m[3] * this.m[4]);\n        const m5 = d * (this.m[1] * this.m[4] - this.m[0] * this.m[5]);\n        this.m[0] = m0;\n        this.m[1] = m1;\n        this.m[2] = m2;\n        this.m[3] = m3;\n        this.m[4] = m4;\n        this.m[5] = m5;\n        return this;\n    }\n    getMatrix() {\n        return this.m;\n    }\n    decompose() {\n        const a = this.m[0];\n        const b = this.m[1];\n        const c = this.m[2];\n        const d = this.m[3];\n        const e = this.m[4];\n        const f = this.m[5];\n        const delta = a * d - b * c;\n        const result = {\n            x: e,\n            y: f,\n            rotation: 0,\n            scaleX: 0,\n            scaleY: 0,\n            skewX: 0,\n            skewY: 0,\n        };\n        if (a != 0 || b != 0) {\n            const r = Math.sqrt(a * a + b * b);\n            result.rotation = b > 0 ? Math.acos(a / r) : -Math.acos(a / r);\n            result.scaleX = r;\n            result.scaleY = delta / r;\n            result.skewX = (a * c + b * d) / delta;\n            result.skewY = 0;\n        }\n        else if (c != 0 || d != 0) {\n            const s = Math.sqrt(c * c + d * d);\n            result.rotation =\n                Math.PI / 2 - (d > 0 ? Math.acos(-c / s) : -Math.acos(c / s));\n            result.scaleX = delta / s;\n            result.scaleY = s;\n            result.skewX = 0;\n            result.skewY = (a * c + b * d) / delta;\n        }\n        else {\n        }\n        result.rotation = Util._getRotation(result.rotation);\n        return result;\n    }\n}\nconst OBJECT_ARRAY = '[object Array]', OBJECT_NUMBER = '[object Number]', OBJECT_STRING = '[object String]', OBJECT_BOOLEAN = '[object Boolean]', PI_OVER_DEG180 = Math.PI / 180, DEG180_OVER_PI = 180 / Math.PI, HASH = '#', EMPTY_STRING = '', ZERO = '0', KONVA_WARNING = 'Konva warning: ', KONVA_ERROR = 'Konva error: ', RGB_PAREN = 'rgb(', COLORS = {\n    aliceblue: [240, 248, 255],\n    antiquewhite: [250, 235, 215],\n    aqua: [0, 255, 255],\n    aquamarine: [127, 255, 212],\n    azure: [240, 255, 255],\n    beige: [245, 245, 220],\n    bisque: [255, 228, 196],\n    black: [0, 0, 0],\n    blanchedalmond: [255, 235, 205],\n    blue: [0, 0, 255],\n    blueviolet: [138, 43, 226],\n    brown: [165, 42, 42],\n    burlywood: [222, 184, 135],\n    cadetblue: [95, 158, 160],\n    chartreuse: [127, 255, 0],\n    chocolate: [210, 105, 30],\n    coral: [255, 127, 80],\n    cornflowerblue: [100, 149, 237],\n    cornsilk: [255, 248, 220],\n    crimson: [220, 20, 60],\n    cyan: [0, 255, 255],\n    darkblue: [0, 0, 139],\n    darkcyan: [0, 139, 139],\n    darkgoldenrod: [184, 132, 11],\n    darkgray: [169, 169, 169],\n    darkgreen: [0, 100, 0],\n    darkgrey: [169, 169, 169],\n    darkkhaki: [189, 183, 107],\n    darkmagenta: [139, 0, 139],\n    darkolivegreen: [85, 107, 47],\n    darkorange: [255, 140, 0],\n    darkorchid: [153, 50, 204],\n    darkred: [139, 0, 0],\n    darksalmon: [233, 150, 122],\n    darkseagreen: [143, 188, 143],\n    darkslateblue: [72, 61, 139],\n    darkslategray: [47, 79, 79],\n    darkslategrey: [47, 79, 79],\n    darkturquoise: [0, 206, 209],\n    darkviolet: [148, 0, 211],\n    deeppink: [255, 20, 147],\n    deepskyblue: [0, 191, 255],\n    dimgray: [105, 105, 105],\n    dimgrey: [105, 105, 105],\n    dodgerblue: [30, 144, 255],\n    firebrick: [178, 34, 34],\n    floralwhite: [255, 255, 240],\n    forestgreen: [34, 139, 34],\n    fuchsia: [255, 0, 255],\n    gainsboro: [220, 220, 220],\n    ghostwhite: [248, 248, 255],\n    gold: [255, 215, 0],\n    goldenrod: [218, 165, 32],\n    gray: [128, 128, 128],\n    green: [0, 128, 0],\n    greenyellow: [173, 255, 47],\n    grey: [128, 128, 128],\n    honeydew: [240, 255, 240],\n    hotpink: [255, 105, 180],\n    indianred: [205, 92, 92],\n    indigo: [75, 0, 130],\n    ivory: [255, 255, 240],\n    khaki: [240, 230, 140],\n    lavender: [230, 230, 250],\n    lavenderblush: [255, 240, 245],\n    lawngreen: [124, 252, 0],\n    lemonchiffon: [255, 250, 205],\n    lightblue: [173, 216, 230],\n    lightcoral: [240, 128, 128],\n    lightcyan: [224, 255, 255],\n    lightgoldenrodyellow: [250, 250, 210],\n    lightgray: [211, 211, 211],\n    lightgreen: [144, 238, 144],\n    lightgrey: [211, 211, 211],\n    lightpink: [255, 182, 193],\n    lightsalmon: [255, 160, 122],\n    lightseagreen: [32, 178, 170],\n    lightskyblue: [135, 206, 250],\n    lightslategray: [119, 136, 153],\n    lightslategrey: [119, 136, 153],\n    lightsteelblue: [176, 196, 222],\n    lightyellow: [255, 255, 224],\n    lime: [0, 255, 0],\n    limegreen: [50, 205, 50],\n    linen: [250, 240, 230],\n    magenta: [255, 0, 255],\n    maroon: [128, 0, 0],\n    mediumaquamarine: [102, 205, 170],\n    mediumblue: [0, 0, 205],\n    mediumorchid: [186, 85, 211],\n    mediumpurple: [147, 112, 219],\n    mediumseagreen: [60, 179, 113],\n    mediumslateblue: [123, 104, 238],\n    mediumspringgreen: [0, 250, 154],\n    mediumturquoise: [72, 209, 204],\n    mediumvioletred: [199, 21, 133],\n    midnightblue: [25, 25, 112],\n    mintcream: [245, 255, 250],\n    mistyrose: [255, 228, 225],\n    moccasin: [255, 228, 181],\n    navajowhite: [255, 222, 173],\n    navy: [0, 0, 128],\n    oldlace: [253, 245, 230],\n    olive: [128, 128, 0],\n    olivedrab: [107, 142, 35],\n    orange: [255, 165, 0],\n    orangered: [255, 69, 0],\n    orchid: [218, 112, 214],\n    palegoldenrod: [238, 232, 170],\n    palegreen: [152, 251, 152],\n    paleturquoise: [175, 238, 238],\n    palevioletred: [219, 112, 147],\n    papayawhip: [255, 239, 213],\n    peachpuff: [255, 218, 185],\n    peru: [205, 133, 63],\n    pink: [255, 192, 203],\n    plum: [221, 160, 203],\n    powderblue: [176, 224, 230],\n    purple: [128, 0, 128],\n    rebeccapurple: [102, 51, 153],\n    red: [255, 0, 0],\n    rosybrown: [188, 143, 143],\n    royalblue: [65, 105, 225],\n    saddlebrown: [139, 69, 19],\n    salmon: [250, 128, 114],\n    sandybrown: [244, 164, 96],\n    seagreen: [46, 139, 87],\n    seashell: [255, 245, 238],\n    sienna: [160, 82, 45],\n    silver: [192, 192, 192],\n    skyblue: [135, 206, 235],\n    slateblue: [106, 90, 205],\n    slategray: [119, 128, 144],\n    slategrey: [119, 128, 144],\n    snow: [255, 255, 250],\n    springgreen: [0, 255, 127],\n    steelblue: [70, 130, 180],\n    tan: [210, 180, 140],\n    teal: [0, 128, 128],\n    thistle: [216, 191, 216],\n    transparent: [255, 255, 255, 0],\n    tomato: [255, 99, 71],\n    turquoise: [64, 224, 208],\n    violet: [238, 130, 238],\n    wheat: [245, 222, 179],\n    white: [255, 255, 255],\n    whitesmoke: [245, 245, 245],\n    yellow: [255, 255, 0],\n    yellowgreen: [154, 205, 5],\n}, RGB_REGEX = /rgb\\((\\d{1,3}),(\\d{1,3}),(\\d{1,3})\\)/;\nlet animQueue = [];\nlet _isCanvasFarblingActive = null;\nconst req = (typeof requestAnimationFrame !== 'undefined' && requestAnimationFrame) ||\n    function (f) {\n        setTimeout(f, 60);\n    };\nexport const Util = {\n    _isElement(obj) {\n        return !!(obj && obj.nodeType == 1);\n    },\n    _isFunction(obj) {\n        return !!(obj && obj.constructor && obj.call && obj.apply);\n    },\n    _isPlainObject(obj) {\n        return !!obj && obj.constructor === Object;\n    },\n    _isArray(obj) {\n        return Object.prototype.toString.call(obj) === OBJECT_ARRAY;\n    },\n    _isNumber(obj) {\n        return (Object.prototype.toString.call(obj) === OBJECT_NUMBER &&\n            !isNaN(obj) &&\n            isFinite(obj));\n    },\n    _isString(obj) {\n        return Object.prototype.toString.call(obj) === OBJECT_STRING;\n    },\n    _isBoolean(obj) {\n        return Object.prototype.toString.call(obj) === OBJECT_BOOLEAN;\n    },\n    isObject(val) {\n        return val instanceof Object;\n    },\n    isValidSelector(selector) {\n        if (typeof selector !== 'string') {\n            return false;\n        }\n        const firstChar = selector[0];\n        return (firstChar === '#' ||\n            firstChar === '.' ||\n            firstChar === firstChar.toUpperCase());\n    },\n    _sign(number) {\n        if (number === 0) {\n            return 1;\n        }\n        if (number > 0) {\n            return 1;\n        }\n        else {\n            return -1;\n        }\n    },\n    requestAnimFrame(callback) {\n        animQueue.push(callback);\n        if (animQueue.length === 1) {\n            req(function () {\n                const queue = animQueue;\n                animQueue = [];\n                queue.forEach(function (cb) {\n                    cb();\n                });\n            });\n        }\n    },\n    createCanvasElement() {\n        ensureBrowser();\n        const canvas = document.createElement('canvas');\n        try {\n            canvas.style = canvas.style || {};\n        }\n        catch (e) { }\n        return canvas;\n    },\n    createImageElement() {\n        ensureBrowser();\n        return document.createElement('img');\n    },\n    _isInDocument(el) {\n        while ((el = el.parentNode)) {\n            if (el == document) {\n                return true;\n            }\n        }\n        return false;\n    },\n    _urlToImage(url, callback) {\n        const imageObj = Util.createImageElement();\n        imageObj.onload = function () {\n            callback(imageObj);\n        };\n        imageObj.src = url;\n    },\n    _rgbToHex(r, g, b) {\n        return ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);\n    },\n    _hexToRgb(hex) {\n        hex = hex.replace(HASH, EMPTY_STRING);\n        const bigint = parseInt(hex, 16);\n        return {\n            r: (bigint >> 16) & 255,\n            g: (bigint >> 8) & 255,\n            b: bigint & 255,\n        };\n    },\n    getRandomColor() {\n        let randColor = ((Math.random() * 0xffffff) << 0).toString(16);\n        while (randColor.length < 6) {\n            randColor = ZERO + randColor;\n        }\n        return HASH + randColor;\n    },\n    isCanvasFarblingActive() {\n        if (_isCanvasFarblingActive !== null) {\n            return _isCanvasFarblingActive;\n        }\n        if (typeof document === 'undefined') {\n            _isCanvasFarblingActive = false;\n            return false;\n        }\n        const c = this.createCanvasElement();\n        c.width = 1;\n        c.height = 1;\n        const ctx = c.getContext('2d', {\n            willReadFrequently: true,\n        });\n        ctx.clearRect(0, 0, 1, 1);\n        ctx.fillStyle = 'rgba(255,0,255,1)';\n        ctx.fillRect(0, 0, 1, 1);\n        const d = ctx.getImageData(0, 0, 1, 1).data;\n        const exact = d[0] === 255 && d[1] === 0 && d[2] === 255 && d[3] === 255;\n        _isCanvasFarblingActive = !exact;\n        this.releaseCanvas(c);\n        return _isCanvasFarblingActive;\n    },\n    getHitColor() {\n        const color = this.getRandomColor();\n        return this.isCanvasFarblingActive()\n            ? this.getSnappedHexColor(color)\n            : color;\n    },\n    getHitColorKey(r, g, b) {\n        if (this.isCanvasFarblingActive()) {\n            r = Math.round(r / 5) * 5;\n            g = Math.round(g / 5) * 5;\n            b = Math.round(b / 5) * 5;\n        }\n        return HASH + this._rgbToHex(r, g, b);\n    },\n    getSnappedHexColor(hex) {\n        const rgb = this._hexToRgb(hex);\n        return (HASH +\n            this._rgbToHex(Math.round(rgb.r / 5) * 5, Math.round(rgb.g / 5) * 5, Math.round(rgb.b / 5) * 5));\n    },\n    getRGB(color) {\n        let rgb;\n        if (color in COLORS) {\n            rgb = COLORS[color];\n            return {\n                r: rgb[0],\n                g: rgb[1],\n                b: rgb[2],\n            };\n        }\n        else if (color[0] === HASH) {\n            return this._hexToRgb(color.substring(1));\n        }\n        else if (color.substr(0, 4) === RGB_PAREN) {\n            rgb = RGB_REGEX.exec(color.replace(/ /g, ''));\n            return {\n                r: parseInt(rgb[1], 10),\n                g: parseInt(rgb[2], 10),\n                b: parseInt(rgb[3], 10),\n            };\n        }\n        else {\n            return {\n                r: 0,\n                g: 0,\n                b: 0,\n            };\n        }\n    },\n    colorToRGBA(str) {\n        str = str || 'black';\n        return (Util._namedColorToRBA(str) ||\n            Util._hex3ColorToRGBA(str) ||\n            Util._hex4ColorToRGBA(str) ||\n            Util._hex6ColorToRGBA(str) ||\n            Util._hex8ColorToRGBA(str) ||\n            Util._rgbColorToRGBA(str) ||\n            Util._rgbaColorToRGBA(str) ||\n            Util._hslColorToRGBA(str));\n    },\n    _namedColorToRBA(str) {\n        const c = COLORS[str.toLowerCase()];\n        if (!c) {\n            return null;\n        }\n        return {\n            r: c[0],\n            g: c[1],\n            b: c[2],\n            a: 1,\n        };\n    },\n    _rgbColorToRGBA(str) {\n        if (str.indexOf('rgb(') === 0) {\n            str = str.match(/rgb\\(([^)]+)\\)/)[1];\n            const parts = str.split(/ *, */).map(Number);\n            return {\n                r: parts[0],\n                g: parts[1],\n                b: parts[2],\n                a: 1,\n            };\n        }\n    },\n    _rgbaColorToRGBA(str) {\n        if (str.indexOf('rgba(') === 0) {\n            str = str.match(/rgba\\(([^)]+)\\)/)[1];\n            const parts = str.split(/ *, */).map((n, index) => {\n                if (n.slice(-1) === '%') {\n                    return index === 3 ? parseInt(n) / 100 : (parseInt(n) / 100) * 255;\n                }\n                return Number(n);\n            });\n            return {\n                r: parts[0],\n                g: parts[1],\n                b: parts[2],\n                a: parts[3],\n            };\n        }\n    },\n    _hex8ColorToRGBA(str) {\n        if (str[0] === '#' && str.length === 9) {\n            return {\n                r: parseInt(str.slice(1, 3), 16),\n                g: parseInt(str.slice(3, 5), 16),\n                b: parseInt(str.slice(5, 7), 16),\n                a: parseInt(str.slice(7, 9), 16) / 0xff,\n            };\n        }\n    },\n    _hex6ColorToRGBA(str) {\n        if (str[0] === '#' && str.length === 7) {\n            return {\n                r: parseInt(str.slice(1, 3), 16),\n                g: parseInt(str.slice(3, 5), 16),\n                b: parseInt(str.slice(5, 7), 16),\n                a: 1,\n            };\n        }\n    },\n    _hex4ColorToRGBA(str) {\n        if (str[0] === '#' && str.length === 5) {\n            return {\n                r: parseInt(str[1] + str[1], 16),\n                g: parseInt(str[2] + str[2], 16),\n                b: parseInt(str[3] + str[3], 16),\n                a: parseInt(str[4] + str[4], 16) / 0xff,\n            };\n        }\n    },\n    _hex3ColorToRGBA(str) {\n        if (str[0] === '#' && str.length === 4) {\n            return {\n                r: parseInt(str[1] + str[1], 16),\n                g: parseInt(str[2] + str[2], 16),\n                b: parseInt(str[3] + str[3], 16),\n                a: 1,\n            };\n        }\n    },\n    _hslColorToRGBA(str) {\n        if (/hsl\\((\\d+),\\s*([\\d.]+)%,\\s*([\\d.]+)%\\)/g.test(str)) {\n            const [_, ...hsl] = /hsl\\((\\d+),\\s*([\\d.]+)%,\\s*([\\d.]+)%\\)/g.exec(str);\n            const h = Number(hsl[0]) / 360;\n            const s = Number(hsl[1]) / 100;\n            const l = Number(hsl[2]) / 100;\n            let t2;\n            let t3;\n            let val;\n            if (s === 0) {\n                val = l * 255;\n                return {\n                    r: Math.round(val),\n                    g: Math.round(val),\n                    b: Math.round(val),\n                    a: 1,\n                };\n            }\n            if (l < 0.5) {\n                t2 = l * (1 + s);\n            }\n            else {\n                t2 = l + s - l * s;\n            }\n            const t1 = 2 * l - t2;\n            const rgb = [0, 0, 0];\n            for (let i = 0; i < 3; i++) {\n                t3 = h + (1 / 3) * -(i - 1);\n                if (t3 < 0) {\n                    t3++;\n                }\n                if (t3 > 1) {\n                    t3--;\n                }\n                if (6 * t3 < 1) {\n                    val = t1 + (t2 - t1) * 6 * t3;\n                }\n                else if (2 * t3 < 1) {\n                    val = t2;\n                }\n                else if (3 * t3 < 2) {\n                    val = t1 + (t2 - t1) * (2 / 3 - t3) * 6;\n                }\n                else {\n                    val = t1;\n                }\n                rgb[i] = val * 255;\n            }\n            return {\n                r: Math.round(rgb[0]),\n                g: Math.round(rgb[1]),\n                b: Math.round(rgb[2]),\n                a: 1,\n            };\n        }\n    },\n    haveIntersection(r1, r2) {\n        return !(r2.x > r1.x + r1.width ||\n            r2.x + r2.width < r1.x ||\n            r2.y > r1.y + r1.height ||\n            r2.y + r2.height < r1.y);\n    },\n    cloneObject(obj) {\n        const retObj = {};\n        for (const key in obj) {\n            if (this._isPlainObject(obj[key])) {\n                retObj[key] = this.cloneObject(obj[key]);\n            }\n            else if (this._isArray(obj[key])) {\n                retObj[key] = this.cloneArray(obj[key]);\n            }\n            else {\n                retObj[key] = obj[key];\n            }\n        }\n        return retObj;\n    },\n    cloneArray(arr) {\n        return arr.slice(0);\n    },\n    degToRad(deg) {\n        return deg * PI_OVER_DEG180;\n    },\n    radToDeg(rad) {\n        return rad * DEG180_OVER_PI;\n    },\n    _degToRad(deg) {\n        Util.warn('Util._degToRad is removed. Please use public Util.degToRad instead.');\n        return Util.degToRad(deg);\n    },\n    _radToDeg(rad) {\n        Util.warn('Util._radToDeg is removed. Please use public Util.radToDeg instead.');\n        return Util.radToDeg(rad);\n    },\n    _getRotation(radians) {\n        return Konva.angleDeg ? Util.radToDeg(radians) : radians;\n    },\n    _capitalize(str) {\n        return str.charAt(0).toUpperCase() + str.slice(1);\n    },\n    throw(str) {\n        throw new Error(KONVA_ERROR + str);\n    },\n    error(str) {\n        console.error(KONVA_ERROR + str);\n    },\n    warn(str) {\n        if (!Konva.showWarnings) {\n            return;\n        }\n        console.warn(KONVA_WARNING + str);\n    },\n    each(obj, func) {\n        for (const key in obj) {\n            func(key, obj[key]);\n        }\n    },\n    _inRange(val, left, right) {\n        return left <= val && val < right;\n    },\n    _getProjectionToSegment(x1, y1, x2, y2, x3, y3) {\n        let x, y, dist;\n        const pd2 = (x1 - x2) * (x1 - x2) + (y1 - y2) * (y1 - y2);\n        if (pd2 == 0) {\n            x = x1;\n            y = y1;\n            dist = (x3 - x2) * (x3 - x2) + (y3 - y2) * (y3 - y2);\n        }\n        else {\n            const u = ((x3 - x1) * (x2 - x1) + (y3 - y1) * (y2 - y1)) / pd2;\n            if (u < 0) {\n                x = x1;\n                y = y1;\n                dist = (x1 - x3) * (x1 - x3) + (y1 - y3) * (y1 - y3);\n            }\n            else if (u > 1.0) {\n                x = x2;\n                y = y2;\n                dist = (x2 - x3) * (x2 - x3) + (y2 - y3) * (y2 - y3);\n            }\n            else {\n                x = x1 + u * (x2 - x1);\n                y = y1 + u * (y2 - y1);\n                dist = (x - x3) * (x - x3) + (y - y3) * (y - y3);\n            }\n        }\n        return [x, y, dist];\n    },\n    _getProjectionToLine(pt, line, isClosed) {\n        const pc = Util.cloneObject(pt);\n        let dist = Number.MAX_VALUE;\n        line.forEach(function (p1, i) {\n            if (!isClosed && i === line.length - 1) {\n                return;\n            }\n            const p2 = line[(i + 1) % line.length];\n            const proj = Util._getProjectionToSegment(p1.x, p1.y, p2.x, p2.y, pt.x, pt.y);\n            const px = proj[0], py = proj[1], pdist = proj[2];\n            if (pdist < dist) {\n                pc.x = px;\n                pc.y = py;\n                dist = pdist;\n            }\n        });\n        return pc;\n    },\n    _prepareArrayForTween(startArray, endArray, isClosed) {\n        const start = [], end = [];\n        if (startArray.length > endArray.length) {\n            const temp = endArray;\n            endArray = startArray;\n            startArray = temp;\n        }\n        for (let n = 0; n < startArray.length; n += 2) {\n            start.push({\n                x: startArray[n],\n                y: startArray[n + 1],\n            });\n        }\n        for (let n = 0; n < endArray.length; n += 2) {\n            end.push({\n                x: endArray[n],\n                y: endArray[n + 1],\n            });\n        }\n        const newStart = [];\n        end.forEach(function (point) {\n            const pr = Util._getProjectionToLine(point, start, isClosed);\n            newStart.push(pr.x);\n            newStart.push(pr.y);\n        });\n        return newStart;\n    },\n    _prepareToStringify(obj) {\n        let desc;\n        obj.visitedByCircularReferenceRemoval = true;\n        for (const key in obj) {\n            if (!(obj.hasOwnProperty(key) && obj[key] && typeof obj[key] == 'object')) {\n                continue;\n            }\n            desc = Object.getOwnPropertyDescriptor(obj, key);\n            if (obj[key].visitedByCircularReferenceRemoval ||\n                Util._isElement(obj[key])) {\n                if (desc.configurable) {\n                    delete obj[key];\n                }\n                else {\n                    return null;\n                }\n            }\n            else if (Util._prepareToStringify(obj[key]) === null) {\n                if (desc.configurable) {\n                    delete obj[key];\n                }\n                else {\n                    return null;\n                }\n            }\n        }\n        delete obj.visitedByCircularReferenceRemoval;\n        return obj;\n    },\n    _assign(target, source) {\n        for (const key in source) {\n            target[key] = source[key];\n        }\n        return target;\n    },\n    _getFirstPointerId(evt) {\n        if (!evt.touches) {\n            return evt.pointerId || 999;\n        }\n        else {\n            return evt.changedTouches[0].identifier;\n        }\n    },\n    releaseCanvas(...canvases) {\n        if (!Konva.releaseCanvasOnDestroy)\n            return;\n        canvases.forEach((c) => {\n            c.width = 0;\n            c.height = 0;\n        });\n    },\n    drawRoundedRectPath(context, width, height, cornerRadius) {\n        let xOrigin = width < 0 ? width : 0;\n        let yOrigin = height < 0 ? height : 0;\n        width = Math.abs(width);\n        height = Math.abs(height);\n        let topLeft = 0;\n        let topRight = 0;\n        let bottomLeft = 0;\n        let bottomRight = 0;\n        if (typeof cornerRadius === 'number') {\n            topLeft =\n                topRight =\n                    bottomLeft =\n                        bottomRight =\n                            Math.min(cornerRadius, width / 2, height / 2);\n        }\n        else {\n            topLeft = Math.min(cornerRadius[0] || 0, width / 2, height / 2);\n            topRight = Math.min(cornerRadius[1] || 0, width / 2, height / 2);\n            bottomRight = Math.min(cornerRadius[2] || 0, width / 2, height / 2);\n            bottomLeft = Math.min(cornerRadius[3] || 0, width / 2, height / 2);\n        }\n        context.moveTo(xOrigin + topLeft, yOrigin);\n        context.lineTo(xOrigin + width - topRight, yOrigin);\n        context.arc(xOrigin + width - topRight, yOrigin + topRight, topRight, (Math.PI * 3) / 2, 0, false);\n        context.lineTo(xOrigin + width, yOrigin + height - bottomRight);\n        context.arc(xOrigin + width - bottomRight, yOrigin + height - bottomRight, bottomRight, 0, Math.PI / 2, false);\n        context.lineTo(xOrigin + bottomLeft, yOrigin + height);\n        context.arc(xOrigin + bottomLeft, yOrigin + height - bottomLeft, bottomLeft, Math.PI / 2, Math.PI, false);\n        context.lineTo(xOrigin, yOrigin + topLeft);\n        context.arc(xOrigin + topLeft, yOrigin + topLeft, topLeft, Math.PI, (Math.PI * 3) / 2, false);\n    },\n    drawRoundedPolygonPath(context, points, sides, radius, cornerRadius) {\n        radius = Math.abs(radius);\n        for (let i = 0; i < sides; i++) {\n            const prev = points[(i - 1 + sides) % sides];\n            const curr = points[i];\n            const next = points[(i + 1) % sides];\n            const vec1 = { x: curr.x - prev.x, y: curr.y - prev.y };\n            const vec2 = { x: next.x - curr.x, y: next.y - curr.y };\n            const len1 = Math.hypot(vec1.x, vec1.y);\n            const len2 = Math.hypot(vec2.x, vec2.y);\n            let currCornerRadius;\n            if (typeof cornerRadius === 'number') {\n                currCornerRadius = cornerRadius;\n            }\n            else {\n                currCornerRadius = i < cornerRadius.length ? cornerRadius[i] : 0;\n            }\n            const maxCornerRadius = radius * Math.cos(Math.PI / sides);\n            currCornerRadius =\n                maxCornerRadius * Math.min(1, (currCornerRadius / radius) * 2);\n            const normalVec1 = { x: vec1.x / len1, y: vec1.y / len1 };\n            const normalVec2 = { x: vec2.x / len2, y: vec2.y / len2 };\n            const p1 = {\n                x: curr.x - normalVec1.x * currCornerRadius,\n                y: curr.y - normalVec1.y * currCornerRadius,\n            };\n            const p2 = {\n                x: curr.x + normalVec2.x * currCornerRadius,\n                y: curr.y + normalVec2.y * currCornerRadius,\n            };\n            if (i === 0) {\n                context.moveTo(p1.x, p1.y);\n            }\n            else {\n                context.lineTo(p1.x, p1.y);\n            }\n            context.arcTo(curr.x, curr.y, p2.x, p2.y, currCornerRadius);\n        }\n    },\n};\n", "import { Util } from \"./Util.js\";\nimport { Konva } from \"./Global.js\";\nfunction simplifyArray(arr) {\n    const retArr = [], len = arr.length, util = Util;\n    for (let n = 0; n < len; n++) {\n        let val = arr[n];\n        if (util._isNumber(val)) {\n            val = Math.round(val * 1000) / 1000;\n        }\n        else if (!util._isString(val)) {\n            val = val + '';\n        }\n        retArr.push(val);\n    }\n    return retArr;\n}\nconst COMMA = ',', OPEN_PAREN = '(', CLOSE_PAREN = ')', OPEN_PAREN_BRACKET = '([', CLOSE_BRACKET_PAREN = '])', SEMICOLON = ';', DOUBLE_PAREN = '()', EQUALS = '=', CONTEXT_METHODS = [\n    'arc',\n    'arcTo',\n    'beginPath',\n    'bezierCurveTo',\n    'clearRect',\n    'clip',\n    'closePath',\n    'createLinearGradient',\n    'createPattern',\n    'createRadialGradient',\n    'drawImage',\n    'ellipse',\n    'fill',\n    'fillText',\n    'getImageData',\n    'createImageData',\n    'lineTo',\n    'moveTo',\n    'putImageData',\n    'quadraticCurveTo',\n    'rect',\n    'roundRect',\n    'restore',\n    'rotate',\n    'save',\n    'scale',\n    'setLineDash',\n    'setTransform',\n    'stroke',\n    'strokeText',\n    'transform',\n    'translate',\n];\nconst CONTEXT_PROPERTIES = [\n    'fillStyle',\n    'strokeStyle',\n    'shadowColor',\n    'shadowBlur',\n    'shadowOffsetX',\n    'shadowOffsetY',\n    'letterSpacing',\n    'lineCap',\n    'lineDashOffset',\n    'lineJoin',\n    'lineWidth',\n    'miterLimit',\n    'direction',\n    'font',\n    'textAlign',\n    'textBaseline',\n    'globalAlpha',\n    'globalCompositeOperation',\n    'imageSmoothingEnabled',\n    'filter',\n];\nconst traceArrMax = 100;\nlet _cssFiltersSupported = null;\nexport function isCSSFiltersSupported() {\n    if (_cssFiltersSupported !== null) {\n        return _cssFiltersSupported;\n    }\n    try {\n        const canvas = Util.createCanvasElement();\n        const ctx = canvas.getContext('2d');\n        if (!ctx) {\n            _cssFiltersSupported = false;\n            return false;\n        }\n        return !!ctx && 'filter' in ctx;\n    }\n    catch (e) {\n        _cssFiltersSupported = false;\n        return false;\n    }\n}\nexport class Context {\n    constructor(canvas) {\n        this.canvas = canvas;\n        if (Konva.enableTrace) {\n            this.traceArr = [];\n            this._enableTrace();\n        }\n    }\n    fillShape(shape) {\n        if (shape.fillEnabled()) {\n            this._fill(shape);\n        }\n    }\n    _fill(shape) {\n    }\n    strokeShape(shape) {\n        if (shape.hasStroke()) {\n            this._stroke(shape);\n        }\n    }\n    _stroke(shape) {\n    }\n    fillStrokeShape(shape) {\n        if (shape.attrs.fillAfterStrokeEnabled) {\n            this.strokeShape(shape);\n            this.fillShape(shape);\n        }\n        else {\n            this.fillShape(shape);\n            this.strokeShape(shape);\n        }\n    }\n    getTrace(relaxed, rounded) {\n        let traceArr = this.traceArr, len = traceArr.length, str = '', n, trace, method, args;\n        for (n = 0; n < len; n++) {\n            trace = traceArr[n];\n            method = trace.method;\n            if (method) {\n                args = trace.args;\n                str += method;\n                if (relaxed) {\n                    str += DOUBLE_PAREN;\n                }\n                else {\n                    if (Util._isArray(args[0])) {\n                        str += OPEN_PAREN_BRACKET + args.join(COMMA) + CLOSE_BRACKET_PAREN;\n                    }\n                    else {\n                        if (rounded) {\n                            args = args.map((a) => typeof a === 'number' ? Math.floor(a) : a);\n                        }\n                        str += OPEN_PAREN + args.join(COMMA) + CLOSE_PAREN;\n                    }\n                }\n            }\n            else {\n                str += trace.property;\n                if (!relaxed) {\n                    str += EQUALS + trace.val;\n                }\n            }\n            str += SEMICOLON;\n        }\n        return str;\n    }\n    clearTrace() {\n        this.traceArr = [];\n    }\n    _trace(str) {\n        let traceArr = this.traceArr, len;\n        traceArr.push(str);\n        len = traceArr.length;\n        if (len >= traceArrMax) {\n            traceArr.shift();\n        }\n    }\n    reset() {\n        const pixelRatio = this.getCanvas().getPixelRatio();\n        this.setTransform(1 * pixelRatio, 0, 0, 1 * pixelRatio, 0, 0);\n    }\n    getCanvas() {\n        return this.canvas;\n    }\n    clear(bounds) {\n        const canvas = this.getCanvas();\n        if (bounds) {\n            this.clearRect(bounds.x || 0, bounds.y || 0, bounds.width || 0, bounds.height || 0);\n        }\n        else {\n            this.clearRect(0, 0, canvas.getWidth() / canvas.pixelRatio, canvas.getHeight() / canvas.pixelRatio);\n        }\n    }\n    _applyLineCap(shape) {\n        const lineCap = shape.attrs.lineCap;\n        if (lineCap) {\n            this.setAttr('lineCap', lineCap);\n        }\n    }\n    _applyOpacity(shape) {\n        const absOpacity = shape.getAbsoluteOpacity();\n        if (absOpacity !== 1) {\n            this.setAttr('globalAlpha', absOpacity);\n        }\n    }\n    _applyLineJoin(shape) {\n        const lineJoin = shape.attrs.lineJoin;\n        if (lineJoin) {\n            this.setAttr('lineJoin', lineJoin);\n        }\n    }\n    _applyMiterLimit(shape) {\n        const miterLimit = shape.attrs.miterLimit;\n        if (miterLimit != null) {\n            this.setAttr('miterLimit', miterLimit);\n        }\n    }\n    setAttr(attr, val) {\n        this._context[attr] = val;\n    }\n    arc(x, y, radius, startAngle, endAngle, counterClockwise) {\n        this._context.arc(x, y, radius, startAngle, endAngle, counterClockwise);\n    }\n    arcTo(x1, y1, x2, y2, radius) {\n        this._context.arcTo(x1, y1, x2, y2, radius);\n    }\n    beginPath() {\n        this._context.beginPath();\n    }\n    bezierCurveTo(cp1x, cp1y, cp2x, cp2y, x, y) {\n        this._context.bezierCurveTo(cp1x, cp1y, cp2x, cp2y, x, y);\n    }\n    clearRect(x, y, width, height) {\n        this._context.clearRect(x, y, width, height);\n    }\n    clip(...args) {\n        this._context.clip.apply(this._context, args);\n    }\n    closePath() {\n        this._context.closePath();\n    }\n    createImageData(width, height) {\n        const a = arguments;\n        if (a.length === 2) {\n            return this._context.createImageData(width, height);\n        }\n        else if (a.length === 1) {\n            return this._context.createImageData(width);\n        }\n    }\n    createLinearGradient(x0, y0, x1, y1) {\n        return this._context.createLinearGradient(x0, y0, x1, y1);\n    }\n    createPattern(image, repetition) {\n        return this._context.createPattern(image, repetition);\n    }\n    createRadialGradient(x0, y0, r0, x1, y1, r1) {\n        return this._context.createRadialGradient(x0, y0, r0, x1, y1, r1);\n    }\n    drawImage(image, sx, sy, sWidth, sHeight, dx, dy, dWidth, dHeight) {\n        const a = arguments, _context = this._context;\n        if (a.length === 3) {\n            _context.drawImage(image, sx, sy);\n        }\n        else if (a.length === 5) {\n            _context.drawImage(image, sx, sy, sWidth, sHeight);\n        }\n        else if (a.length === 9) {\n            _context.drawImage(image, sx, sy, sWidth, sHeight, dx, dy, dWidth, dHeight);\n        }\n    }\n    ellipse(x, y, radiusX, radiusY, rotation, startAngle, endAngle, counterclockwise) {\n        this._context.ellipse(x, y, radiusX, radiusY, rotation, startAngle, endAngle, counterclockwise);\n    }\n    isPointInPath(x, y, path, fillRule) {\n        if (path) {\n            return this._context.isPointInPath(path, x, y, fillRule);\n        }\n        return this._context.isPointInPath(x, y, fillRule);\n    }\n    fill(...args) {\n        this._context.fill.apply(this._context, args);\n    }\n    fillRect(x, y, width, height) {\n        this._context.fillRect(x, y, width, height);\n    }\n    strokeRect(x, y, width, height) {\n        this._context.strokeRect(x, y, width, height);\n    }\n    fillText(text, x, y, maxWidth) {\n        if (maxWidth) {\n            this._context.fillText(text, x, y, maxWidth);\n        }\n        else {\n            this._context.fillText(text, x, y);\n        }\n    }\n    measureText(text) {\n        return this._context.measureText(text);\n    }\n    getImageData(sx, sy, sw, sh) {\n        return this._context.getImageData(sx, sy, sw, sh);\n    }\n    lineTo(x, y) {\n        this._context.lineTo(x, y);\n    }\n    moveTo(x, y) {\n        this._context.moveTo(x, y);\n    }\n    rect(x, y, width, height) {\n        this._context.rect(x, y, width, height);\n    }\n    roundRect(x, y, width, height, radii) {\n        this._context.roundRect(x, y, width, height, radii);\n    }\n    putImageData(imageData, dx, dy) {\n        this._context.putImageData(imageData, dx, dy);\n    }\n    quadraticCurveTo(cpx, cpy, x, y) {\n        this._context.quadraticCurveTo(cpx, cpy, x, y);\n    }\n    restore() {\n        this._context.restore();\n    }\n    rotate(angle) {\n        this._context.rotate(angle);\n    }\n    save() {\n        this._context.save();\n    }\n    scale(x, y) {\n        this._context.scale(x, y);\n    }\n    setLineDash(segments) {\n        if (this._context.setLineDash) {\n            this._context.setLineDash(segments);\n        }\n        else if ('mozDash' in this._context) {\n            this._context['mozDash'] = segments;\n        }\n        else if ('webkitLineDash' in this._context) {\n            this._context['webkitLineDash'] = segments;\n        }\n    }\n    getLineDash() {\n        return this._context.getLineDash();\n    }\n    setTransform(a, b, c, d, e, f) {\n        this._context.setTransform(a, b, c, d, e, f);\n    }\n    stroke(path2d) {\n        if (path2d) {\n            this._context.stroke(path2d);\n        }\n        else {\n            this._context.stroke();\n        }\n    }\n    strokeText(text, x, y, maxWidth) {\n        this._context.strokeText(text, x, y, maxWidth);\n    }\n    transform(a, b, c, d, e, f) {\n        this._context.transform(a, b, c, d, e, f);\n    }\n    translate(x, y) {\n        this._context.translate(x, y);\n    }\n    _enableTrace() {\n        let that = this, len = CONTEXT_METHODS.length, origSetter = this.setAttr, n, args;\n        const func = function (methodName) {\n            let origMethod = that[methodName], ret;\n            that[methodName] = function () {\n                args = simplifyArray(Array.prototype.slice.call(arguments, 0));\n                ret = origMethod.apply(that, arguments);\n                that._trace({\n                    method: methodName,\n                    args: args,\n                });\n                return ret;\n            };\n        };\n        for (n = 0; n < len; n++) {\n            func(CONTEXT_METHODS[n]);\n        }\n        that.setAttr = function () {\n            origSetter.apply(that, arguments);\n            const prop = arguments[0];\n            let val = arguments[1];\n            if (prop === 'shadowOffsetX' ||\n                prop === 'shadowOffsetY' ||\n                prop === 'shadowBlur') {\n                val = val / this.canvas.getPixelRatio();\n            }\n            that._trace({\n                property: prop,\n                val: val,\n            });\n        };\n    }\n    _applyGlobalCompositeOperation(node) {\n        const op = node.attrs.globalCompositeOperation;\n        const def = !op || op === 'source-over';\n        if (!def) {\n            this.setAttr('globalCompositeOperation', op);\n        }\n    }\n}\nCONTEXT_PROPERTIES.forEach(function (prop) {\n    Object.defineProperty(Context.prototype, prop, {\n        get() {\n            return this._context[prop];\n        },\n        set(val) {\n            this._context[prop] = val;\n        },\n    });\n});\nexport class SceneContext extends Context {\n    constructor(canvas, { willReadFrequently = false } = {}) {\n        super(canvas);\n        this._context = canvas._canvas.getContext('2d', {\n            willReadFrequently,\n        });\n    }\n    _fillColor(shape) {\n        const fill = shape.fill();\n        this.setAttr('fillStyle', fill);\n        shape._fillFunc(this);\n    }\n    _fillPattern(shape) {\n        this.setAttr('fillStyle', shape._getFillPattern());\n        shape._fillFunc(this);\n    }\n    _fillLinearGradient(shape) {\n        const grd = shape._getLinearGradient();\n        if (grd) {\n            this.setAttr('fillStyle', grd);\n            shape._fillFunc(this);\n        }\n    }\n    _fillRadialGradient(shape) {\n        const grd = shape._getRadialGradient();\n        if (grd) {\n            this.setAttr('fillStyle', grd);\n            shape._fillFunc(this);\n        }\n    }\n    _fill(shape) {\n        const hasColor = shape.fill(), fillPriority = shape.getFillPriority();\n        if (hasColor && fillPriority === 'color') {\n            this._fillColor(shape);\n            return;\n        }\n        const hasPattern = shape.getFillPatternImage();\n        if (hasPattern && fillPriority === 'pattern') {\n            this._fillPattern(shape);\n            return;\n        }\n        const hasLinearGradient = shape.getFillLinearGradientColorStops();\n        if (hasLinearGradient && fillPriority === 'linear-gradient') {\n            this._fillLinearGradient(shape);\n            return;\n        }\n        const hasRadialGradient = shape.getFillRadialGradientColorStops();\n        if (hasRadialGradient && fillPriority === 'radial-gradient') {\n            this._fillRadialGradient(shape);\n            return;\n        }\n        if (hasColor) {\n            this._fillColor(shape);\n        }\n        else if (hasPattern) {\n            this._fillPattern(shape);\n        }\n        else if (hasLinearGradient) {\n            this._fillLinearGradient(shape);\n        }\n        else if (hasRadialGradient) {\n            this._fillRadialGradient(shape);\n        }\n    }\n    _strokeLinearGradient(shape) {\n        const start = shape.getStrokeLinearGradientStartPoint(), end = shape.getStrokeLinearGradientEndPoint(), colorStops = shape.getStrokeLinearGradientColorStops(), grd = this.createLinearGradient(start.x, start.y, end.x, end.y);\n        if (colorStops) {\n            for (let n = 0; n < colorStops.length; n += 2) {\n                grd.addColorStop(colorStops[n], colorStops[n + 1]);\n            }\n            this.setAttr('strokeStyle', grd);\n        }\n    }\n    _stroke(shape) {\n        const dash = shape.dash(), strokeScaleEnabled = shape.getStrokeScaleEnabled();\n        if (shape.hasStroke()) {\n            if (!strokeScaleEnabled) {\n                this.save();\n                const pixelRatio = this.getCanvas().getPixelRatio();\n                this.setTransform(pixelRatio, 0, 0, pixelRatio, 0, 0);\n            }\n            this._applyLineCap(shape);\n            if (dash && shape.dashEnabled()) {\n                this.setLineDash(dash);\n                this.setAttr('lineDashOffset', shape.dashOffset());\n            }\n            this.setAttr('lineWidth', shape.strokeWidth());\n            if (!shape.getShadowForStrokeEnabled()) {\n                this.setAttr('shadowColor', 'rgba(0,0,0,0)');\n            }\n            const hasLinearGradient = shape.getStrokeLinearGradientColorStops();\n            if (hasLinearGradient) {\n                this._strokeLinearGradient(shape);\n            }\n            else {\n                this.setAttr('strokeStyle', shape.stroke());\n            }\n            shape._strokeFunc(this);\n            if (!strokeScaleEnabled) {\n                this.restore();\n            }\n        }\n    }\n    _applyShadow(shape) {\n        var _a, _b, _c;\n        const color = (_a = shape.getShadowRGBA()) !== null && _a !== void 0 ? _a : 'black', blur = (_b = shape.getShadowBlur()) !== null && _b !== void 0 ? _b : 5, offset = (_c = shape.getShadowOffset()) !== null && _c !== void 0 ? _c : {\n            x: 0,\n            y: 0,\n        }, scale = shape.getAbsoluteScale(), ratio = this.canvas.getPixelRatio(), scaleX = scale.x * ratio, scaleY = scale.y * ratio;\n        this.setAttr('shadowColor', color);\n        this.setAttr('shadowBlur', blur * Math.min(Math.abs(scaleX), Math.abs(scaleY)));\n        this.setAttr('shadowOffsetX', offset.x * scaleX);\n        this.setAttr('shadowOffsetY', offset.y * scaleY);\n    }\n}\nexport class HitContext extends Context {\n    constructor(canvas) {\n        super(canvas);\n        this._context = canvas._canvas.getContext('2d', {\n            willReadFrequently: true,\n        });\n    }\n    _fill(shape) {\n        this.save();\n        this.setAttr('fillStyle', shape.colorKey);\n        shape._fillFuncHit(this);\n        this.restore();\n    }\n    strokeShape(shape) {\n        if (shape.hasHitStroke()) {\n            this._stroke(shape);\n        }\n    }\n    _stroke(shape) {\n        if (shape.hasHitStroke()) {\n            const strokeScaleEnabled = shape.getStrokeScaleEnabled();\n            if (!strokeScaleEnabled) {\n                this.save();\n                const pixelRatio = this.getCanvas().getPixelRatio();\n                this.setTransform(pixelRatio, 0, 0, pixelRatio, 0, 0);\n            }\n            this._applyLineCap(shape);\n            const hitStrokeWidth = shape.hitStrokeWidth();\n            const strokeWidth = hitStrokeWidth === 'auto' ? shape.strokeWidth() : hitStrokeWidth;\n            this.setAttr('lineWidth', strokeWidth);\n            this.setAttr('strokeStyle', shape.colorKey);\n            shape._strokeFuncHit(this);\n            if (!strokeScaleEnabled) {\n                this.restore();\n            }\n        }\n    }\n}\n", "import { Util } from \"./Util.js\";\nimport { SceneContext, HitContext } from \"./Context.js\";\nimport { Konva } from \"./Global.js\";\nlet _pixelRatio;\nfunction getDevicePixelRatio() {\n    if (_pixelRatio) {\n        return _pixelRatio;\n    }\n    const canvas = Util.createCanvasElement();\n    const context = canvas.getContext('2d');\n    _pixelRatio = (function () {\n        const devicePixelRatio = Konva._global.devicePixelRatio || 1, backingStoreRatio = context.webkitBackingStorePixelRatio ||\n            context.mozBackingStorePixelRatio ||\n            context.msBackingStorePixelRatio ||\n            context.oBackingStorePixelRatio ||\n            context.backingStorePixelRatio ||\n            1;\n        return devicePixelRatio / backingStoreRatio;\n    })();\n    Util.releaseCanvas(canvas);\n    return _pixelRatio;\n}\nexport class Canvas {\n    constructor(config) {\n        this.pixelRatio = 1;\n        this.width = 0;\n        this.height = 0;\n        this.isCache = false;\n        const conf = config || {};\n        const pixelRatio = conf.pixelRatio || Konva.pixelRatio || getDevicePixelRatio();\n        this.pixelRatio = pixelRatio;\n        this._canvas = Util.createCanvasElement();\n        this._canvas.style.padding = '0';\n        this._canvas.style.margin = '0';\n        this._canvas.style.border = '0';\n        this._canvas.style.background = 'transparent';\n        this._canvas.style.position = 'absolute';\n        this._canvas.style.top = '0';\n        this._canvas.style.left = '0';\n    }\n    getContext() {\n        return this.context;\n    }\n    getPixelRatio() {\n        return this.pixelRatio;\n    }\n    setPixelRatio(pixelRatio) {\n        const previousRatio = this.pixelRatio;\n        this.pixelRatio = pixelRatio;\n        this.setSize(this.getWidth() / previousRatio, this.getHeight() / previousRatio);\n    }\n    setWidth(width) {\n        this.width = this._canvas.width = width * this.pixelRatio;\n        this._canvas.style.width = width + 'px';\n        const pixelRatio = this.pixelRatio, _context = this.getContext()._context;\n        _context.scale(pixelRatio, pixelRatio);\n    }\n    setHeight(height) {\n        this.height = this._canvas.height = height * this.pixelRatio;\n        this._canvas.style.height = height + 'px';\n        const pixelRatio = this.pixelRatio, _context = this.getContext()._context;\n        _context.scale(pixelRatio, pixelRatio);\n    }\n    getWidth() {\n        return this.width;\n    }\n    getHeight() {\n        return this.height;\n    }\n    setSize(width, height) {\n        this.setWidth(width || 0);\n        this.setHeight(height || 0);\n    }\n    toDataURL(mimeType, quality) {\n        try {\n            return this._canvas.toDataURL(mimeType, quality);\n        }\n        catch (e) {\n            try {\n                return this._canvas.toDataURL();\n            }\n            catch (err) {\n                Util.error('Unable to get data URL. ' +\n                    err.message +\n                    ' For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html.');\n                return '';\n            }\n        }\n    }\n}\nexport class SceneCanvas extends Canvas {\n    constructor(config = { width: 0, height: 0, willReadFrequently: false }) {\n        super(config);\n        this.context = new SceneContext(this, {\n            willReadFrequently: config.willReadFrequently,\n        });\n        this.setSize(config.width, config.height);\n    }\n}\nexport class HitCanvas extends Canvas {\n    constructor(config = { width: 0, height: 0 }) {\n        super(config);\n        this.hitCanvas = true;\n        this.context = new HitContext(this);\n        this.setSize(config.width, config.height);\n    }\n}\n", "import { Konva } from \"./Global.js\";\nimport { Util } from \"./Util.js\";\nexport const DD = {\n    get isDragging() {\n        let flag = false;\n        DD._dragElements.forEach((elem) => {\n            if (elem.dragStatus === 'dragging') {\n                flag = true;\n            }\n        });\n        return flag;\n    },\n    justDragged: false,\n    get node() {\n        let node;\n        DD._dragElements.forEach((elem) => {\n            node = elem.node;\n        });\n        return node;\n    },\n    _dragElements: new Map(),\n    _drag(evt) {\n        const nodesToFireEvents = [];\n        DD._dragElements.forEach((elem, key) => {\n            const { node } = elem;\n            const stage = node.getStage();\n            stage.setPointersPositions(evt);\n            if (elem.pointerId === undefined) {\n                elem.pointerId = Util._getFirstPointerId(evt);\n            }\n            const pos = stage._changedPointerPositions.find((pos) => pos.id === elem.pointerId);\n            if (!pos) {\n                return;\n            }\n            if (elem.dragStatus !== 'dragging') {\n                const dragDistance = node.dragDistance();\n                const distance = Math.max(Math.abs(pos.x - elem.startPointerPos.x), Math.abs(pos.y - elem.startPointerPos.y));\n                if (distance < dragDistance) {\n                    return;\n                }\n                node.startDrag({ evt });\n                if (!node.isDragging()) {\n                    return;\n                }\n            }\n            node._setDragPosition(evt, elem);\n            nodesToFireEvents.push(node);\n        });\n        nodesToFireEvents.forEach((node) => {\n            node.fire('dragmove', {\n                type: 'dragmove',\n                target: node,\n                evt: evt,\n            }, true);\n        });\n    },\n    _endDragBefore(evt) {\n        const drawNodes = [];\n        DD._dragElements.forEach((elem) => {\n            const { node } = elem;\n            const stage = node.getStage();\n            if (evt) {\n                stage.setPointersPositions(evt);\n            }\n            const pos = stage._changedPointerPositions.find((pos) => pos.id === elem.pointerId);\n            if (!pos) {\n                return;\n            }\n            if (elem.dragStatus === 'dragging' || elem.dragStatus === 'stopped') {\n                DD.justDragged = true;\n                Konva._mouseListenClick = false;\n                Konva._touchListenClick = false;\n                Konva._pointerListenClick = false;\n                elem.dragStatus = 'stopped';\n            }\n            const drawNode = elem.node.getLayer() ||\n                (elem.node instanceof Konva['Stage'] && elem.node);\n            if (drawNode && drawNodes.indexOf(drawNode) === -1) {\n                drawNodes.push(drawNode);\n            }\n        });\n        drawNodes.forEach((drawNode) => {\n            drawNode.draw();\n        });\n    },\n    _endDragAfter(evt) {\n        DD._dragElements.forEach((elem, key) => {\n            if (elem.dragStatus === 'stopped') {\n                elem.node.fire('dragend', {\n                    type: 'dragend',\n                    target: elem.node,\n                    evt: evt,\n                }, true);\n            }\n            if (elem.dragStatus !== 'dragging') {\n                DD._dragElements.delete(key);\n            }\n        });\n    },\n};\nif (Konva.isBrowser) {\n    window.addEventListener('mouseup', DD._endDragBefore, true);\n    window.addEventListener('touchend', DD._endDragBefore, true);\n    window.addEventListener('touchcancel', DD._endDragBefore, true);\n    window.addEventListener('mousemove', DD._drag);\n    window.addEventListener('touchmove', DD._drag);\n    window.addEventListener('mouseup', DD._endDragAfter, false);\n    window.addEventListener('touchend', DD._endDragAfter, false);\n    window.addEventListener('touchcancel', DD._endDragAfter, false);\n}\n", "import { Konva } from \"./Global.js\";\nimport { Util } from \"./Util.js\";\nfunction _formatValue(val) {\n    if (Util._isString(val)) {\n        return '\"' + val + '\"';\n    }\n    if (Object.prototype.toString.call(val) === '[object Number]') {\n        return val;\n    }\n    if (Util._isBoolean(val)) {\n        return val;\n    }\n    return Object.prototype.toString.call(val);\n}\nexport function RGBComponent(val) {\n    if (val > 255) {\n        return 255;\n    }\n    else if (val < 0) {\n        return 0;\n    }\n    return Math.round(val);\n}\nexport function alphaComponent(val) {\n    if (val > 1) {\n        return 1;\n    }\n    else if (val < 0.0001) {\n        return 0.0001;\n    }\n    return val;\n}\nexport function getNumberValidator() {\n    if (Konva.isUnminified) {\n        return function (val, attr) {\n            if (!Util._isNumber(val)) {\n                Util.warn(_formatValue(val) +\n                    ' is a not valid value for \"' +\n                    attr +\n                    '\" attribute. The value should be a number.');\n            }\n            return val;\n        };\n    }\n}\nexport function getNumberOrArrayOfNumbersValidator(noOfElements) {\n    if (Konva.isUnminified) {\n        return function (val, attr) {\n            let isNumber = Util._isNumber(val);\n            let isValidArray = Util._isArray(val) && val.length == noOfElements;\n            if (!isNumber && !isValidArray) {\n                Util.warn(_formatValue(val) +\n                    ' is a not valid value for \"' +\n                    attr +\n                    '\" attribute. The value should be a number or Array<number>(' +\n                    noOfElements +\n                    ')');\n            }\n            return val;\n        };\n    }\n}\nexport function getNumberOrAutoValidator() {\n    if (Konva.isUnminified) {\n        return function (val, attr) {\n            const isNumber = Util._isNumber(val);\n            const isAuto = val === 'auto';\n            if (!(isNumber || isAuto)) {\n                Util.warn(_formatValue(val) +\n                    ' is a not valid value for \"' +\n                    attr +\n                    '\" attribute. The value should be a number or \"auto\".');\n            }\n            return val;\n        };\n    }\n}\nexport function getStringValidator() {\n    if (Konva.isUnminified) {\n        return function (val, attr) {\n            if (!Util._isString(val)) {\n                Util.warn(_formatValue(val) +\n                    ' is a not valid value for \"' +\n                    attr +\n                    '\" attribute. The value should be a string.');\n            }\n            return val;\n        };\n    }\n}\nexport function getStringOrGradientValidator() {\n    if (Konva.isUnminified) {\n        return function (val, attr) {\n            const isString = Util._isString(val);\n            const isGradient = Object.prototype.toString.call(val) === '[object CanvasGradient]' ||\n                (val && val['addColorStop']);\n            if (!(isString || isGradient)) {\n                Util.warn(_formatValue(val) +\n                    ' is a not valid value for \"' +\n                    attr +\n                    '\" attribute. The value should be a string or a native gradient.');\n            }\n            return val;\n        };\n    }\n}\nexport function getFunctionValidator() {\n    if (Konva.isUnminified) {\n        return function (val, attr) {\n            if (!Util._isFunction(val)) {\n                Util.warn(_formatValue(val) +\n                    ' is a not valid value for \"' +\n                    attr +\n                    '\" attribute. The value should be a function.');\n            }\n            return val;\n        };\n    }\n}\nexport function getNumberArrayValidator() {\n    if (Konva.isUnminified) {\n        return function (val, attr) {\n            const TypedArray = Int8Array ? Object.getPrototypeOf(Int8Array) : null;\n            if (TypedArray && val instanceof TypedArray) {\n                return val;\n            }\n            if (!Util._isArray(val)) {\n                Util.warn(_formatValue(val) +\n                    ' is a not valid value for \"' +\n                    attr +\n                    '\" attribute. The value should be a array of numbers.');\n            }\n            else {\n                val.forEach(function (item) {\n                    if (!Util._isNumber(item)) {\n                        Util.warn('\"' +\n                            attr +\n                            '\" attribute has non numeric element ' +\n                            item +\n                            '. Make sure that all elements are numbers.');\n                    }\n                });\n            }\n            return val;\n        };\n    }\n}\nexport function getBooleanValidator() {\n    if (Konva.isUnminified) {\n        return function (val, attr) {\n            const isBool = val === true || val === false;\n            if (!isBool) {\n                Util.warn(_formatValue(val) +\n                    ' is a not valid value for \"' +\n                    attr +\n                    '\" attribute. The value should be a boolean.');\n            }\n            return val;\n        };\n    }\n}\nexport function getComponentValidator(components) {\n    if (Konva.isUnminified) {\n        return function (val, attr) {\n            if (val === undefined || val === null) {\n                return val;\n            }\n            if (!Util.isObject(val)) {\n                Util.warn(_formatValue(val) +\n                    ' is a not valid value for \"' +\n                    attr +\n                    '\" attribute. The value should be an object with properties ' +\n                    components);\n            }\n            return val;\n        };\n    }\n}\n", "import { Util } from \"./Util.js\";\nimport { getComponentValidator } from \"./Validators.js\";\nconst GET = 'get';\nconst SET = 'set';\nexport const Factory = {\n    addGetterSetter(constructor, attr, def, validator, after) {\n        Factory.addGetter(constructor, attr, def);\n        Factory.addSetter(constructor, attr, validator, after);\n        Factory.addOverloadedGetterSetter(constructor, attr);\n    },\n    addGetter(constructor, attr, def) {\n        const method = GET + Util._capitalize(attr);\n        constructor.prototype[method] =\n            constructor.prototype[method] ||\n                function () {\n                    const val = this.attrs[attr];\n                    return val === undefined ? def : val;\n                };\n    },\n    addSetter(constructor, attr, validator, after) {\n        const method = SET + Util._capitalize(attr);\n        if (!constructor.prototype[method]) {\n            Factory.overWriteSetter(constructor, attr, validator, after);\n        }\n    },\n    overWriteSetter(constructor, attr, validator, after) {\n        const method = SET + Util._capitalize(attr);\n        constructor.prototype[method] = function (val) {\n            if (validator && val !== undefined && val !== null) {\n                val = validator.call(this, val, attr);\n            }\n            this._setAttr(attr, val);\n            if (after) {\n                after.call(this);\n            }\n            return this;\n        };\n    },\n    addComponentsGetterSetter(constructor, attr, components, validator, after) {\n        const len = components.length, capitalize = Util._capitalize, getter = GET + capitalize(attr), setter = SET + capitalize(attr);\n        constructor.prototype[getter] = function () {\n            const ret = {};\n            for (let n = 0; n < len; n++) {\n                const component = components[n];\n                ret[component] = this.getAttr(attr + capitalize(component));\n            }\n            return ret;\n        };\n        const basicValidator = getComponentValidator(components);\n        constructor.prototype[setter] = function (val) {\n            const oldVal = this.attrs[attr];\n            if (validator) {\n                val = validator.call(this, val, attr);\n            }\n            if (basicValidator) {\n                basicValidator.call(this, val, attr);\n            }\n            for (const key in val) {\n                if (!val.hasOwnProperty(key)) {\n                    continue;\n                }\n                this._setAttr(attr + capitalize(key), val[key]);\n            }\n            if (!val) {\n                components.forEach((component) => {\n                    this._setAttr(attr + capitalize(component), undefined);\n                });\n            }\n            this._fireChangeEvent(attr, oldVal, val);\n            if (after) {\n                after.call(this);\n            }\n            return this;\n        };\n        Factory.addOverloadedGetterSetter(constructor, attr);\n    },\n    addOverloadedGetterSetter(constructor, attr) {\n        const capitalizedAttr = Util._capitalize(attr), setter = SET + capitalizedAttr, getter = GET + capitalizedAttr;\n        constructor.prototype[attr] = function () {\n            if (arguments.length) {\n                this[setter](arguments[0]);\n                return this;\n            }\n            return this[getter]();\n        };\n    },\n    addDeprecatedGetterSetter(constructor, attr, def, validator) {\n        Util.error('Adding deprecated ' + attr);\n        const method = GET + Util._capitalize(attr);\n        const message = attr +\n            ' property is deprecated and will be removed soon. Look at Konva change log for more information.';\n        constructor.prototype[method] = function () {\n            Util.error(message);\n            const val = this.attrs[attr];\n            return val === undefined ? def : val;\n        };\n        Factory.addSetter(constructor, attr, validator, function () {\n            Util.error(message);\n        });\n        Factory.addOverloadedGetterSetter(constructor, attr);\n    },\n    backCompat(constructor, methods) {\n        Util.each(methods, function (oldMethodName, newMethodName) {\n            const method = constructor.prototype[newMethodName];\n            const oldGetter = GET + Util._capitalize(oldMethodName);\n            const oldSetter = SET + Util._capitalize(oldMethodName);\n            function deprecated() {\n                method.apply(this, arguments);\n                Util.error('\"' +\n                    oldMethodName +\n                    '\" method is deprecated and will be removed soon. Use \"\"' +\n                    newMethodName +\n                    '\" instead.');\n            }\n            constructor.prototype[oldMethodName] = deprecated;\n            constructor.prototype[oldGetter] = deprecated;\n            constructor.prototype[oldSetter] = deprecated;\n        });\n    },\n    afterSetFilter() {\n        this._filterUpToDate = false;\n    },\n};\n", "import { HitCanvas, SceneCanvas } from \"./Canvas.js\";\nimport { isCSSFiltersSupported } from \"./Context.js\";\nimport { DD } from \"./DragAndDrop.js\";\nimport { Factory } from \"./Factory.js\";\nimport { Konva } from \"./Global.js\";\nimport { Transform, Util } from \"./Util.js\";\nimport { getBooleanValidator, getNumberValidator, getStringValidator, } from \"./Validators.js\";\nfunction parseCSSFilters(cssFilter) {\n    const filterRegex = /(\\w+)\\(([^)]+)\\)/g;\n    let match;\n    while ((match = filterRegex.exec(cssFilter)) !== null) {\n        const [, filterName, filterValue] = match;\n        switch (filterName) {\n            case 'blur': {\n                const blurRadius = parseFloat(filterValue.replace('px', ''));\n                return function (imageData) {\n                    this.blurRadius(blurRadius * 0.5);\n                    const KonvaFilters = Konva.Filters;\n                    if (KonvaFilters && KonvaFilters.Blur) {\n                        KonvaFilters.Blur.call(this, imageData);\n                    }\n                };\n            }\n            case 'brightness': {\n                const brightness = filterValue.includes('%')\n                    ? parseFloat(filterValue) / 100\n                    : parseFloat(filterValue);\n                return function (imageData) {\n                    this.brightness(brightness);\n                    const KonvaFilters = Konva.Filters;\n                    if (KonvaFilters && KonvaFilters.Brightness) {\n                        KonvaFilters.Brightness.call(this, imageData);\n                    }\n                };\n            }\n            case 'contrast': {\n                const contrast = parseFloat(filterValue);\n                return function (imageData) {\n                    const konvaContrast = 100 * (Math.sqrt(contrast) - 1);\n                    this.contrast(konvaContrast);\n                    const KonvaFilters = Konva.Filters;\n                    if (KonvaFilters && KonvaFilters.Contrast) {\n                        KonvaFilters.Contrast.call(this, imageData);\n                    }\n                };\n            }\n            case 'grayscale': {\n                return function (imageData) {\n                    const KonvaFilters = Konva.Filters;\n                    if (KonvaFilters && KonvaFilters.Grayscale) {\n                        KonvaFilters.Grayscale.call(this, imageData);\n                    }\n                };\n            }\n            case 'sepia': {\n                return function (imageData) {\n                    const KonvaFilters = Konva.Filters;\n                    if (KonvaFilters && KonvaFilters.Sepia) {\n                        KonvaFilters.Sepia.call(this, imageData);\n                    }\n                };\n            }\n            case 'invert': {\n                return function (imageData) {\n                    const KonvaFilters = Konva.Filters;\n                    if (KonvaFilters && KonvaFilters.Invert) {\n                        KonvaFilters.Invert.call(this, imageData);\n                    }\n                };\n            }\n            default:\n                Util.warn(`CSS filter \"${filterName}\" is not supported in fallback mode. Consider using function filters for better compatibility.`);\n                break;\n        }\n    }\n    return () => { };\n}\nconst ABSOLUTE_OPACITY = 'absoluteOpacity', ALL_LISTENERS = 'allEventListeners', ABSOLUTE_TRANSFORM = 'absoluteTransform', ABSOLUTE_SCALE = 'absoluteScale', CANVAS = 'canvas', CHANGE = 'Change', CHILDREN = 'children', KONVA = 'konva', LISTENING = 'listening', MOUSEENTER = 'mouseenter', MOUSELEAVE = 'mouseleave', POINTERENTER = 'pointerenter', POINTERLEAVE = 'pointerleave', TOUCHENTER = 'touchenter', TOUCHLEAVE = 'touchleave', NAME = 'name', SET = 'set', SHAPE = 'Shape', SPACE = ' ', STAGE = 'stage', TRANSFORM = 'transform', UPPER_STAGE = 'Stage', VISIBLE = 'visible', TRANSFORM_CHANGE_STR = [\n    'xChange.konva',\n    'yChange.konva',\n    'scaleXChange.konva',\n    'scaleYChange.konva',\n    'skewXChange.konva',\n    'skewYChange.konva',\n    'rotationChange.konva',\n    'offsetXChange.konva',\n    'offsetYChange.konva',\n    'transformsEnabledChange.konva',\n].join(SPACE);\nlet idCounter = 1;\nexport class Node {\n    constructor(config) {\n        this._id = idCounter++;\n        this.eventListeners = {};\n        this.attrs = {};\n        this.index = 0;\n        this._allEventListeners = null;\n        this.parent = null;\n        this._cache = new Map();\n        this._attachedDepsListeners = new Map();\n        this._lastPos = null;\n        this._batchingTransformChange = false;\n        this._needClearTransformCache = false;\n        this._filterUpToDate = false;\n        this._isUnderCache = false;\n        this._dragEventId = null;\n        this._shouldFireChangeEvents = false;\n        this.setAttrs(config);\n        this._shouldFireChangeEvents = true;\n    }\n    hasChildren() {\n        return false;\n    }\n    _clearCache(attr) {\n        if ((attr === TRANSFORM || attr === ABSOLUTE_TRANSFORM) &&\n            this._cache.get(attr)) {\n            this._cache.get(attr).dirty = true;\n        }\n        else if (attr) {\n            this._cache.delete(attr);\n        }\n        else {\n            this._cache.clear();\n        }\n    }\n    _getCache(attr, privateGetter) {\n        let cache = this._cache.get(attr);\n        const isTransform = attr === TRANSFORM || attr === ABSOLUTE_TRANSFORM;\n        const invalid = cache === undefined || (isTransform && cache.dirty === true);\n        if (invalid) {\n            cache = privateGetter.call(this);\n            this._cache.set(attr, cache);\n        }\n        return cache;\n    }\n    _calculate(name, deps, getter) {\n        if (!this._attachedDepsListeners.get(name)) {\n            const depsString = deps.map((dep) => dep + 'Change.konva').join(SPACE);\n            this.on(depsString, () => {\n                this._clearCache(name);\n            });\n            this._attachedDepsListeners.set(name, true);\n        }\n        return this._getCache(name, getter);\n    }\n    _getCanvasCache() {\n        return this._cache.get(CANVAS);\n    }\n    _clearSelfAndDescendantCache(attr) {\n        this._clearCache(attr);\n        if (attr === ABSOLUTE_TRANSFORM) {\n            this.fire('absoluteTransformChange');\n        }\n    }\n    clearCache() {\n        if (this._cache.has(CANVAS)) {\n            const { scene, filter, hit, buffer } = this._cache.get(CANVAS);\n            Util.releaseCanvas(scene, filter, hit, buffer);\n            this._cache.delete(CANVAS);\n        }\n        this._clearSelfAndDescendantCache();\n        this._requestDraw();\n        return this;\n    }\n    cache(config) {\n        const conf = config || {};\n        let rect = {};\n        if (conf.x === undefined ||\n            conf.y === undefined ||\n            conf.width === undefined ||\n            conf.height === undefined) {\n            rect = this.getClientRect({\n                skipTransform: true,\n                relativeTo: this.getParent() || undefined,\n            });\n        }\n        let width = Math.ceil(conf.width || rect.width), height = Math.ceil(conf.height || rect.height), pixelRatio = conf.pixelRatio, x = conf.x === undefined ? Math.floor(rect.x) : conf.x, y = conf.y === undefined ? Math.floor(rect.y) : conf.y, offset = conf.offset || 0, drawBorder = conf.drawBorder || false, hitCanvasPixelRatio = conf.hitCanvasPixelRatio || 1;\n        if (!width || !height) {\n            Util.error('Can not cache the node. Width or height of the node equals 0. Caching is skipped.');\n            return;\n        }\n        const extraPaddingX = Math.abs(Math.round(rect.x) - x) > 0.5 ? 1 : 0;\n        const extraPaddingY = Math.abs(Math.round(rect.y) - y) > 0.5 ? 1 : 0;\n        width += offset * 2 + extraPaddingX;\n        height += offset * 2 + extraPaddingY;\n        x -= offset;\n        y -= offset;\n        const cachedSceneCanvas = new SceneCanvas({\n            pixelRatio: pixelRatio,\n            width: width,\n            height: height,\n        }), cachedFilterCanvas = new SceneCanvas({\n            pixelRatio: pixelRatio,\n            width: 0,\n            height: 0,\n            willReadFrequently: true,\n        }), cachedHitCanvas = new HitCanvas({\n            pixelRatio: hitCanvasPixelRatio,\n            width: width,\n            height: height,\n        }), sceneContext = cachedSceneCanvas.getContext(), hitContext = cachedHitCanvas.getContext();\n        const bufferCanvas = new SceneCanvas({\n            width: cachedSceneCanvas.width / cachedSceneCanvas.pixelRatio + Math.abs(x),\n            height: cachedSceneCanvas.height / cachedSceneCanvas.pixelRatio + Math.abs(y),\n            pixelRatio: cachedSceneCanvas.pixelRatio,\n        }), bufferContext = bufferCanvas.getContext();\n        cachedHitCanvas.isCache = true;\n        cachedSceneCanvas.isCache = true;\n        this._cache.delete(CANVAS);\n        this._filterUpToDate = false;\n        if (conf.imageSmoothingEnabled === false) {\n            cachedSceneCanvas.getContext()._context.imageSmoothingEnabled = false;\n            cachedFilterCanvas.getContext()._context.imageSmoothingEnabled = false;\n        }\n        sceneContext.save();\n        hitContext.save();\n        bufferContext.save();\n        sceneContext.translate(-x, -y);\n        hitContext.translate(-x, -y);\n        bufferContext.translate(-x, -y);\n        bufferCanvas.x = x;\n        bufferCanvas.y = y;\n        this._isUnderCache = true;\n        this._clearSelfAndDescendantCache(ABSOLUTE_OPACITY);\n        this._clearSelfAndDescendantCache(ABSOLUTE_SCALE);\n        this.drawScene(cachedSceneCanvas, this, bufferCanvas);\n        this.drawHit(cachedHitCanvas, this);\n        this._isUnderCache = false;\n        sceneContext.restore();\n        hitContext.restore();\n        if (drawBorder) {\n            sceneContext.save();\n            sceneContext.beginPath();\n            sceneContext.rect(0, 0, width, height);\n            sceneContext.closePath();\n            sceneContext.setAttr('strokeStyle', 'red');\n            sceneContext.setAttr('lineWidth', 5);\n            sceneContext.stroke();\n            sceneContext.restore();\n        }\n        this._cache.set(CANVAS, {\n            scene: cachedSceneCanvas,\n            filter: cachedFilterCanvas,\n            hit: cachedHitCanvas,\n            buffer: bufferCanvas,\n            x: x,\n            y: y,\n        });\n        this._requestDraw();\n        return this;\n    }\n    isCached() {\n        return this._cache.has(CANVAS);\n    }\n    getClientRect(config) {\n        throw new Error('abstract \"getClientRect\" method call');\n    }\n    _transformedRect(rect, top) {\n        const points = [\n            { x: rect.x, y: rect.y },\n            { x: rect.x + rect.width, y: rect.y },\n            { x: rect.x + rect.width, y: rect.y + rect.height },\n            { x: rect.x, y: rect.y + rect.height },\n        ];\n        let minX = Infinity, minY = Infinity, maxX = -Infinity, maxY = -Infinity;\n        const trans = this.getAbsoluteTransform(top);\n        points.forEach(function (point) {\n            const transformed = trans.point(point);\n            if (minX === undefined) {\n                minX = maxX = transformed.x;\n                minY = maxY = transformed.y;\n            }\n            minX = Math.min(minX, transformed.x);\n            minY = Math.min(minY, transformed.y);\n            maxX = Math.max(maxX, transformed.x);\n            maxY = Math.max(maxY, transformed.y);\n        });\n        return {\n            x: minX,\n            y: minY,\n            width: maxX - minX,\n            height: maxY - minY,\n        };\n    }\n    _drawCachedSceneCanvas(context) {\n        context.save();\n        context._applyOpacity(this);\n        context._applyGlobalCompositeOperation(this);\n        const canvasCache = this._getCanvasCache();\n        context.translate(canvasCache.x, canvasCache.y);\n        const cacheCanvas = this._getCachedSceneCanvas();\n        const ratio = cacheCanvas.pixelRatio;\n        context.drawImage(cacheCanvas._canvas, 0, 0, cacheCanvas.width / ratio, cacheCanvas.height / ratio);\n        context.restore();\n    }\n    _drawCachedHitCanvas(context) {\n        const canvasCache = this._getCanvasCache(), hitCanvas = canvasCache.hit;\n        context.save();\n        context.translate(canvasCache.x, canvasCache.y);\n        context.drawImage(hitCanvas._canvas, 0, 0, hitCanvas.width / hitCanvas.pixelRatio, hitCanvas.height / hitCanvas.pixelRatio);\n        context.restore();\n    }\n    _getCachedSceneCanvas() {\n        let filters = this.filters(), cachedCanvas = this._getCanvasCache(), sceneCanvas = cachedCanvas.scene, filterCanvas = cachedCanvas.filter, filterContext = filterCanvas.getContext(), len, imageData, n, filter;\n        if (!filters || filters.length === 0) {\n            return sceneCanvas;\n        }\n        if (this._filterUpToDate) {\n            return filterCanvas;\n        }\n        let useNativeOnly = true;\n        for (let i = 0; i < filters.length; i++) {\n            const fallbackRequired = typeof filters[i] === 'string' && !isCSSFiltersSupported();\n            if (fallbackRequired) {\n            }\n            if (typeof filters[i] !== 'string' || !isCSSFiltersSupported()) {\n                useNativeOnly = false;\n                break;\n            }\n        }\n        const ratio = sceneCanvas.pixelRatio;\n        filterCanvas.setSize(sceneCanvas.width / sceneCanvas.pixelRatio, sceneCanvas.height / sceneCanvas.pixelRatio);\n        if (useNativeOnly) {\n            const finalFilter = filters.join(' ');\n            filterContext.save();\n            filterContext.setAttr('filter', finalFilter);\n            filterContext.drawImage(sceneCanvas._canvas, 0, 0, sceneCanvas.getWidth() / ratio, sceneCanvas.getHeight() / ratio);\n            filterContext.restore();\n            this._filterUpToDate = true;\n            return filterCanvas;\n        }\n        try {\n            len = filters.length;\n            filterContext.clear();\n            filterContext.drawImage(sceneCanvas._canvas, 0, 0, sceneCanvas.getWidth() / ratio, sceneCanvas.getHeight() / ratio);\n            imageData = filterContext.getImageData(0, 0, filterCanvas.getWidth(), filterCanvas.getHeight());\n            for (n = 0; n < len; n++) {\n                filter = filters[n];\n                if (typeof filter === 'string') {\n                    filter = parseCSSFilters(filter);\n                }\n                filter.call(this, imageData);\n                filterContext.putImageData(imageData, 0, 0);\n            }\n        }\n        catch (e) {\n            Util.error('Unable to apply filter. ' +\n                e.message +\n                ' This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.');\n        }\n        this._filterUpToDate = true;\n        return filterCanvas;\n    }\n    on(evtStr, handler) {\n        if (this._cache) {\n            this._cache.delete(ALL_LISTENERS);\n        }\n        if (arguments.length === 3) {\n            return this._delegate.apply(this, arguments);\n        }\n        const events = evtStr.split(SPACE);\n        for (let n = 0; n < events.length; n++) {\n            const event = events[n];\n            const parts = event.split('.');\n            const baseEvent = parts[0];\n            const name = parts[1] || '';\n            if (!this.eventListeners[baseEvent]) {\n                this.eventListeners[baseEvent] = [];\n            }\n            this.eventListeners[baseEvent].push({ name, handler });\n        }\n        return this;\n    }\n    off(evtStr, callback) {\n        let events = (evtStr || '').split(SPACE), len = events.length, n, t, event, parts, baseEvent, name;\n        this._cache && this._cache.delete(ALL_LISTENERS);\n        if (!evtStr) {\n            for (t in this.eventListeners) {\n                this._off(t);\n            }\n        }\n        for (n = 0; n < len; n++) {\n            event = events[n];\n            parts = event.split('.');\n            baseEvent = parts[0];\n            name = parts[1];\n            if (baseEvent) {\n                if (this.eventListeners[baseEvent]) {\n                    this._off(baseEvent, name, callback);\n                }\n            }\n            else {\n                for (t in this.eventListeners) {\n                    this._off(t, name, callback);\n                }\n            }\n        }\n        return this;\n    }\n    dispatchEvent(evt) {\n        const e = {\n            target: this,\n            type: evt.type,\n            evt: evt,\n        };\n        this.fire(evt.type, e);\n        return this;\n    }\n    addEventListener(type, handler) {\n        this.on(type, function (evt) {\n            handler.call(this, evt.evt);\n        });\n        return this;\n    }\n    removeEventListener(type) {\n        this.off(type);\n        return this;\n    }\n    _delegate(event, selector, handler) {\n        const stopNode = this;\n        this.on(event, function (evt) {\n            const targets = evt.target.findAncestors(selector, true, stopNode);\n            for (let i = 0; i < targets.length; i++) {\n                evt = Util.cloneObject(evt);\n                evt.currentTarget = targets[i];\n                handler.call(targets[i], evt);\n            }\n        });\n    }\n    remove() {\n        if (this.isDragging()) {\n            this.stopDrag();\n        }\n        DD._dragElements.delete(this._id);\n        this._remove();\n        return this;\n    }\n    _clearCaches() {\n        this._clearSelfAndDescendantCache(ABSOLUTE_TRANSFORM);\n        this._clearSelfAndDescendantCache(ABSOLUTE_OPACITY);\n        this._clearSelfAndDescendantCache(ABSOLUTE_SCALE);\n        this._clearSelfAndDescendantCache(STAGE);\n        this._clearSelfAndDescendantCache(VISIBLE);\n        this._clearSelfAndDescendantCache(LISTENING);\n    }\n    _remove() {\n        this._clearCaches();\n        const parent = this.getParent();\n        if (parent && parent.children) {\n            parent.children.splice(this.index, 1);\n            parent._setChildrenIndices();\n            this.parent = null;\n        }\n    }\n    destroy() {\n        this.remove();\n        this.clearCache();\n        return this;\n    }\n    getAttr(attr) {\n        const method = 'get' + Util._capitalize(attr);\n        if (Util._isFunction(this[method])) {\n            return this[method]();\n        }\n        return this.attrs[attr];\n    }\n    getAncestors() {\n        let parent = this.getParent(), ancestors = [];\n        while (parent) {\n            ancestors.push(parent);\n            parent = parent.getParent();\n        }\n        return ancestors;\n    }\n    getAttrs() {\n        return this.attrs || {};\n    }\n    setAttrs(config) {\n        this._batchTransformChanges(() => {\n            let key, method;\n            if (!config) {\n                return this;\n            }\n            for (key in config) {\n                if (key === CHILDREN) {\n                    continue;\n                }\n                method = SET + Util._capitalize(key);\n                if (Util._isFunction(this[method])) {\n                    this[method](config[key]);\n                }\n                else {\n                    this._setAttr(key, config[key]);\n                }\n            }\n        });\n        return this;\n    }\n    isListening() {\n        return this._getCache(LISTENING, this._isListening);\n    }\n    _isListening(relativeTo) {\n        const listening = this.listening();\n        if (!listening) {\n            return false;\n        }\n        const parent = this.getParent();\n        if (parent && parent !== relativeTo && this !== relativeTo) {\n            return parent._isListening(relativeTo);\n        }\n        else {\n            return true;\n        }\n    }\n    isVisible() {\n        return this._getCache(VISIBLE, this._isVisible);\n    }\n    _isVisible(relativeTo) {\n        const visible = this.visible();\n        if (!visible) {\n            return false;\n        }\n        const parent = this.getParent();\n        if (parent && parent !== relativeTo && this !== relativeTo) {\n            return parent._isVisible(relativeTo);\n        }\n        else {\n            return true;\n        }\n    }\n    shouldDrawHit(top, skipDragCheck = false) {\n        if (top) {\n            return this._isVisible(top) && this._isListening(top);\n        }\n        const layer = this.getLayer();\n        let layerUnderDrag = false;\n        DD._dragElements.forEach((elem) => {\n            if (elem.dragStatus !== 'dragging') {\n                return;\n            }\n            else if (elem.node.nodeType === 'Stage') {\n                layerUnderDrag = true;\n            }\n            else if (elem.node.getLayer() === layer) {\n                layerUnderDrag = true;\n            }\n        });\n        const dragSkip = !skipDragCheck &&\n            !Konva.hitOnDragEnabled &&\n            (layerUnderDrag || Konva.isTransforming());\n        return this.isListening() && this.isVisible() && !dragSkip;\n    }\n    show() {\n        this.visible(true);\n        return this;\n    }\n    hide() {\n        this.visible(false);\n        return this;\n    }\n    getZIndex() {\n        return this.index || 0;\n    }\n    getAbsoluteZIndex() {\n        let depth = this.getDepth(), that = this, index = 0, nodes, len, n, child;\n        function addChildren(children) {\n            nodes = [];\n            len = children.length;\n            for (n = 0; n < len; n++) {\n                child = children[n];\n                index++;\n                if (child.nodeType !== SHAPE) {\n                    nodes = nodes.concat(child.getChildren().slice());\n                }\n                if (child._id === that._id) {\n                    n = len;\n                }\n            }\n            if (nodes.length > 0 && nodes[0].getDepth() <= depth) {\n                addChildren(nodes);\n            }\n        }\n        const stage = this.getStage();\n        if (that.nodeType !== UPPER_STAGE && stage) {\n            addChildren(stage.getChildren());\n        }\n        return index;\n    }\n    getDepth() {\n        let depth = 0, parent = this.parent;\n        while (parent) {\n            depth++;\n            parent = parent.parent;\n        }\n        return depth;\n    }\n    _batchTransformChanges(func) {\n        this._batchingTransformChange = true;\n        func();\n        this._batchingTransformChange = false;\n        if (this._needClearTransformCache) {\n            this._clearCache(TRANSFORM);\n            this._clearSelfAndDescendantCache(ABSOLUTE_TRANSFORM);\n        }\n        this._needClearTransformCache = false;\n    }\n    setPosition(pos) {\n        this._batchTransformChanges(() => {\n            this.x(pos.x);\n            this.y(pos.y);\n        });\n        return this;\n    }\n    getPosition() {\n        return {\n            x: this.x(),\n            y: this.y(),\n        };\n    }\n    getRelativePointerPosition() {\n        const stage = this.getStage();\n        if (!stage) {\n            return null;\n        }\n        const pos = stage.getPointerPosition();\n        if (!pos) {\n            return null;\n        }\n        const transform = this.getAbsoluteTransform().copy();\n        transform.invert();\n        return transform.point(pos);\n    }\n    getAbsolutePosition(top) {\n        let haveCachedParent = false;\n        let parent = this.parent;\n        while (parent) {\n            if (parent.isCached()) {\n                haveCachedParent = true;\n                break;\n            }\n            parent = parent.parent;\n        }\n        if (haveCachedParent && !top) {\n            top = true;\n        }\n        const absoluteMatrix = this.getAbsoluteTransform(top).getMatrix(), absoluteTransform = new Transform(), offset = this.offset();\n        absoluteTransform.m = absoluteMatrix.slice();\n        absoluteTransform.translate(offset.x, offset.y);\n        return absoluteTransform.getTranslation();\n    }\n    setAbsolutePosition(pos) {\n        const { x, y, ...origTrans } = this._clearTransform();\n        this.attrs.x = x;\n        this.attrs.y = y;\n        this._clearCache(TRANSFORM);\n        const it = this._getAbsoluteTransform().copy();\n        it.invert();\n        it.translate(pos.x, pos.y);\n        pos = {\n            x: this.attrs.x + it.getTranslation().x,\n            y: this.attrs.y + it.getTranslation().y,\n        };\n        this._setTransform(origTrans);\n        this.setPosition({ x: pos.x, y: pos.y });\n        this._clearCache(TRANSFORM);\n        this._clearSelfAndDescendantCache(ABSOLUTE_TRANSFORM);\n        return this;\n    }\n    _setTransform(trans) {\n        let key;\n        for (key in trans) {\n            this.attrs[key] = trans[key];\n        }\n    }\n    _clearTransform() {\n        const trans = {\n            x: this.x(),\n            y: this.y(),\n            rotation: this.rotation(),\n            scaleX: this.scaleX(),\n            scaleY: this.scaleY(),\n            offsetX: this.offsetX(),\n            offsetY: this.offsetY(),\n            skewX: this.skewX(),\n            skewY: this.skewY(),\n        };\n        this.attrs.x = 0;\n        this.attrs.y = 0;\n        this.attrs.rotation = 0;\n        this.attrs.scaleX = 1;\n        this.attrs.scaleY = 1;\n        this.attrs.offsetX = 0;\n        this.attrs.offsetY = 0;\n        this.attrs.skewX = 0;\n        this.attrs.skewY = 0;\n        return trans;\n    }\n    move(change) {\n        let changeX = change.x, changeY = change.y, x = this.x(), y = this.y();\n        if (changeX !== undefined) {\n            x += changeX;\n        }\n        if (changeY !== undefined) {\n            y += changeY;\n        }\n        this.setPosition({ x: x, y: y });\n        return this;\n    }\n    _eachAncestorReverse(func, top) {\n        let family = [], parent = this.getParent(), len, n;\n        if (top && top._id === this._id) {\n            return;\n        }\n        family.unshift(this);\n        while (parent && (!top || parent._id !== top._id)) {\n            family.unshift(parent);\n            parent = parent.parent;\n        }\n        len = family.length;\n        for (n = 0; n < len; n++) {\n            func(family[n]);\n        }\n    }\n    rotate(theta) {\n        this.rotation(this.rotation() + theta);\n        return this;\n    }\n    moveToTop() {\n        if (!this.parent) {\n            Util.warn('Node has no parent. moveToTop function is ignored.');\n            return false;\n        }\n        const index = this.index, len = this.parent.getChildren().length;\n        if (index < len - 1) {\n            this.parent.children.splice(index, 1);\n            this.parent.children.push(this);\n            this.parent._setChildrenIndices();\n            return true;\n        }\n        return false;\n    }\n    moveUp() {\n        if (!this.parent) {\n            Util.warn('Node has no parent. moveUp function is ignored.');\n            return false;\n        }\n        const index = this.index, len = this.parent.getChildren().length;\n        if (index < len - 1) {\n            this.parent.children.splice(index, 1);\n            this.parent.children.splice(index + 1, 0, this);\n            this.parent._setChildrenIndices();\n            return true;\n        }\n        return false;\n    }\n    moveDown() {\n        if (!this.parent) {\n            Util.warn('Node has no parent. moveDown function is ignored.');\n            return false;\n        }\n        const index = this.index;\n        if (index > 0) {\n            this.parent.children.splice(index, 1);\n            this.parent.children.splice(index - 1, 0, this);\n            this.parent._setChildrenIndices();\n            return true;\n        }\n        return false;\n    }\n    moveToBottom() {\n        if (!this.parent) {\n            Util.warn('Node has no parent. moveToBottom function is ignored.');\n            return false;\n        }\n        const index = this.index;\n        if (index > 0) {\n            this.parent.children.splice(index, 1);\n            this.parent.children.unshift(this);\n            this.parent._setChildrenIndices();\n            return true;\n        }\n        return false;\n    }\n    setZIndex(zIndex) {\n        if (!this.parent) {\n            Util.warn('Node has no parent. zIndex parameter is ignored.');\n            return this;\n        }\n        if (zIndex < 0 || zIndex >= this.parent.children.length) {\n            Util.warn('Unexpected value ' +\n                zIndex +\n                ' for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to ' +\n                (this.parent.children.length - 1) +\n                '.');\n        }\n        const index = this.index;\n        this.parent.children.splice(index, 1);\n        this.parent.children.splice(zIndex, 0, this);\n        this.parent._setChildrenIndices();\n        return this;\n    }\n    getAbsoluteOpacity() {\n        return this._getCache(ABSOLUTE_OPACITY, this._getAbsoluteOpacity);\n    }\n    _getAbsoluteOpacity() {\n        let absOpacity = this.opacity();\n        const parent = this.getParent();\n        if (parent && !parent._isUnderCache) {\n            absOpacity *= parent.getAbsoluteOpacity();\n        }\n        return absOpacity;\n    }\n    moveTo(newContainer) {\n        if (this.getParent() !== newContainer) {\n            this._remove();\n            newContainer.add(this);\n        }\n        return this;\n    }\n    toObject() {\n        let attrs = this.getAttrs(), key, val, getter, defaultValue, nonPlainObject;\n        const obj = {\n            attrs: {},\n            className: this.getClassName(),\n        };\n        for (key in attrs) {\n            val = attrs[key];\n            nonPlainObject =\n                Util.isObject(val) && !Util._isPlainObject(val) && !Util._isArray(val);\n            if (nonPlainObject) {\n                continue;\n            }\n            getter = typeof this[key] === 'function' && this[key];\n            delete attrs[key];\n            defaultValue = getter ? getter.call(this) : null;\n            attrs[key] = val;\n            if (defaultValue !== val) {\n                obj.attrs[key] = val;\n            }\n        }\n        return Util._prepareToStringify(obj);\n    }\n    toJSON() {\n        return JSON.stringify(this.toObject());\n    }\n    getParent() {\n        return this.parent;\n    }\n    findAncestors(selector, includeSelf, stopNode) {\n        const res = [];\n        if (includeSelf && this._isMatch(selector)) {\n            res.push(this);\n        }\n        let ancestor = this.parent;\n        while (ancestor) {\n            if (ancestor === stopNode) {\n                return res;\n            }\n            if (ancestor._isMatch(selector)) {\n                res.push(ancestor);\n            }\n            ancestor = ancestor.parent;\n        }\n        return res;\n    }\n    isAncestorOf(node) {\n        return false;\n    }\n    findAncestor(selector, includeSelf, stopNode) {\n        return this.findAncestors(selector, includeSelf, stopNode)[0];\n    }\n    _isMatch(selector) {\n        if (!selector) {\n            return false;\n        }\n        if (typeof selector === 'function') {\n            return selector(this);\n        }\n        let selectorArr = selector.replace(/ /g, '').split(','), len = selectorArr.length, n, sel;\n        for (n = 0; n < len; n++) {\n            sel = selectorArr[n];\n            if (!Util.isValidSelector(sel)) {\n                Util.warn('Selector \"' +\n                    sel +\n                    '\" is invalid. Allowed selectors examples are \"#foo\", \".bar\" or \"Group\".');\n                Util.warn('If you have a custom shape with such className, please change it to start with upper letter like \"Triangle\".');\n                Util.warn('Konva is awesome, right?');\n            }\n            if (sel.charAt(0) === '#') {\n                if (this.id() === sel.slice(1)) {\n                    return true;\n                }\n            }\n            else if (sel.charAt(0) === '.') {\n                if (this.hasName(sel.slice(1))) {\n                    return true;\n                }\n            }\n            else if (this.className === sel || this.nodeType === sel) {\n                return true;\n            }\n        }\n        return false;\n    }\n    getLayer() {\n        const parent = this.getParent();\n        return parent ? parent.getLayer() : null;\n    }\n    getStage() {\n        return this._getCache(STAGE, this._getStage);\n    }\n    _getStage() {\n        const parent = this.getParent();\n        if (parent) {\n            return parent.getStage();\n        }\n        else {\n            return null;\n        }\n    }\n    fire(eventType, evt = {}, bubble) {\n        evt.target = evt.target || this;\n        if (bubble) {\n            this._fireAndBubble(eventType, evt);\n        }\n        else {\n            this._fire(eventType, evt);\n        }\n        return this;\n    }\n    getAbsoluteTransform(top) {\n        if (top) {\n            return this._getAbsoluteTransform(top);\n        }\n        else {\n            return this._getCache(ABSOLUTE_TRANSFORM, this._getAbsoluteTransform);\n        }\n    }\n    _getAbsoluteTransform(top) {\n        let at;\n        if (top) {\n            at = new Transform();\n            this._eachAncestorReverse(function (node) {\n                const transformsEnabled = node.transformsEnabled();\n                if (transformsEnabled === 'all') {\n                    at.multiply(node.getTransform());\n                }\n                else if (transformsEnabled === 'position') {\n                    at.translate(node.x() - node.offsetX(), node.y() - node.offsetY());\n                }\n            }, top);\n            return at;\n        }\n        else {\n            at = this._cache.get(ABSOLUTE_TRANSFORM) || new Transform();\n            if (this.parent) {\n                this.parent.getAbsoluteTransform().copyInto(at);\n            }\n            else {\n                at.reset();\n            }\n            const transformsEnabled = this.transformsEnabled();\n            if (transformsEnabled === 'all') {\n                at.multiply(this.getTransform());\n            }\n            else if (transformsEnabled === 'position') {\n                const x = this.attrs.x || 0;\n                const y = this.attrs.y || 0;\n                const offsetX = this.attrs.offsetX || 0;\n                const offsetY = this.attrs.offsetY || 0;\n                at.translate(x - offsetX, y - offsetY);\n            }\n            at.dirty = false;\n            return at;\n        }\n    }\n    getAbsoluteScale(top) {\n        let parent = this;\n        while (parent) {\n            if (parent._isUnderCache) {\n                top = parent;\n            }\n            parent = parent.getParent();\n        }\n        const transform = this.getAbsoluteTransform(top);\n        const attrs = transform.decompose();\n        return {\n            x: attrs.scaleX,\n            y: attrs.scaleY,\n        };\n    }\n    getAbsoluteRotation() {\n        return this.getAbsoluteTransform().decompose().rotation;\n    }\n    getTransform() {\n        return this._getCache(TRANSFORM, this._getTransform);\n    }\n    _getTransform() {\n        var _a, _b;\n        const m = this._cache.get(TRANSFORM) || new Transform();\n        m.reset();\n        const x = this.x(), y = this.y(), rotation = Konva.getAngle(this.rotation()), scaleX = (_a = this.attrs.scaleX) !== null && _a !== void 0 ? _a : 1, scaleY = (_b = this.attrs.scaleY) !== null && _b !== void 0 ? _b : 1, skewX = this.attrs.skewX || 0, skewY = this.attrs.skewY || 0, offsetX = this.attrs.offsetX || 0, offsetY = this.attrs.offsetY || 0;\n        if (x !== 0 || y !== 0) {\n            m.translate(x, y);\n        }\n        if (rotation !== 0) {\n            m.rotate(rotation);\n        }\n        if (skewX !== 0 || skewY !== 0) {\n            m.skew(skewX, skewY);\n        }\n        if (scaleX !== 1 || scaleY !== 1) {\n            m.scale(scaleX, scaleY);\n        }\n        if (offsetX !== 0 || offsetY !== 0) {\n            m.translate(-1 * offsetX, -1 * offsetY);\n        }\n        m.dirty = false;\n        return m;\n    }\n    clone(obj) {\n        let attrs = Util.cloneObject(this.attrs), key, allListeners, len, n, listener;\n        for (key in obj) {\n            attrs[key] = obj[key];\n        }\n        const node = new this.constructor(attrs);\n        for (key in this.eventListeners) {\n            allListeners = this.eventListeners[key];\n            len = allListeners.length;\n            for (n = 0; n < len; n++) {\n                listener = allListeners[n];\n                if (listener.name.indexOf(KONVA) < 0) {\n                    if (!node.eventListeners[key]) {\n                        node.eventListeners[key] = [];\n                    }\n                    node.eventListeners[key].push(listener);\n                }\n            }\n        }\n        return node;\n    }\n    _toKonvaCanvas(config) {\n        config = config || {};\n        const box = this.getClientRect();\n        const stage = this.getStage(), x = config.x !== undefined ? config.x : Math.floor(box.x), y = config.y !== undefined ? config.y : Math.floor(box.y), pixelRatio = config.pixelRatio || 1, canvas = new SceneCanvas({\n            width: config.width || Math.ceil(box.width) || (stage ? stage.width() : 0),\n            height: config.height ||\n                Math.ceil(box.height) ||\n                (stage ? stage.height() : 0),\n            pixelRatio: pixelRatio,\n        }), context = canvas.getContext();\n        const bufferCanvas = new SceneCanvas({\n            width: canvas.width / canvas.pixelRatio + Math.abs(x),\n            height: canvas.height / canvas.pixelRatio + Math.abs(y),\n            pixelRatio: canvas.pixelRatio,\n        });\n        if (config.imageSmoothingEnabled === false) {\n            context._context.imageSmoothingEnabled = false;\n        }\n        context.save();\n        if (x || y) {\n            context.translate(-1 * x, -1 * y);\n        }\n        this.drawScene(canvas, undefined, bufferCanvas);\n        context.restore();\n        return canvas;\n    }\n    toCanvas(config) {\n        return this._toKonvaCanvas(config)._canvas;\n    }\n    toDataURL(config) {\n        config = config || {};\n        const mimeType = config.mimeType || null, quality = config.quality || null;\n        const url = this._toKonvaCanvas(config).toDataURL(mimeType, quality);\n        if (config.callback) {\n            config.callback(url);\n        }\n        return url;\n    }\n    toImage(config) {\n        return new Promise((resolve, reject) => {\n            try {\n                const callback = config === null || config === void 0 ? void 0 : config.callback;\n                if (callback)\n                    delete config.callback;\n                Util._urlToImage(this.toDataURL(config), function (img) {\n                    resolve(img);\n                    callback === null || callback === void 0 ? void 0 : callback(img);\n                });\n            }\n            catch (err) {\n                reject(err);\n            }\n        });\n    }\n    toBlob(config) {\n        return new Promise((resolve, reject) => {\n            try {\n                const callback = config === null || config === void 0 ? void 0 : config.callback;\n                if (callback)\n                    delete config.callback;\n                this.toCanvas(config).toBlob((blob) => {\n                    resolve(blob);\n                    callback === null || callback === void 0 ? void 0 : callback(blob);\n                }, config === null || config === void 0 ? void 0 : config.mimeType, config === null || config === void 0 ? void 0 : config.quality);\n            }\n            catch (err) {\n                reject(err);\n            }\n        });\n    }\n    setSize(size) {\n        this.width(size.width);\n        this.height(size.height);\n        return this;\n    }\n    getSize() {\n        return {\n            width: this.width(),\n            height: this.height(),\n        };\n    }\n    getClassName() {\n        return this.className || this.nodeType;\n    }\n    getType() {\n        return this.nodeType;\n    }\n    getDragDistance() {\n        if (this.attrs.dragDistance !== undefined) {\n            return this.attrs.dragDistance;\n        }\n        else if (this.parent) {\n            return this.parent.getDragDistance();\n        }\n        else {\n            return Konva.dragDistance;\n        }\n    }\n    _off(type, name, callback) {\n        let evtListeners = this.eventListeners[type], i, evtName, handler;\n        for (i = 0; i < evtListeners.length; i++) {\n            evtName = evtListeners[i].name;\n            handler = evtListeners[i].handler;\n            if ((evtName !== 'konva' || name === 'konva') &&\n                (!name || evtName === name) &&\n                (!callback || callback === handler)) {\n                evtListeners.splice(i, 1);\n                if (evtListeners.length === 0) {\n                    delete this.eventListeners[type];\n                    break;\n                }\n                i--;\n            }\n        }\n    }\n    _fireChangeEvent(attr, oldVal, newVal) {\n        this._fire(attr + CHANGE, {\n            oldVal: oldVal,\n            newVal: newVal,\n        });\n    }\n    addName(name) {\n        if (!this.hasName(name)) {\n            const oldName = this.name();\n            const newName = oldName ? oldName + ' ' + name : name;\n            this.name(newName);\n        }\n        return this;\n    }\n    hasName(name) {\n        if (!name) {\n            return false;\n        }\n        const fullName = this.name();\n        if (!fullName) {\n            return false;\n        }\n        const names = (fullName || '').split(/\\s/g);\n        return names.indexOf(name) !== -1;\n    }\n    removeName(name) {\n        const names = (this.name() || '').split(/\\s/g);\n        const index = names.indexOf(name);\n        if (index !== -1) {\n            names.splice(index, 1);\n            this.name(names.join(' '));\n        }\n        return this;\n    }\n    setAttr(attr, val) {\n        const func = this[SET + Util._capitalize(attr)];\n        if (Util._isFunction(func)) {\n            func.call(this, val);\n        }\n        else {\n            this._setAttr(attr, val);\n        }\n        return this;\n    }\n    _requestDraw() {\n        if (Konva.autoDrawEnabled) {\n            const drawNode = this.getLayer() || this.getStage();\n            drawNode === null || drawNode === void 0 ? void 0 : drawNode.batchDraw();\n        }\n    }\n    _setAttr(key, val) {\n        const oldVal = this.attrs[key];\n        if (oldVal === val && !Util.isObject(val)) {\n            return;\n        }\n        if (val === undefined || val === null) {\n            delete this.attrs[key];\n        }\n        else {\n            this.attrs[key] = val;\n        }\n        if (this._shouldFireChangeEvents) {\n            this._fireChangeEvent(key, oldVal, val);\n        }\n        this._requestDraw();\n    }\n    _setComponentAttr(key, component, val) {\n        let oldVal;\n        if (val !== undefined) {\n            oldVal = this.attrs[key];\n            if (!oldVal) {\n                this.attrs[key] = this.getAttr(key);\n            }\n            this.attrs[key][component] = val;\n            this._fireChangeEvent(key, oldVal, val);\n        }\n    }\n    _fireAndBubble(eventType, evt, compareShape) {\n        if (evt && this.nodeType === SHAPE) {\n            evt.target = this;\n        }\n        const nonBubbling = [\n            MOUSEENTER,\n            MOUSELEAVE,\n            POINTERENTER,\n            POINTERLEAVE,\n            TOUCHENTER,\n            TOUCHLEAVE,\n        ];\n        const shouldStop = nonBubbling.indexOf(eventType) !== -1 &&\n            ((compareShape &&\n                (this === compareShape ||\n                    (this.isAncestorOf && this.isAncestorOf(compareShape)))) ||\n                (this.nodeType === 'Stage' && !compareShape));\n        if (!shouldStop) {\n            this._fire(eventType, evt);\n            const stopBubble = nonBubbling.indexOf(eventType) !== -1 &&\n                compareShape &&\n                compareShape.isAncestorOf &&\n                compareShape.isAncestorOf(this) &&\n                !compareShape.isAncestorOf(this.parent);\n            if (((evt && !evt.cancelBubble) || !evt) &&\n                this.parent &&\n                this.parent.isListening() &&\n                !stopBubble) {\n                if (compareShape && compareShape.parent) {\n                    this._fireAndBubble.call(this.parent, eventType, evt, compareShape);\n                }\n                else {\n                    this._fireAndBubble.call(this.parent, eventType, evt);\n                }\n            }\n        }\n    }\n    _getProtoListeners(eventType) {\n        var _a, _b, _c;\n        const allListeners = (_a = this._cache.get(ALL_LISTENERS)) !== null && _a !== void 0 ? _a : {};\n        let events = allListeners === null || allListeners === void 0 ? void 0 : allListeners[eventType];\n        if (events === undefined) {\n            events = [];\n            let obj = Object.getPrototypeOf(this);\n            while (obj) {\n                const hierarchyEvents = (_c = (_b = obj.eventListeners) === null || _b === void 0 ? void 0 : _b[eventType]) !== null && _c !== void 0 ? _c : [];\n                events.push(...hierarchyEvents);\n                obj = Object.getPrototypeOf(obj);\n            }\n            allListeners[eventType] = events;\n            this._cache.set(ALL_LISTENERS, allListeners);\n        }\n        return events;\n    }\n    _fire(eventType, evt) {\n        evt = evt || {};\n        evt.currentTarget = this;\n        evt.type = eventType;\n        const topListeners = this._getProtoListeners(eventType);\n        if (topListeners) {\n            for (let i = 0; i < topListeners.length; i++) {\n                topListeners[i].handler.call(this, evt);\n            }\n        }\n        const selfListeners = this.eventListeners[eventType];\n        if (selfListeners) {\n            for (let i = 0; i < selfListeners.length; i++) {\n                selfListeners[i].handler.call(this, evt);\n            }\n        }\n    }\n    draw() {\n        this.drawScene();\n        this.drawHit();\n        return this;\n    }\n    _createDragElement(evt) {\n        const pointerId = evt ? evt.pointerId : undefined;\n        const stage = this.getStage();\n        const ap = this.getAbsolutePosition();\n        if (!stage) {\n            return;\n        }\n        const pos = stage._getPointerById(pointerId) ||\n            stage._changedPointerPositions[0] ||\n            ap;\n        DD._dragElements.set(this._id, {\n            node: this,\n            startPointerPos: pos,\n            offset: {\n                x: pos.x - ap.x,\n                y: pos.y - ap.y,\n            },\n            dragStatus: 'ready',\n            pointerId,\n        });\n    }\n    startDrag(evt, bubbleEvent = true) {\n        if (!DD._dragElements.has(this._id)) {\n            this._createDragElement(evt);\n        }\n        const elem = DD._dragElements.get(this._id);\n        elem.dragStatus = 'dragging';\n        this.fire('dragstart', {\n            type: 'dragstart',\n            target: this,\n            evt: evt && evt.evt,\n        }, bubbleEvent);\n    }\n    _setDragPosition(evt, elem) {\n        const pos = this.getStage()._getPointerById(elem.pointerId);\n        if (!pos) {\n            return;\n        }\n        let newNodePos = {\n            x: pos.x - elem.offset.x,\n            y: pos.y - elem.offset.y,\n        };\n        const dbf = this.dragBoundFunc();\n        if (dbf !== undefined) {\n            const bounded = dbf.call(this, newNodePos, evt);\n            if (!bounded) {\n                Util.warn('dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.');\n            }\n            else {\n                newNodePos = bounded;\n            }\n        }\n        if (!this._lastPos ||\n            this._lastPos.x !== newNodePos.x ||\n            this._lastPos.y !== newNodePos.y) {\n            this.setAbsolutePosition(newNodePos);\n            this._requestDraw();\n        }\n        this._lastPos = newNodePos;\n    }\n    stopDrag(evt) {\n        const elem = DD._dragElements.get(this._id);\n        if (elem) {\n            elem.dragStatus = 'stopped';\n        }\n        DD._endDragBefore(evt);\n        DD._endDragAfter(evt);\n    }\n    setDraggable(draggable) {\n        this._setAttr('draggable', draggable);\n        this._dragChange();\n    }\n    isDragging() {\n        const elem = DD._dragElements.get(this._id);\n        return elem ? elem.dragStatus === 'dragging' : false;\n    }\n    _listenDrag() {\n        this._dragCleanup();\n        this.on('mousedown.konva touchstart.konva', function (evt) {\n            const shouldCheckButton = evt.evt['button'] !== undefined;\n            const canDrag = !shouldCheckButton || Konva.dragButtons.indexOf(evt.evt['button']) >= 0;\n            if (!canDrag) {\n                return;\n            }\n            if (this.isDragging()) {\n                return;\n            }\n            let hasDraggingChild = false;\n            DD._dragElements.forEach((elem) => {\n                if (this.isAncestorOf(elem.node)) {\n                    hasDraggingChild = true;\n                }\n            });\n            if (!hasDraggingChild) {\n                this._createDragElement(evt);\n            }\n        });\n    }\n    _dragChange() {\n        if (this.attrs.draggable) {\n            this._listenDrag();\n        }\n        else {\n            this._dragCleanup();\n            const stage = this.getStage();\n            if (!stage) {\n                return;\n            }\n            const dragElement = DD._dragElements.get(this._id);\n            const isDragging = dragElement && dragElement.dragStatus === 'dragging';\n            const isReady = dragElement && dragElement.dragStatus === 'ready';\n            if (isDragging) {\n                this.stopDrag();\n            }\n            else if (isReady) {\n                DD._dragElements.delete(this._id);\n            }\n        }\n    }\n    _dragCleanup() {\n        this.off('mousedown.konva');\n        this.off('touchstart.konva');\n    }\n    isClientRectOnScreen(margin = { x: 0, y: 0 }) {\n        const stage = this.getStage();\n        if (!stage) {\n            return false;\n        }\n        const screenRect = {\n            x: -margin.x,\n            y: -margin.y,\n            width: stage.width() + 2 * margin.x,\n            height: stage.height() + 2 * margin.y,\n        };\n        return Util.haveIntersection(screenRect, this.getClientRect());\n    }\n    static create(data, container) {\n        if (Util._isString(data)) {\n            data = JSON.parse(data);\n        }\n        return this._createNode(data, container);\n    }\n    static _createNode(obj, container) {\n        let className = Node.prototype.getClassName.call(obj), children = obj.children, no, len, n;\n        if (container) {\n            obj.attrs.container = container;\n        }\n        if (!Konva[className]) {\n            Util.warn('Can not find a node with class name \"' +\n                className +\n                '\". Fallback to \"Shape\".');\n            className = 'Shape';\n        }\n        const Class = Konva[className];\n        no = new Class(obj.attrs);\n        if (children) {\n            len = children.length;\n            for (n = 0; n < len; n++) {\n                no.add(Node._createNode(children[n]));\n            }\n        }\n        return no;\n    }\n}\nNode.prototype.nodeType = 'Node';\nNode.prototype._attrsAffectingSize = [];\nNode.prototype.eventListeners = {};\nNode.prototype.on.call(Node.prototype, TRANSFORM_CHANGE_STR, function () {\n    if (this._batchingTransformChange) {\n        this._needClearTransformCache = true;\n        return;\n    }\n    this._clearCache(TRANSFORM);\n    this._clearSelfAndDescendantCache(ABSOLUTE_TRANSFORM);\n});\nNode.prototype.on.call(Node.prototype, 'visibleChange.konva', function () {\n    this._clearSelfAndDescendantCache(VISIBLE);\n});\nNode.prototype.on.call(Node.prototype, 'listeningChange.konva', function () {\n    this._clearSelfAndDescendantCache(LISTENING);\n});\nNode.prototype.on.call(Node.prototype, 'opacityChange.konva', function () {\n    this._clearSelfAndDescendantCache(ABSOLUTE_OPACITY);\n});\nconst addGetterSetter = Factory.addGetterSetter;\naddGetterSetter(Node, 'zIndex');\naddGetterSetter(Node, 'absolutePosition');\naddGetterSetter(Node, 'position');\naddGetterSetter(Node, 'x', 0, getNumberValidator());\naddGetterSetter(Node, 'y', 0, getNumberValidator());\naddGetterSetter(Node, 'globalCompositeOperation', 'source-over', getStringValidator());\naddGetterSetter(Node, 'opacity', 1, getNumberValidator());\naddGetterSetter(Node, 'name', '', getStringValidator());\naddGetterSetter(Node, 'id', '', getStringValidator());\naddGetterSetter(Node, 'rotation', 0, getNumberValidator());\nFactory.addComponentsGetterSetter(Node, 'scale', ['x', 'y']);\naddGetterSetter(Node, 'scaleX', 1, getNumberValidator());\naddGetterSetter(Node, 'scaleY', 1, getNumberValidator());\nFactory.addComponentsGetterSetter(Node, 'skew', ['x', 'y']);\naddGetterSetter(Node, 'skewX', 0, getNumberValidator());\naddGetterSetter(Node, 'skewY', 0, getNumberValidator());\nFactory.addComponentsGetterSetter(Node, 'offset', ['x', 'y']);\naddGetterSetter(Node, 'offsetX', 0, getNumberValidator());\naddGetterSetter(Node, 'offsetY', 0, getNumberValidator());\naddGetterSetter(Node, 'dragDistance', undefined, getNumberValidator());\naddGetterSetter(Node, 'width', 0, getNumberValidator());\naddGetterSetter(Node, 'height', 0, getNumberValidator());\naddGetterSetter(Node, 'listening', true, getBooleanValidator());\naddGetterSetter(Node, 'preventDefault', true, getBooleanValidator());\naddGetterSetter(Node, 'filters', undefined, function (val) {\n    this._filterUpToDate = false;\n    return val;\n});\naddGetterSetter(Node, 'visible', true, getBooleanValidator());\naddGetterSetter(Node, 'transformsEnabled', 'all', getStringValidator());\naddGetterSetter(Node, 'size');\naddGetterSetter(Node, 'dragBoundFunc');\naddGetterSetter(Node, 'draggable', false, getBooleanValidator());\nFactory.backCompat(Node, {\n    rotateDeg: 'rotate',\n    setRotationDeg: 'setRotation',\n    getRotationDeg: 'getRotation',\n});\n", "import { Factory } from \"./Factory.js\";\nimport { Node } from \"./Node.js\";\nimport { getNumberValidator } from \"./Validators.js\";\nexport class Container extends Node {\n    constructor() {\n        super(...arguments);\n        this.children = [];\n    }\n    getChildren(filterFunc) {\n        const children = this.children || [];\n        if (filterFunc) {\n            return children.filter(filterFunc);\n        }\n        return children;\n    }\n    hasChildren() {\n        return this.getChildren().length > 0;\n    }\n    removeChildren() {\n        this.getChildren().forEach((child) => {\n            child.parent = null;\n            child.index = 0;\n            child.remove();\n        });\n        this.children = [];\n        this._requestDraw();\n        return this;\n    }\n    destroyChildren() {\n        this.getChildren().forEach((child) => {\n            child.parent = null;\n            child.index = 0;\n            child.destroy();\n        });\n        this.children = [];\n        this._requestDraw();\n        return this;\n    }\n    add(...children) {\n        if (children.length === 0) {\n            return this;\n        }\n        if (children.length > 1) {\n            for (let i = 0; i < children.length; i++) {\n                this.add(children[i]);\n            }\n            return this;\n        }\n        const child = children[0];\n        if (child.getParent()) {\n            child.moveTo(this);\n            return this;\n        }\n        this._validateAdd(child);\n        child.index = this.getChildren().length;\n        child.parent = this;\n        child._clearCaches();\n        this.getChildren().push(child);\n        this._fire('add', {\n            child: child,\n        });\n        this._requestDraw();\n        return this;\n    }\n    destroy() {\n        if (this.hasChildren()) {\n            this.destroyChildren();\n        }\n        super.destroy();\n        return this;\n    }\n    find(selector) {\n        return this._generalFind(selector, false);\n    }\n    findOne(selector) {\n        const result = this._generalFind(selector, true);\n        return result.length > 0 ? result[0] : undefined;\n    }\n    _generalFind(selector, findOne) {\n        const retArr = [];\n        this._descendants((node) => {\n            const valid = node._isMatch(selector);\n            if (valid) {\n                retArr.push(node);\n            }\n            if (valid && findOne) {\n                return true;\n            }\n            return false;\n        });\n        return retArr;\n    }\n    _descendants(fn) {\n        let shouldStop = false;\n        const children = this.getChildren();\n        for (const child of children) {\n            shouldStop = fn(child);\n            if (shouldStop) {\n                return true;\n            }\n            if (!child.hasChildren()) {\n                continue;\n            }\n            shouldStop = child._descendants(fn);\n            if (shouldStop) {\n                return true;\n            }\n        }\n        return false;\n    }\n    toObject() {\n        const obj = Node.prototype.toObject.call(this);\n        obj.children = [];\n        this.getChildren().forEach((child) => {\n            obj.children.push(child.toObject());\n        });\n        return obj;\n    }\n    isAncestorOf(node) {\n        let parent = node.getParent();\n        while (parent) {\n            if (parent._id === this._id) {\n                return true;\n            }\n            parent = parent.getParent();\n        }\n        return false;\n    }\n    clone(obj) {\n        const node = Node.prototype.clone.call(this, obj);\n        this.getChildren().forEach(function (no) {\n            node.add(no.clone());\n        });\n        return node;\n    }\n    getAllIntersections(pos) {\n        const arr = [];\n        this.find('Shape').forEach((shape) => {\n            if (shape.isVisible() && shape.intersects(pos)) {\n                arr.push(shape);\n            }\n        });\n        return arr;\n    }\n    _clearSelfAndDescendantCache(attr) {\n        var _a;\n        super._clearSelfAndDescendantCache(attr);\n        if (this.isCached()) {\n            return;\n        }\n        (_a = this.children) === null || _a === void 0 ? void 0 : _a.forEach(function (node) {\n            node._clearSelfAndDescendantCache(attr);\n        });\n    }\n    _setChildrenIndices() {\n        var _a;\n        (_a = this.children) === null || _a === void 0 ? void 0 : _a.forEach(function (child, n) {\n            child.index = n;\n        });\n        this._requestDraw();\n    }\n    drawScene(can, top, bufferCanvas) {\n        const layer = this.getLayer(), canvas = can || (layer && layer.getCanvas()), context = canvas && canvas.getContext(), cachedCanvas = this._getCanvasCache(), cachedSceneCanvas = cachedCanvas && cachedCanvas.scene;\n        const caching = canvas && canvas.isCache;\n        if (!this.isVisible() && !caching) {\n            return this;\n        }\n        if (cachedSceneCanvas) {\n            context.save();\n            const m = this.getAbsoluteTransform(top).getMatrix();\n            context.transform(m[0], m[1], m[2], m[3], m[4], m[5]);\n            this._drawCachedSceneCanvas(context);\n            context.restore();\n        }\n        else {\n            this._drawChildren('drawScene', canvas, top, bufferCanvas);\n        }\n        return this;\n    }\n    drawHit(can, top) {\n        if (!this.shouldDrawHit(top)) {\n            return this;\n        }\n        const layer = this.getLayer(), canvas = can || (layer && layer.hitCanvas), context = canvas && canvas.getContext(), cachedCanvas = this._getCanvasCache(), cachedHitCanvas = cachedCanvas && cachedCanvas.hit;\n        if (cachedHitCanvas) {\n            context.save();\n            const m = this.getAbsoluteTransform(top).getMatrix();\n            context.transform(m[0], m[1], m[2], m[3], m[4], m[5]);\n            this._drawCachedHitCanvas(context);\n            context.restore();\n        }\n        else {\n            this._drawChildren('drawHit', canvas, top);\n        }\n        return this;\n    }\n    _drawChildren(drawMethod, canvas, top, bufferCanvas) {\n        var _a;\n        const context = canvas && canvas.getContext(), clipWidth = this.clipWidth(), clipHeight = this.clipHeight(), clipFunc = this.clipFunc(), hasClip = (typeof clipWidth === 'number' && typeof clipHeight === 'number') ||\n            clipFunc;\n        const selfCache = top === this;\n        if (hasClip) {\n            context.save();\n            const transform = this.getAbsoluteTransform(top);\n            let m = transform.getMatrix();\n            context.transform(m[0], m[1], m[2], m[3], m[4], m[5]);\n            context.beginPath();\n            let clipArgs;\n            if (clipFunc) {\n                clipArgs = clipFunc.call(this, context, this);\n            }\n            else {\n                const clipX = this.clipX();\n                const clipY = this.clipY();\n                context.rect(clipX || 0, clipY || 0, clipWidth, clipHeight);\n            }\n            context.clip.apply(context, clipArgs);\n            m = transform.copy().invert().getMatrix();\n            context.transform(m[0], m[1], m[2], m[3], m[4], m[5]);\n        }\n        const hasComposition = !selfCache &&\n            this.globalCompositeOperation() !== 'source-over' &&\n            drawMethod === 'drawScene';\n        if (hasComposition) {\n            context.save();\n            context._applyGlobalCompositeOperation(this);\n        }\n        (_a = this.children) === null || _a === void 0 ? void 0 : _a.forEach(function (child) {\n            child[drawMethod](canvas, top, bufferCanvas);\n        });\n        if (hasComposition) {\n            context.restore();\n        }\n        if (hasClip) {\n            context.restore();\n        }\n    }\n    getClientRect(config = {}) {\n        var _a;\n        const skipTransform = config.skipTransform;\n        const relativeTo = config.relativeTo;\n        let minX, minY, maxX, maxY;\n        let selfRect = {\n            x: Infinity,\n            y: Infinity,\n            width: 0,\n            height: 0,\n        };\n        const that = this;\n        (_a = this.children) === null || _a === void 0 ? void 0 : _a.forEach(function (child) {\n            if (!child.visible()) {\n                return;\n            }\n            const rect = child.getClientRect({\n                relativeTo: that,\n                skipShadow: config.skipShadow,\n                skipStroke: config.skipStroke,\n            });\n            if (rect.width === 0 && rect.height === 0) {\n                return;\n            }\n            if (minX === undefined) {\n                minX = rect.x;\n                minY = rect.y;\n                maxX = rect.x + rect.width;\n                maxY = rect.y + rect.height;\n            }\n            else {\n                minX = Math.min(minX, rect.x);\n                minY = Math.min(minY, rect.y);\n                maxX = Math.max(maxX, rect.x + rect.width);\n                maxY = Math.max(maxY, rect.y + rect.height);\n            }\n        });\n        const shapes = this.find('Shape');\n        let hasVisible = false;\n        for (let i = 0; i < shapes.length; i++) {\n            const shape = shapes[i];\n            if (shape._isVisible(this)) {\n                hasVisible = true;\n                break;\n            }\n        }\n        if (hasVisible && minX !== undefined) {\n            selfRect = {\n                x: minX,\n                y: minY,\n                width: maxX - minX,\n                height: maxY - minY,\n            };\n        }\n        else {\n            selfRect = {\n                x: 0,\n                y: 0,\n                width: 0,\n                height: 0,\n            };\n        }\n        if (!skipTransform) {\n            return this._transformedRect(selfRect, relativeTo);\n        }\n        return selfRect;\n    }\n}\nFactory.addComponentsGetterSetter(Container, 'clip', [\n    'x',\n    'y',\n    'width',\n    'height',\n]);\nFactory.addGetterSetter(Container, 'clipX', undefined, getNumberValidator());\nFactory.addGetterSetter(Container, 'clipY', undefined, getNumberValidator());\nFactory.addGetterSetter(Container, 'clipWidth', undefined, getNumberValidator());\nFactory.addGetterSetter(Container, 'clipHeight', undefined, getNumberValidator());\nFactory.addGetterSetter(Container, 'clipFunc');\n", "import { Konva } from \"./Global.js\";\nconst Captures = new Map();\nconst SUPPORT_POINTER_EVENTS = Konva._global['PointerEvent'] !== undefined;\nexport function getCapturedShape(pointerId) {\n    return Captures.get(pointerId);\n}\nexport function createEvent(evt) {\n    return {\n        evt,\n        pointerId: evt.pointerId,\n    };\n}\nexport function hasPointerCapture(pointerId, shape) {\n    return Captures.get(pointerId) === shape;\n}\nexport function setPointerCapture(pointerId, shape) {\n    releaseCapture(pointerId);\n    const stage = shape.getStage();\n    if (!stage)\n        return;\n    Captures.set(pointerId, shape);\n    if (SUPPORT_POINTER_EVENTS) {\n        shape._fire('gotpointercapture', createEvent(new PointerEvent('gotpointercapture')));\n    }\n}\nexport function releaseCapture(pointerId, target) {\n    const shape = Captures.get(pointerId);\n    if (!shape)\n        return;\n    const stage = shape.getStage();\n    if (stage && stage.content) {\n    }\n    Captures.delete(pointerId);\n    if (SUPPORT_POINTER_EVENTS) {\n        shape._fire('lostpointercapture', createEvent(new PointerEvent('lostpointercapture')));\n    }\n}\n", "import { Util } from \"./Util.js\";\nimport { Factory } from \"./Factory.js\";\nimport { Container } from \"./Container.js\";\nimport { Konva } from \"./Global.js\";\nimport { SceneCanvas, HitCanvas } from \"./Canvas.js\";\nimport { DD } from \"./DragAndDrop.js\";\nimport { _registerNode } from \"./Global.js\";\nimport * as PointerEvents from \"./PointerEvents.js\";\nconst STAGE = 'Stage', STRING = 'string', PX = 'px', MOUSEOUT = 'mouseout', MOUSELEAVE = 'mouseleave', MOUSEOVER = 'mouseover', MOUSEENTER = 'mouseenter', MOUSEMOVE = 'mousemove', MOUSEDOWN = 'mousedown', MOUSEUP = 'mouseup', POINTERMOVE = 'pointermove', POINTERDOWN = 'pointerdown', POINTERUP = 'pointerup', POINTERCANCEL = 'pointercancel', LOSTPOINTERCAPTURE = 'lostpointercapture', POINTEROUT = 'pointerout', POINTERLEAVE = 'pointerleave', POINTEROVER = 'pointerover', POINTERENTER = 'pointerenter', CONTEXTMENU = 'contextmenu', TOUCHSTART = 'touchstart', TOUCHEND = 'touchend', TOUCHMOVE = 'touchmove', TOUCHCANCEL = 'touchcancel', WHEEL = 'wheel', MAX_LAYERS_NUMBER = 5, EVENTS = [\n    [MOUSEENTER, '_pointerenter'],\n    [MOUSEDOWN, '_pointerdown'],\n    [MOUSEMOVE, '_pointermove'],\n    [MOUSEUP, '_pointerup'],\n    [MOUSELEAVE, '_pointerleave'],\n    [TOUCHSTART, '_pointerdown'],\n    [TOUCHMOVE, '_pointermove'],\n    [TOUCHEND, '_pointerup'],\n    [TOUCHCANCEL, '_pointercancel'],\n    [MOUSEOVER, '_pointerover'],\n    [WHEEL, '_wheel'],\n    [CONTEXTMENU, '_contextmenu'],\n    [POINTERDOWN, '_pointerdown'],\n    [POINTERMOVE, '_pointermove'],\n    [POINTERUP, '_pointerup'],\n    [POINTERCANCEL, '_pointercancel'],\n    [POINTERLEAVE, '_pointerleave'],\n    [LOSTPOINTERCAPTURE, '_lostpointercapture'],\n];\nconst EVENTS_MAP = {\n    mouse: {\n        [POINTEROUT]: MOUSEOUT,\n        [POINTERLEAVE]: MOUSELEAVE,\n        [POINTEROVER]: MOUSEOVER,\n        [POINTERENTER]: MOUSEENTER,\n        [POINTERMOVE]: MOUSEMOVE,\n        [POINTERDOWN]: MOUSEDOWN,\n        [POINTERUP]: MOUSEUP,\n        [POINTERCANCEL]: 'mousecancel',\n        pointerclick: 'click',\n        pointerdblclick: 'dblclick',\n    },\n    touch: {\n        [POINTEROUT]: 'touchout',\n        [POINTERLEAVE]: 'touchleave',\n        [POINTEROVER]: 'touchover',\n        [POINTERENTER]: 'touchenter',\n        [POINTERMOVE]: TOUCHMOVE,\n        [POINTERDOWN]: TOUCHSTART,\n        [POINTERUP]: TOUCHEND,\n        [POINTERCANCEL]: TOUCHCANCEL,\n        pointerclick: 'tap',\n        pointerdblclick: 'dbltap',\n    },\n    pointer: {\n        [POINTEROUT]: POINTEROUT,\n        [POINTERLEAVE]: POINTERLEAVE,\n        [POINTEROVER]: POINTEROVER,\n        [POINTERENTER]: POINTERENTER,\n        [POINTERMOVE]: POINTERMOVE,\n        [POINTERDOWN]: POINTERDOWN,\n        [POINTERUP]: POINTERUP,\n        [POINTERCANCEL]: POINTERCANCEL,\n        pointerclick: 'pointerclick',\n        pointerdblclick: 'pointerdblclick',\n    },\n};\nconst getEventType = (type) => {\n    if (type.indexOf('pointer') >= 0) {\n        return 'pointer';\n    }\n    if (type.indexOf('touch') >= 0) {\n        return 'touch';\n    }\n    return 'mouse';\n};\nconst getEventsMap = (eventType) => {\n    const type = getEventType(eventType);\n    if (type === 'pointer') {\n        return Konva.pointerEventsEnabled && EVENTS_MAP.pointer;\n    }\n    if (type === 'touch') {\n        return EVENTS_MAP.touch;\n    }\n    if (type === 'mouse') {\n        return EVENTS_MAP.mouse;\n    }\n};\nfunction checkNoClip(attrs = {}) {\n    if (attrs.clipFunc || attrs.clipWidth || attrs.clipHeight) {\n        Util.warn('Stage does not support clipping. Please use clip for Layers or Groups.');\n    }\n    return attrs;\n}\nconst NO_POINTERS_MESSAGE = `Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);`;\nexport const stages = [];\nexport class Stage extends Container {\n    constructor(config) {\n        super(checkNoClip(config));\n        this._pointerPositions = [];\n        this._changedPointerPositions = [];\n        this._buildDOM();\n        this._bindContentEvents();\n        stages.push(this);\n        this.on('widthChange.konva heightChange.konva', this._resizeDOM);\n        this.on('visibleChange.konva', this._checkVisibility);\n        this.on('clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva', () => {\n            checkNoClip(this.attrs);\n        });\n        this._checkVisibility();\n    }\n    _validateAdd(child) {\n        const isLayer = child.getType() === 'Layer';\n        const isFastLayer = child.getType() === 'FastLayer';\n        const valid = isLayer || isFastLayer;\n        if (!valid) {\n            Util.throw('You may only add layers to the stage.');\n        }\n    }\n    _checkVisibility() {\n        if (!this.content) {\n            return;\n        }\n        const style = this.visible() ? '' : 'none';\n        this.content.style.display = style;\n    }\n    setContainer(container) {\n        if (typeof container === STRING) {\n            let id;\n            if (container.charAt(0) === '.') {\n                const className = container.slice(1);\n                container = document.getElementsByClassName(className)[0];\n            }\n            else {\n                if (container.charAt(0) !== '#') {\n                    id = container;\n                }\n                else {\n                    id = container.slice(1);\n                }\n                container = document.getElementById(id);\n            }\n            if (!container) {\n                throw 'Can not find container in document with id ' + id;\n            }\n        }\n        this._setAttr('container', container);\n        if (this.content) {\n            if (this.content.parentElement) {\n                this.content.parentElement.removeChild(this.content);\n            }\n            container.appendChild(this.content);\n        }\n        return this;\n    }\n    shouldDrawHit() {\n        return true;\n    }\n    clear() {\n        const layers = this.children, len = layers.length;\n        for (let n = 0; n < len; n++) {\n            layers[n].clear();\n        }\n        return this;\n    }\n    clone(obj) {\n        if (!obj) {\n            obj = {};\n        }\n        obj.container =\n            typeof document !== 'undefined' && document.createElement('div');\n        return Container.prototype.clone.call(this, obj);\n    }\n    destroy() {\n        super.destroy();\n        const content = this.content;\n        if (content && Util._isInDocument(content)) {\n            this.container().removeChild(content);\n        }\n        const index = stages.indexOf(this);\n        if (index > -1) {\n            stages.splice(index, 1);\n        }\n        Util.releaseCanvas(this.bufferCanvas._canvas, this.bufferHitCanvas._canvas);\n        return this;\n    }\n    getPointerPosition() {\n        const pos = this._pointerPositions[0] || this._changedPointerPositions[0];\n        if (!pos) {\n            Util.warn(NO_POINTERS_MESSAGE);\n            return null;\n        }\n        return {\n            x: pos.x,\n            y: pos.y,\n        };\n    }\n    _getPointerById(id) {\n        return this._pointerPositions.find((p) => p.id === id);\n    }\n    getPointersPositions() {\n        return this._pointerPositions;\n    }\n    getStage() {\n        return this;\n    }\n    getContent() {\n        return this.content;\n    }\n    _toKonvaCanvas(config) {\n        config = { ...config };\n        config.x = config.x || 0;\n        config.y = config.y || 0;\n        config.width = config.width || this.width();\n        config.height = config.height || this.height();\n        const canvas = new SceneCanvas({\n            width: config.width,\n            height: config.height,\n            pixelRatio: config.pixelRatio || 1,\n        });\n        const _context = canvas.getContext()._context;\n        const layers = this.children;\n        if (config.x || config.y) {\n            _context.translate(-1 * config.x, -1 * config.y);\n        }\n        layers.forEach(function (layer) {\n            if (!layer.isVisible()) {\n                return;\n            }\n            const layerCanvas = layer._toKonvaCanvas(config);\n            _context.drawImage(layerCanvas._canvas, config.x, config.y, layerCanvas.getWidth() / layerCanvas.getPixelRatio(), layerCanvas.getHeight() / layerCanvas.getPixelRatio());\n        });\n        return canvas;\n    }\n    getIntersection(pos) {\n        if (!pos) {\n            return null;\n        }\n        const layers = this.children, len = layers.length, end = len - 1;\n        for (let n = end; n >= 0; n--) {\n            const shape = layers[n].getIntersection(pos);\n            if (shape) {\n                return shape;\n            }\n        }\n        return null;\n    }\n    _resizeDOM() {\n        const width = this.width();\n        const height = this.height();\n        if (this.content) {\n            this.content.style.width = width + PX;\n            this.content.style.height = height + PX;\n        }\n        this.bufferCanvas.setSize(width, height);\n        this.bufferHitCanvas.setSize(width, height);\n        this.children.forEach((layer) => {\n            layer.setSize({ width, height });\n            layer.draw();\n        });\n    }\n    add(layer, ...rest) {\n        if (arguments.length > 1) {\n            for (let i = 0; i < arguments.length; i++) {\n                this.add(arguments[i]);\n            }\n            return this;\n        }\n        super.add(layer);\n        const length = this.children.length;\n        if (length > MAX_LAYERS_NUMBER) {\n            Util.warn('The stage has ' +\n                length +\n                ' layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group.');\n        }\n        layer.setSize({ width: this.width(), height: this.height() });\n        layer.draw();\n        if (Konva.isBrowser) {\n            this.content.appendChild(layer.canvas._canvas);\n        }\n        return this;\n    }\n    getParent() {\n        return null;\n    }\n    getLayer() {\n        return null;\n    }\n    hasPointerCapture(pointerId) {\n        return PointerEvents.hasPointerCapture(pointerId, this);\n    }\n    setPointerCapture(pointerId) {\n        PointerEvents.setPointerCapture(pointerId, this);\n    }\n    releaseCapture(pointerId) {\n        PointerEvents.releaseCapture(pointerId, this);\n    }\n    getLayers() {\n        return this.children;\n    }\n    _bindContentEvents() {\n        if (!Konva.isBrowser) {\n            return;\n        }\n        EVENTS.forEach(([event, methodName]) => {\n            this.content.addEventListener(event, (evt) => {\n                this[methodName](evt);\n            }, { passive: false });\n        });\n    }\n    _pointerenter(evt) {\n        this.setPointersPositions(evt);\n        const events = getEventsMap(evt.type);\n        if (events) {\n            this._fire(events.pointerenter, {\n                evt: evt,\n                target: this,\n                currentTarget: this,\n            });\n        }\n    }\n    _pointerover(evt) {\n        this.setPointersPositions(evt);\n        const events = getEventsMap(evt.type);\n        if (events) {\n            this._fire(events.pointerover, {\n                evt: evt,\n                target: this,\n                currentTarget: this,\n            });\n        }\n    }\n    _getTargetShape(evenType) {\n        let shape = this[evenType + 'targetShape'];\n        if (shape && !shape.getStage()) {\n            shape = null;\n        }\n        return shape;\n    }\n    _pointerleave(evt) {\n        const events = getEventsMap(evt.type);\n        const eventType = getEventType(evt.type);\n        if (!events) {\n            return;\n        }\n        this.setPointersPositions(evt);\n        const targetShape = this._getTargetShape(eventType);\n        const eventsEnabled = !(Konva.isDragging() || Konva.isTransforming()) || Konva.hitOnDragEnabled;\n        if (targetShape && eventsEnabled) {\n            targetShape._fireAndBubble(events.pointerout, { evt: evt });\n            targetShape._fireAndBubble(events.pointerleave, { evt: evt });\n            this._fire(events.pointerleave, {\n                evt: evt,\n                target: this,\n                currentTarget: this,\n            });\n            this[eventType + 'targetShape'] = null;\n        }\n        else if (eventsEnabled) {\n            this._fire(events.pointerleave, {\n                evt: evt,\n                target: this,\n                currentTarget: this,\n            });\n            this._fire(events.pointerout, {\n                evt: evt,\n                target: this,\n                currentTarget: this,\n            });\n        }\n        this.pointerPos = null;\n        this._pointerPositions = [];\n    }\n    _pointerdown(evt) {\n        const events = getEventsMap(evt.type);\n        const eventType = getEventType(evt.type);\n        if (!events) {\n            return;\n        }\n        this.setPointersPositions(evt);\n        let triggeredOnShape = false;\n        this._changedPointerPositions.forEach((pos) => {\n            const shape = this.getIntersection(pos);\n            DD.justDragged = false;\n            Konva['_' + eventType + 'ListenClick'] = true;\n            if (!shape || !shape.isListening()) {\n                this[eventType + 'ClickStartShape'] = undefined;\n                return;\n            }\n            if (Konva.capturePointerEventsEnabled) {\n                shape.setPointerCapture(pos.id);\n            }\n            this[eventType + 'ClickStartShape'] = shape;\n            shape._fireAndBubble(events.pointerdown, {\n                evt: evt,\n                pointerId: pos.id,\n            });\n            triggeredOnShape = true;\n            const isTouch = evt.type.indexOf('touch') >= 0;\n            if (shape.preventDefault() && evt.cancelable && isTouch) {\n                evt.preventDefault();\n            }\n        });\n        if (!triggeredOnShape) {\n            this._fire(events.pointerdown, {\n                evt: evt,\n                target: this,\n                currentTarget: this,\n                pointerId: this._pointerPositions[0].id,\n            });\n        }\n    }\n    _pointermove(evt) {\n        const events = getEventsMap(evt.type);\n        const eventType = getEventType(evt.type);\n        if (!events) {\n            return;\n        }\n        const isTouchPointer = evt.type.indexOf('touch') >= 0 ||\n            evt.pointerType === 'touch';\n        if (Konva.isDragging() &&\n            DD.node.preventDefault() &&\n            evt.cancelable &&\n            isTouchPointer) {\n            evt.preventDefault();\n        }\n        this.setPointersPositions(evt);\n        const eventsEnabled = !(Konva.isDragging() || Konva.isTransforming()) || Konva.hitOnDragEnabled;\n        if (!eventsEnabled) {\n            return;\n        }\n        const processedShapesIds = {};\n        let triggeredOnShape = false;\n        const targetShape = this._getTargetShape(eventType);\n        this._changedPointerPositions.forEach((pos) => {\n            const shape = (PointerEvents.getCapturedShape(pos.id) ||\n                this.getIntersection(pos));\n            const pointerId = pos.id;\n            const event = { evt: evt, pointerId };\n            const differentTarget = targetShape !== shape;\n            if (differentTarget && targetShape) {\n                targetShape._fireAndBubble(events.pointerout, { ...event }, shape);\n                targetShape._fireAndBubble(events.pointerleave, { ...event }, shape);\n            }\n            if (shape) {\n                if (processedShapesIds[shape._id]) {\n                    return;\n                }\n                processedShapesIds[shape._id] = true;\n            }\n            if (shape && shape.isListening()) {\n                triggeredOnShape = true;\n                if (differentTarget) {\n                    shape._fireAndBubble(events.pointerover, { ...event }, targetShape);\n                    shape._fireAndBubble(events.pointerenter, { ...event }, targetShape);\n                    this[eventType + 'targetShape'] = shape;\n                }\n                shape._fireAndBubble(events.pointermove, { ...event });\n            }\n            else {\n                if (targetShape) {\n                    this._fire(events.pointerover, {\n                        evt: evt,\n                        target: this,\n                        currentTarget: this,\n                        pointerId,\n                    });\n                    this[eventType + 'targetShape'] = null;\n                }\n            }\n        });\n        if (!triggeredOnShape) {\n            this._fire(events.pointermove, {\n                evt: evt,\n                target: this,\n                currentTarget: this,\n                pointerId: this._changedPointerPositions[0].id,\n            });\n        }\n    }\n    _pointerup(evt) {\n        const events = getEventsMap(evt.type);\n        const eventType = getEventType(evt.type);\n        if (!events) {\n            return;\n        }\n        this.setPointersPositions(evt);\n        const clickStartShape = this[eventType + 'ClickStartShape'];\n        const clickEndShape = this[eventType + 'ClickEndShape'];\n        const processedShapesIds = {};\n        let skipPointerUpTrigger = false;\n        this._changedPointerPositions.forEach((pos) => {\n            const shape = (PointerEvents.getCapturedShape(pos.id) ||\n                this.getIntersection(pos));\n            if (shape) {\n                shape.releaseCapture(pos.id);\n                if (processedShapesIds[shape._id]) {\n                    return;\n                }\n                processedShapesIds[shape._id] = true;\n            }\n            const pointerId = pos.id;\n            const event = { evt: evt, pointerId };\n            let fireDblClick = false;\n            if (Konva['_' + eventType + 'InDblClickWindow']) {\n                fireDblClick = true;\n                clearTimeout(this[eventType + 'DblTimeout']);\n            }\n            else if (!DD.justDragged) {\n                Konva['_' + eventType + 'InDblClickWindow'] = true;\n                clearTimeout(this[eventType + 'DblTimeout']);\n            }\n            this[eventType + 'DblTimeout'] = setTimeout(function () {\n                Konva['_' + eventType + 'InDblClickWindow'] = false;\n            }, Konva.dblClickWindow);\n            if (shape && shape.isListening()) {\n                skipPointerUpTrigger = true;\n                this[eventType + 'ClickEndShape'] = shape;\n                shape._fireAndBubble(events.pointerup, { ...event });\n                if (Konva['_' + eventType + 'ListenClick'] &&\n                    clickStartShape &&\n                    clickStartShape === shape) {\n                    shape._fireAndBubble(events.pointerclick, { ...event });\n                    if (fireDblClick && clickEndShape && clickEndShape === shape) {\n                        shape._fireAndBubble(events.pointerdblclick, { ...event });\n                    }\n                }\n            }\n            else {\n                this[eventType + 'ClickEndShape'] = null;\n                if (!skipPointerUpTrigger) {\n                    this._fire(events.pointerup, {\n                        evt: evt,\n                        target: this,\n                        currentTarget: this,\n                        pointerId: this._changedPointerPositions[0].id,\n                    });\n                    skipPointerUpTrigger = true;\n                }\n                if (Konva['_' + eventType + 'ListenClick']) {\n                    this._fire(events.pointerclick, {\n                        evt: evt,\n                        target: this,\n                        currentTarget: this,\n                        pointerId,\n                    });\n                }\n                if (fireDblClick) {\n                    this._fire(events.pointerdblclick, {\n                        evt: evt,\n                        target: this,\n                        currentTarget: this,\n                        pointerId,\n                    });\n                }\n            }\n        });\n        if (!skipPointerUpTrigger) {\n            this._fire(events.pointerup, {\n                evt: evt,\n                target: this,\n                currentTarget: this,\n                pointerId: this._changedPointerPositions[0].id,\n            });\n        }\n        Konva['_' + eventType + 'ListenClick'] = false;\n        if (evt.cancelable && eventType !== 'touch' && eventType !== 'pointer') {\n            evt.preventDefault();\n        }\n    }\n    _contextmenu(evt) {\n        this.setPointersPositions(evt);\n        const shape = this.getIntersection(this.getPointerPosition());\n        if (shape && shape.isListening()) {\n            shape._fireAndBubble(CONTEXTMENU, { evt: evt });\n        }\n        else {\n            this._fire(CONTEXTMENU, {\n                evt: evt,\n                target: this,\n                currentTarget: this,\n            });\n        }\n    }\n    _wheel(evt) {\n        this.setPointersPositions(evt);\n        const shape = this.getIntersection(this.getPointerPosition());\n        if (shape && shape.isListening()) {\n            shape._fireAndBubble(WHEEL, { evt: evt });\n        }\n        else {\n            this._fire(WHEEL, {\n                evt: evt,\n                target: this,\n                currentTarget: this,\n            });\n        }\n    }\n    _pointercancel(evt) {\n        this.setPointersPositions(evt);\n        const shape = PointerEvents.getCapturedShape(evt.pointerId) ||\n            this.getIntersection(this.getPointerPosition());\n        if (shape) {\n            shape._fireAndBubble(POINTERUP, PointerEvents.createEvent(evt));\n        }\n        PointerEvents.releaseCapture(evt.pointerId);\n    }\n    _lostpointercapture(evt) {\n        PointerEvents.releaseCapture(evt.pointerId);\n    }\n    setPointersPositions(evt) {\n        const contentPosition = this._getContentPosition();\n        let x = null, y = null;\n        evt = evt ? evt : window.event;\n        if (evt.touches !== undefined) {\n            this._pointerPositions = [];\n            this._changedPointerPositions = [];\n            Array.prototype.forEach.call(evt.touches, (touch) => {\n                this._pointerPositions.push({\n                    id: touch.identifier,\n                    x: (touch.clientX - contentPosition.left) / contentPosition.scaleX,\n                    y: (touch.clientY - contentPosition.top) / contentPosition.scaleY,\n                });\n            });\n            Array.prototype.forEach.call(evt.changedTouches || evt.touches, (touch) => {\n                this._changedPointerPositions.push({\n                    id: touch.identifier,\n                    x: (touch.clientX - contentPosition.left) / contentPosition.scaleX,\n                    y: (touch.clientY - contentPosition.top) / contentPosition.scaleY,\n                });\n            });\n        }\n        else {\n            x = (evt.clientX - contentPosition.left) / contentPosition.scaleX;\n            y = (evt.clientY - contentPosition.top) / contentPosition.scaleY;\n            this.pointerPos = {\n                x: x,\n                y: y,\n            };\n            this._pointerPositions = [{ x, y, id: Util._getFirstPointerId(evt) }];\n            this._changedPointerPositions = [\n                { x, y, id: Util._getFirstPointerId(evt) },\n            ];\n        }\n    }\n    _setPointerPosition(evt) {\n        Util.warn('Method _setPointerPosition is deprecated. Use \"stage.setPointersPositions(event)\" instead.');\n        this.setPointersPositions(evt);\n    }\n    _getContentPosition() {\n        if (!this.content || !this.content.getBoundingClientRect) {\n            return {\n                top: 0,\n                left: 0,\n                scaleX: 1,\n                scaleY: 1,\n            };\n        }\n        const rect = this.content.getBoundingClientRect();\n        return {\n            top: rect.top,\n            left: rect.left,\n            scaleX: rect.width / this.content.clientWidth || 1,\n            scaleY: rect.height / this.content.clientHeight || 1,\n        };\n    }\n    _buildDOM() {\n        this.bufferCanvas = new SceneCanvas({\n            width: this.width(),\n            height: this.height(),\n        });\n        this.bufferHitCanvas = new HitCanvas({\n            pixelRatio: 1,\n            width: this.width(),\n            height: this.height(),\n        });\n        if (!Konva.isBrowser) {\n            return;\n        }\n        const container = this.container();\n        if (!container) {\n            throw 'Stage has no container. A container is required.';\n        }\n        container.innerHTML = '';\n        this.content = document.createElement('div');\n        this.content.style.position = 'relative';\n        this.content.style.userSelect = 'none';\n        this.content.className = 'konvajs-content';\n        this.content.setAttribute('role', 'presentation');\n        container.appendChild(this.content);\n        this._resizeDOM();\n    }\n    cache() {\n        Util.warn('Cache function is not allowed for stage. You may use cache only for layers, groups and shapes.');\n        return this;\n    }\n    clearCache() {\n        return this;\n    }\n    batchDraw() {\n        this.getChildren().forEach(function (layer) {\n            layer.batchDraw();\n        });\n        return this;\n    }\n}\nStage.prototype.nodeType = STAGE;\n_registerNode(Stage);\nFactory.addGetterSetter(Stage, 'container');\nif (Konva.isBrowser) {\n    document.addEventListener('visibilitychange', () => {\n        stages.forEach((stage) => {\n            stage.batchDraw();\n        });\n    });\n}\n", "import { Konva } from \"./Global.js\";\nimport { Transform, Util } from \"./Util.js\";\nimport { Factory } from \"./Factory.js\";\nimport { Node } from \"./Node.js\";\nimport { getNumberValidator, getNumberOrAutoValidator, getStringValidator, getBooleanValidator, getStringOrGradientValidator, } from \"./Validators.js\";\nimport { _registerNode } from \"./Global.js\";\nimport * as PointerEvents from \"./PointerEvents.js\";\nconst HAS_SHADOW = 'hasShadow';\nconst SHADOW_RGBA = 'shadowRGBA';\nconst patternImage = 'patternImage';\nconst linearGradient = 'linearGradient';\nconst radialGradient = 'radialGradient';\nlet dummyContext;\nfunction getDummyContext() {\n    if (dummyContext) {\n        return dummyContext;\n    }\n    dummyContext = Util.createCanvasElement().getContext('2d');\n    return dummyContext;\n}\nexport const shapes = {};\nfunction _fillFunc(context) {\n    const fillRule = this.attrs.fillRule;\n    if (fillRule) {\n        context.fill(fillRule);\n    }\n    else {\n        context.fill();\n    }\n}\nfunction _strokeFunc(context) {\n    context.stroke();\n}\nfunction _fillFuncHit(context) {\n    const fillRule = this.attrs.fillRule;\n    if (fillRule) {\n        context.fill(fillRule);\n    }\n    else {\n        context.fill();\n    }\n}\nfunction _strokeFuncHit(context) {\n    context.stroke();\n}\nfunction _clearHasShadowCache() {\n    this._clearCache(HAS_SHADOW);\n}\nfunction _clearGetShadowRGBACache() {\n    this._clearCache(SHADOW_RGBA);\n}\nfunction _clearFillPatternCache() {\n    this._clearCache(patternImage);\n}\nfunction _clearLinearGradientCache() {\n    this._clearCache(linearGradient);\n}\nfunction _clearRadialGradientCache() {\n    this._clearCache(radialGradient);\n}\nexport class Shape extends Node {\n    constructor(config) {\n        super(config);\n        let key;\n        let attempts = 0;\n        while (true) {\n            key = Util.getHitColor();\n            if (key && !(key in shapes)) {\n                break;\n            }\n            attempts++;\n            if (attempts >= 10000) {\n                Util.warn('Failed to find a unique color key for a shape. Konva may work incorrectly. Most likely your browser is using canvas farbling. Consider disabling it.');\n                key = Util.getRandomColor();\n                break;\n            }\n        }\n        this.colorKey = key;\n        shapes[key] = this;\n    }\n    getContext() {\n        Util.warn('shape.getContext() method is deprecated. Please do not use it.');\n        return this.getLayer().getContext();\n    }\n    getCanvas() {\n        Util.warn('shape.getCanvas() method is deprecated. Please do not use it.');\n        return this.getLayer().getCanvas();\n    }\n    getSceneFunc() {\n        return this.attrs.sceneFunc || this['_sceneFunc'];\n    }\n    getHitFunc() {\n        return this.attrs.hitFunc || this['_hitFunc'];\n    }\n    hasShadow() {\n        return this._getCache(HAS_SHADOW, this._hasShadow);\n    }\n    _hasShadow() {\n        return (this.shadowEnabled() &&\n            this.shadowOpacity() !== 0 &&\n            !!(this.shadowColor() ||\n                this.shadowBlur() ||\n                this.shadowOffsetX() ||\n                this.shadowOffsetY()));\n    }\n    _getFillPattern() {\n        return this._getCache(patternImage, this.__getFillPattern);\n    }\n    __getFillPattern() {\n        if (this.fillPatternImage()) {\n            const ctx = getDummyContext();\n            const pattern = ctx.createPattern(this.fillPatternImage(), this.fillPatternRepeat() || 'repeat');\n            if (pattern && pattern.setTransform) {\n                const tr = new Transform();\n                tr.translate(this.fillPatternX(), this.fillPatternY());\n                tr.rotate(Konva.getAngle(this.fillPatternRotation()));\n                tr.scale(this.fillPatternScaleX(), this.fillPatternScaleY());\n                tr.translate(-1 * this.fillPatternOffsetX(), -1 * this.fillPatternOffsetY());\n                const m = tr.getMatrix();\n                const matrix = typeof DOMMatrix === 'undefined'\n                    ? {\n                        a: m[0],\n                        b: m[1],\n                        c: m[2],\n                        d: m[3],\n                        e: m[4],\n                        f: m[5],\n                    }\n                    : new DOMMatrix(m);\n                pattern.setTransform(matrix);\n            }\n            return pattern;\n        }\n    }\n    _getLinearGradient() {\n        return this._getCache(linearGradient, this.__getLinearGradient);\n    }\n    __getLinearGradient() {\n        const colorStops = this.fillLinearGradientColorStops();\n        if (colorStops) {\n            const ctx = getDummyContext();\n            const start = this.fillLinearGradientStartPoint();\n            const end = this.fillLinearGradientEndPoint();\n            const grd = ctx.createLinearGradient(start.x, start.y, end.x, end.y);\n            for (let n = 0; n < colorStops.length; n += 2) {\n                grd.addColorStop(colorStops[n], colorStops[n + 1]);\n            }\n            return grd;\n        }\n    }\n    _getRadialGradient() {\n        return this._getCache(radialGradient, this.__getRadialGradient);\n    }\n    __getRadialGradient() {\n        const colorStops = this.fillRadialGradientColorStops();\n        if (colorStops) {\n            const ctx = getDummyContext();\n            const start = this.fillRadialGradientStartPoint();\n            const end = this.fillRadialGradientEndPoint();\n            const grd = ctx.createRadialGradient(start.x, start.y, this.fillRadialGradientStartRadius(), end.x, end.y, this.fillRadialGradientEndRadius());\n            for (let n = 0; n < colorStops.length; n += 2) {\n                grd.addColorStop(colorStops[n], colorStops[n + 1]);\n            }\n            return grd;\n        }\n    }\n    getShadowRGBA() {\n        return this._getCache(SHADOW_RGBA, this._getShadowRGBA);\n    }\n    _getShadowRGBA() {\n        if (!this.hasShadow()) {\n            return;\n        }\n        const rgba = Util.colorToRGBA(this.shadowColor());\n        if (rgba) {\n            return ('rgba(' +\n                rgba.r +\n                ',' +\n                rgba.g +\n                ',' +\n                rgba.b +\n                ',' +\n                rgba.a * (this.shadowOpacity() || 1) +\n                ')');\n        }\n    }\n    hasFill() {\n        return this._calculate('hasFill', [\n            'fillEnabled',\n            'fill',\n            'fillPatternImage',\n            'fillLinearGradientColorStops',\n            'fillRadialGradientColorStops',\n        ], () => {\n            return (this.fillEnabled() &&\n                !!(this.fill() ||\n                    this.fillPatternImage() ||\n                    this.fillLinearGradientColorStops() ||\n                    this.fillRadialGradientColorStops()));\n        });\n    }\n    hasStroke() {\n        return this._calculate('hasStroke', [\n            'strokeEnabled',\n            'strokeWidth',\n            'stroke',\n            'strokeLinearGradientColorStops',\n        ], () => {\n            return (this.strokeEnabled() &&\n                this.strokeWidth() &&\n                !!(this.stroke() || this.strokeLinearGradientColorStops()));\n        });\n    }\n    hasHitStroke() {\n        const width = this.hitStrokeWidth();\n        if (width === 'auto') {\n            return this.hasStroke();\n        }\n        return this.strokeEnabled() && !!width;\n    }\n    intersects(point) {\n        const stage = this.getStage();\n        if (!stage) {\n            return false;\n        }\n        const bufferHitCanvas = stage.bufferHitCanvas;\n        bufferHitCanvas.getContext().clear();\n        this.drawHit(bufferHitCanvas, undefined, true);\n        const p = bufferHitCanvas.context.getImageData(Math.round(point.x), Math.round(point.y), 1, 1).data;\n        return p[3] > 0;\n    }\n    destroy() {\n        Node.prototype.destroy.call(this);\n        delete shapes[this.colorKey];\n        delete this.colorKey;\n        return this;\n    }\n    _useBufferCanvas(forceFill) {\n        var _a;\n        const perfectDrawEnabled = (_a = this.attrs.perfectDrawEnabled) !== null && _a !== void 0 ? _a : true;\n        if (!perfectDrawEnabled) {\n            return false;\n        }\n        const hasFill = forceFill || this.hasFill();\n        const hasStroke = this.hasStroke();\n        const isTransparent = this.getAbsoluteOpacity() !== 1;\n        if (hasFill && hasStroke && isTransparent) {\n            return true;\n        }\n        const hasShadow = this.hasShadow();\n        const strokeForShadow = this.shadowForStrokeEnabled();\n        if (hasFill && hasStroke && hasShadow && strokeForShadow) {\n            return true;\n        }\n        return false;\n    }\n    setStrokeHitEnabled(val) {\n        Util.warn('strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead.');\n        if (val) {\n            this.hitStrokeWidth('auto');\n        }\n        else {\n            this.hitStrokeWidth(0);\n        }\n    }\n    getStrokeHitEnabled() {\n        if (this.hitStrokeWidth() === 0) {\n            return false;\n        }\n        else {\n            return true;\n        }\n    }\n    getSelfRect() {\n        const size = this.size();\n        return {\n            x: this._centroid ? -size.width / 2 : 0,\n            y: this._centroid ? -size.height / 2 : 0,\n            width: size.width,\n            height: size.height,\n        };\n    }\n    getClientRect(config = {}) {\n        let hasCachedParent = false;\n        let parent = this.getParent();\n        while (parent) {\n            if (parent.isCached()) {\n                hasCachedParent = true;\n                break;\n            }\n            parent = parent.getParent();\n        }\n        const skipTransform = config.skipTransform;\n        const relativeTo = config.relativeTo || (hasCachedParent && this.getStage()) || undefined;\n        const fillRect = this.getSelfRect();\n        const applyStroke = !config.skipStroke && this.hasStroke();\n        const strokeWidth = (applyStroke && this.strokeWidth()) || 0;\n        const fillAndStrokeWidth = fillRect.width + strokeWidth;\n        const fillAndStrokeHeight = fillRect.height + strokeWidth;\n        const applyShadow = !config.skipShadow && this.hasShadow();\n        const shadowOffsetX = applyShadow ? this.shadowOffsetX() : 0;\n        const shadowOffsetY = applyShadow ? this.shadowOffsetY() : 0;\n        const preWidth = fillAndStrokeWidth + Math.abs(shadowOffsetX);\n        const preHeight = fillAndStrokeHeight + Math.abs(shadowOffsetY);\n        const blurRadius = (applyShadow && this.shadowBlur()) || 0;\n        const width = preWidth + blurRadius * 2;\n        const height = preHeight + blurRadius * 2;\n        const rect = {\n            width: width,\n            height: height,\n            x: -(strokeWidth / 2 + blurRadius) +\n                Math.min(shadowOffsetX, 0) +\n                fillRect.x,\n            y: -(strokeWidth / 2 + blurRadius) +\n                Math.min(shadowOffsetY, 0) +\n                fillRect.y,\n        };\n        if (!skipTransform) {\n            return this._transformedRect(rect, relativeTo);\n        }\n        return rect;\n    }\n    drawScene(can, top, bufferCanvas) {\n        const layer = this.getLayer();\n        const canvas = can || layer.getCanvas(), context = canvas.getContext(), cachedCanvas = this._getCanvasCache(), drawFunc = this.getSceneFunc(), hasShadow = this.hasShadow();\n        let stage;\n        const skipBuffer = false;\n        const cachingSelf = top === this;\n        if (!this.isVisible() && !cachingSelf) {\n            return this;\n        }\n        if (cachedCanvas) {\n            context.save();\n            const m = this.getAbsoluteTransform(top).getMatrix();\n            context.transform(m[0], m[1], m[2], m[3], m[4], m[5]);\n            this._drawCachedSceneCanvas(context);\n            context.restore();\n            return this;\n        }\n        if (!drawFunc) {\n            return this;\n        }\n        context.save();\n        if (this._useBufferCanvas() && !skipBuffer) {\n            stage = this.getStage();\n            const bc = bufferCanvas || stage.bufferCanvas;\n            const bufferContext = bc.getContext();\n            bufferContext.clear();\n            bufferContext.save();\n            bufferContext._applyLineJoin(this);\n            bufferContext._applyMiterLimit(this);\n            const o = this.getAbsoluteTransform(top).getMatrix();\n            bufferContext.transform(o[0], o[1], o[2], o[3], o[4], o[5]);\n            drawFunc.call(this, bufferContext, this);\n            bufferContext.restore();\n            const ratio = bc.pixelRatio;\n            if (hasShadow) {\n                context._applyShadow(this);\n            }\n            if (!cachingSelf) {\n                context._applyOpacity(this);\n                context._applyGlobalCompositeOperation(this);\n            }\n            context.drawImage(bc._canvas, bc.x || 0, bc.y || 0, bc.width / ratio, bc.height / ratio);\n        }\n        else {\n            context._applyLineJoin(this);\n            context._applyMiterLimit(this);\n            if (!cachingSelf) {\n                const o = this.getAbsoluteTransform(top).getMatrix();\n                context.transform(o[0], o[1], o[2], o[3], o[4], o[5]);\n                context._applyOpacity(this);\n                context._applyGlobalCompositeOperation(this);\n            }\n            if (hasShadow) {\n                context._applyShadow(this);\n            }\n            drawFunc.call(this, context, this);\n        }\n        context.restore();\n        return this;\n    }\n    drawHit(can, top, skipDragCheck = false) {\n        if (!this.shouldDrawHit(top, skipDragCheck)) {\n            return this;\n        }\n        const layer = this.getLayer(), canvas = can || layer.hitCanvas, context = canvas && canvas.getContext(), drawFunc = this.hitFunc() || this.sceneFunc(), cachedCanvas = this._getCanvasCache(), cachedHitCanvas = cachedCanvas && cachedCanvas.hit;\n        if (!this.colorKey) {\n            Util.warn('Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()');\n        }\n        if (cachedHitCanvas) {\n            context.save();\n            const m = this.getAbsoluteTransform(top).getMatrix();\n            context.transform(m[0], m[1], m[2], m[3], m[4], m[5]);\n            this._drawCachedHitCanvas(context);\n            context.restore();\n            return this;\n        }\n        if (!drawFunc) {\n            return this;\n        }\n        context.save();\n        context._applyLineJoin(this);\n        context._applyMiterLimit(this);\n        const selfCache = this === top;\n        if (!selfCache) {\n            const o = this.getAbsoluteTransform(top).getMatrix();\n            context.transform(o[0], o[1], o[2], o[3], o[4], o[5]);\n        }\n        drawFunc.call(this, context, this);\n        context.restore();\n        return this;\n    }\n    drawHitFromCache(alphaThreshold = 0) {\n        const cachedCanvas = this._getCanvasCache(), sceneCanvas = this._getCachedSceneCanvas(), hitCanvas = cachedCanvas.hit, hitContext = hitCanvas.getContext(), hitWidth = hitCanvas.getWidth(), hitHeight = hitCanvas.getHeight();\n        hitContext.clear();\n        hitContext.drawImage(sceneCanvas._canvas, 0, 0, hitWidth, hitHeight);\n        try {\n            const hitImageData = hitContext.getImageData(0, 0, hitWidth, hitHeight);\n            const hitData = hitImageData.data;\n            const len = hitData.length;\n            const rgbColorKey = Util._hexToRgb(this.colorKey);\n            for (let i = 0; i < len; i += 4) {\n                const alpha = hitData[i + 3];\n                if (alpha > alphaThreshold) {\n                    hitData[i] = rgbColorKey.r;\n                    hitData[i + 1] = rgbColorKey.g;\n                    hitData[i + 2] = rgbColorKey.b;\n                    hitData[i + 3] = 255;\n                }\n                else {\n                    hitData[i + 3] = 0;\n                }\n            }\n            hitContext.putImageData(hitImageData, 0, 0);\n        }\n        catch (e) {\n            Util.error('Unable to draw hit graph from cached scene canvas. ' + e.message);\n        }\n        return this;\n    }\n    hasPointerCapture(pointerId) {\n        return PointerEvents.hasPointerCapture(pointerId, this);\n    }\n    setPointerCapture(pointerId) {\n        PointerEvents.setPointerCapture(pointerId, this);\n    }\n    releaseCapture(pointerId) {\n        PointerEvents.releaseCapture(pointerId, this);\n    }\n}\nShape.prototype._fillFunc = _fillFunc;\nShape.prototype._strokeFunc = _strokeFunc;\nShape.prototype._fillFuncHit = _fillFuncHit;\nShape.prototype._strokeFuncHit = _strokeFuncHit;\nShape.prototype._centroid = false;\nShape.prototype.nodeType = 'Shape';\n_registerNode(Shape);\nShape.prototype.eventListeners = {};\nShape.prototype.on.call(Shape.prototype, 'shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva', _clearHasShadowCache);\nShape.prototype.on.call(Shape.prototype, 'shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva', _clearGetShadowRGBACache);\nShape.prototype.on.call(Shape.prototype, 'fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva', _clearFillPatternCache);\nShape.prototype.on.call(Shape.prototype, 'fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva', _clearLinearGradientCache);\nShape.prototype.on.call(Shape.prototype, 'fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva', _clearRadialGradientCache);\nFactory.addGetterSetter(Shape, 'stroke', undefined, getStringOrGradientValidator());\nFactory.addGetterSetter(Shape, 'strokeWidth', 2, getNumberValidator());\nFactory.addGetterSetter(Shape, 'fillAfterStrokeEnabled', false);\nFactory.addGetterSetter(Shape, 'hitStrokeWidth', 'auto', getNumberOrAutoValidator());\nFactory.addGetterSetter(Shape, 'strokeHitEnabled', true, getBooleanValidator());\nFactory.addGetterSetter(Shape, 'perfectDrawEnabled', true, getBooleanValidator());\nFactory.addGetterSetter(Shape, 'shadowForStrokeEnabled', true, getBooleanValidator());\nFactory.addGetterSetter(Shape, 'lineJoin');\nFactory.addGetterSetter(Shape, 'lineCap');\nFactory.addGetterSetter(Shape, 'miterLimit');\nFactory.addGetterSetter(Shape, 'sceneFunc');\nFactory.addGetterSetter(Shape, 'hitFunc');\nFactory.addGetterSetter(Shape, 'dash');\nFactory.addGetterSetter(Shape, 'dashOffset', 0, getNumberValidator());\nFactory.addGetterSetter(Shape, 'shadowColor', undefined, getStringValidator());\nFactory.addGetterSetter(Shape, 'shadowBlur', 0, getNumberValidator());\nFactory.addGetterSetter(Shape, 'shadowOpacity', 1, getNumberValidator());\nFactory.addComponentsGetterSetter(Shape, 'shadowOffset', ['x', 'y']);\nFactory.addGetterSetter(Shape, 'shadowOffsetX', 0, getNumberValidator());\nFactory.addGetterSetter(Shape, 'shadowOffsetY', 0, getNumberValidator());\nFactory.addGetterSetter(Shape, 'fillPatternImage');\nFactory.addGetterSetter(Shape, 'fill', undefined, getStringOrGradientValidator());\nFactory.addGetterSetter(Shape, 'fillPatternX', 0, getNumberValidator());\nFactory.addGetterSetter(Shape, 'fillPatternY', 0, getNumberValidator());\nFactory.addGetterSetter(Shape, 'fillLinearGradientColorStops');\nFactory.addGetterSetter(Shape, 'strokeLinearGradientColorStops');\nFactory.addGetterSetter(Shape, 'fillRadialGradientStartRadius', 0);\nFactory.addGetterSetter(Shape, 'fillRadialGradientEndRadius', 0);\nFactory.addGetterSetter(Shape, 'fillRadialGradientColorStops');\nFactory.addGetterSetter(Shape, 'fillPatternRepeat', 'repeat');\nFactory.addGetterSetter(Shape, 'fillEnabled', true);\nFactory.addGetterSetter(Shape, 'strokeEnabled', true);\nFactory.addGetterSetter(Shape, 'shadowEnabled', true);\nFactory.addGetterSetter(Shape, 'dashEnabled', true);\nFactory.addGetterSetter(Shape, 'strokeScaleEnabled', true);\nFactory.addGetterSetter(Shape, 'fillPriority', 'color');\nFactory.addComponentsGetterSetter(Shape, 'fillPatternOffset', ['x', 'y']);\nFactory.addGetterSetter(Shape, 'fillPatternOffsetX', 0, getNumberValidator());\nFactory.addGetterSetter(Shape, 'fillPatternOffsetY', 0, getNumberValidator());\nFactory.addComponentsGetterSetter(Shape, 'fillPatternScale', ['x', 'y']);\nFactory.addGetterSetter(Shape, 'fillPatternScaleX', 1, getNumberValidator());\nFactory.addGetterSetter(Shape, 'fillPatternScaleY', 1, getNumberValidator());\nFactory.addComponentsGetterSetter(Shape, 'fillLinearGradientStartPoint', [\n    'x',\n    'y',\n]);\nFactory.addComponentsGetterSetter(Shape, 'strokeLinearGradientStartPoint', [\n    'x',\n    'y',\n]);\nFactory.addGetterSetter(Shape, 'fillLinearGradientStartPointX', 0);\nFactory.addGetterSetter(Shape, 'strokeLinearGradientStartPointX', 0);\nFactory.addGetterSetter(Shape, 'fillLinearGradientStartPointY', 0);\nFactory.addGetterSetter(Shape, 'strokeLinearGradientStartPointY', 0);\nFactory.addComponentsGetterSetter(Shape, 'fillLinearGradientEndPoint', [\n    'x',\n    'y',\n]);\nFactory.addComponentsGetterSetter(Shape, 'strokeLinearGradientEndPoint', [\n    'x',\n    'y',\n]);\nFactory.addGetterSetter(Shape, 'fillLinearGradientEndPointX', 0);\nFactory.addGetterSetter(Shape, 'strokeLinearGradientEndPointX', 0);\nFactory.addGetterSetter(Shape, 'fillLinearGradientEndPointY', 0);\nFactory.addGetterSetter(Shape, 'strokeLinearGradientEndPointY', 0);\nFactory.addComponentsGetterSetter(Shape, 'fillRadialGradientStartPoint', [\n    'x',\n    'y',\n]);\nFactory.addGetterSetter(Shape, 'fillRadialGradientStartPointX', 0);\nFactory.addGetterSetter(Shape, 'fillRadialGradientStartPointY', 0);\nFactory.addComponentsGetterSetter(Shape, 'fillRadialGradientEndPoint', [\n    'x',\n    'y',\n]);\nFactory.addGetterSetter(Shape, 'fillRadialGradientEndPointX', 0);\nFactory.addGetterSetter(Shape, 'fillRadialGradientEndPointY', 0);\nFactory.addGetterSetter(Shape, 'fillPatternRotation', 0);\nFactory.addGetterSetter(Shape, 'fillRule', undefined, getStringValidator());\nFactory.backCompat(Shape, {\n    dashArray: 'dash',\n    getDashArray: 'getDash',\n    setDashArray: 'getDash',\n    drawFunc: 'sceneFunc',\n    getDrawFunc: 'getSceneFunc',\n    setDrawFunc: 'setSceneFunc',\n    drawHitFunc: 'hitFunc',\n    getDrawHitFunc: 'getHitFunc',\n    setDrawHitFunc: 'setHitFunc',\n});\n", "import { Util } from \"./Util.js\";\nimport { Container } from \"./Container.js\";\nimport { Node } from \"./Node.js\";\nimport { Factory } from \"./Factory.js\";\nimport { SceneCanvas, HitCanvas } from \"./Canvas.js\";\nimport { getBooleanValidator } from \"./Validators.js\";\nimport { shapes } from \"./Shape.js\";\nimport { _registerNode } from \"./Global.js\";\nconst HASH = '#', BEFORE_DRAW = 'beforeDraw', DRAW = 'draw', INTERSECTION_OFFSETS = [\n    { x: 0, y: 0 },\n    { x: -1, y: -1 },\n    { x: 1, y: -1 },\n    { x: 1, y: 1 },\n    { x: -1, y: 1 },\n], INTERSECTION_OFFSETS_LEN = INTERSECTION_OFFSETS.length;\nexport class Layer extends Container {\n    constructor(config) {\n        super(config);\n        this.canvas = new SceneCanvas();\n        this.hitCanvas = new HitCanvas({\n            pixelRatio: 1,\n        });\n        this._waitingForDraw = false;\n        this.on('visibleChange.konva', this._checkVisibility);\n        this._checkVisibility();\n        this.on('imageSmoothingEnabledChange.konva', this._setSmoothEnabled);\n        this._setSmoothEnabled();\n    }\n    createPNGStream() {\n        const c = this.canvas._canvas;\n        return c.createPNGStream();\n    }\n    getCanvas() {\n        return this.canvas;\n    }\n    getNativeCanvasElement() {\n        return this.canvas._canvas;\n    }\n    getHitCanvas() {\n        return this.hitCanvas;\n    }\n    getContext() {\n        return this.getCanvas().getContext();\n    }\n    clear(bounds) {\n        this.getContext().clear(bounds);\n        this.getHitCanvas().getContext().clear(bounds);\n        return this;\n    }\n    setZIndex(index) {\n        super.setZIndex(index);\n        const stage = this.getStage();\n        if (stage && stage.content) {\n            stage.content.removeChild(this.getNativeCanvasElement());\n            if (index < stage.children.length - 1) {\n                stage.content.insertBefore(this.getNativeCanvasElement(), stage.children[index + 1].getCanvas()._canvas);\n            }\n            else {\n                stage.content.appendChild(this.getNativeCanvasElement());\n            }\n        }\n        return this;\n    }\n    moveToTop() {\n        Node.prototype.moveToTop.call(this);\n        const stage = this.getStage();\n        if (stage && stage.content) {\n            stage.content.removeChild(this.getNativeCanvasElement());\n            stage.content.appendChild(this.getNativeCanvasElement());\n        }\n        return true;\n    }\n    moveUp() {\n        const moved = Node.prototype.moveUp.call(this);\n        if (!moved) {\n            return false;\n        }\n        const stage = this.getStage();\n        if (!stage || !stage.content) {\n            return false;\n        }\n        stage.content.removeChild(this.getNativeCanvasElement());\n        if (this.index < stage.children.length - 1) {\n            stage.content.insertBefore(this.getNativeCanvasElement(), stage.children[this.index + 1].getCanvas()._canvas);\n        }\n        else {\n            stage.content.appendChild(this.getNativeCanvasElement());\n        }\n        return true;\n    }\n    moveDown() {\n        if (Node.prototype.moveDown.call(this)) {\n            const stage = this.getStage();\n            if (stage) {\n                const children = stage.children;\n                if (stage.content) {\n                    stage.content.removeChild(this.getNativeCanvasElement());\n                    stage.content.insertBefore(this.getNativeCanvasElement(), children[this.index + 1].getCanvas()._canvas);\n                }\n            }\n            return true;\n        }\n        return false;\n    }\n    moveToBottom() {\n        if (Node.prototype.moveToBottom.call(this)) {\n            const stage = this.getStage();\n            if (stage) {\n                const children = stage.children;\n                if (stage.content) {\n                    stage.content.removeChild(this.getNativeCanvasElement());\n                    stage.content.insertBefore(this.getNativeCanvasElement(), children[1].getCanvas()._canvas);\n                }\n            }\n            return true;\n        }\n        return false;\n    }\n    getLayer() {\n        return this;\n    }\n    remove() {\n        const _canvas = this.getNativeCanvasElement();\n        Node.prototype.remove.call(this);\n        if (_canvas && _canvas.parentNode && Util._isInDocument(_canvas)) {\n            _canvas.parentNode.removeChild(_canvas);\n        }\n        return this;\n    }\n    getStage() {\n        return this.parent;\n    }\n    setSize({ width, height }) {\n        this.canvas.setSize(width, height);\n        this.hitCanvas.setSize(width, height);\n        this._setSmoothEnabled();\n        return this;\n    }\n    _validateAdd(child) {\n        const type = child.getType();\n        if (type !== 'Group' && type !== 'Shape') {\n            Util.throw('You may only add groups and shapes to a layer.');\n        }\n    }\n    _toKonvaCanvas(config) {\n        config = { ...config };\n        config.width = config.width || this.getWidth();\n        config.height = config.height || this.getHeight();\n        config.x = config.x !== undefined ? config.x : this.x();\n        config.y = config.y !== undefined ? config.y : this.y();\n        return Node.prototype._toKonvaCanvas.call(this, config);\n    }\n    _checkVisibility() {\n        const visible = this.visible();\n        if (visible) {\n            this.canvas._canvas.style.display = 'block';\n        }\n        else {\n            this.canvas._canvas.style.display = 'none';\n        }\n    }\n    _setSmoothEnabled() {\n        this.getContext()._context.imageSmoothingEnabled =\n            this.imageSmoothingEnabled();\n    }\n    getWidth() {\n        if (this.parent) {\n            return this.parent.width();\n        }\n    }\n    setWidth() {\n        Util.warn('Can not change width of layer. Use \"stage.width(value)\" function instead.');\n    }\n    getHeight() {\n        if (this.parent) {\n            return this.parent.height();\n        }\n    }\n    setHeight() {\n        Util.warn('Can not change height of layer. Use \"stage.height(value)\" function instead.');\n    }\n    batchDraw() {\n        if (!this._waitingForDraw) {\n            this._waitingForDraw = true;\n            Util.requestAnimFrame(() => {\n                this.draw();\n                this._waitingForDraw = false;\n            });\n        }\n        return this;\n    }\n    getIntersection(pos) {\n        if (!this.isListening() || !this.isVisible()) {\n            return null;\n        }\n        let spiralSearchDistance = 1;\n        let continueSearch = false;\n        while (true) {\n            for (let i = 0; i < INTERSECTION_OFFSETS_LEN; i++) {\n                const intersectionOffset = INTERSECTION_OFFSETS[i];\n                const obj = this._getIntersection({\n                    x: pos.x + intersectionOffset.x * spiralSearchDistance,\n                    y: pos.y + intersectionOffset.y * spiralSearchDistance,\n                });\n                const shape = obj.shape;\n                if (shape) {\n                    return shape;\n                }\n                continueSearch = !!obj.antialiased;\n                if (!obj.antialiased) {\n                    break;\n                }\n            }\n            if (continueSearch) {\n                spiralSearchDistance += 1;\n            }\n            else {\n                return null;\n            }\n        }\n    }\n    _getIntersection(pos) {\n        const ratio = this.hitCanvas.pixelRatio;\n        const p = this.hitCanvas.context.getImageData(Math.round(pos.x * ratio), Math.round(pos.y * ratio), 1, 1).data;\n        const p3 = p[3];\n        if (p3 === 255) {\n            const colorKey = Util.getHitColorKey(p[0], p[1], p[2]);\n            const shape = shapes[colorKey];\n            if (shape) {\n                return {\n                    shape: shape,\n                };\n            }\n            return {\n                antialiased: true,\n            };\n        }\n        else if (p3 > 0) {\n            return {\n                antialiased: true,\n            };\n        }\n        return {};\n    }\n    drawScene(can, top, bufferCanvas) {\n        const layer = this.getLayer(), canvas = can || (layer && layer.getCanvas());\n        this._fire(BEFORE_DRAW, {\n            node: this,\n        });\n        if (this.clearBeforeDraw()) {\n            canvas.getContext().clear();\n        }\n        Container.prototype.drawScene.call(this, canvas, top, bufferCanvas);\n        this._fire(DRAW, {\n            node: this,\n        });\n        return this;\n    }\n    drawHit(can, top) {\n        const layer = this.getLayer(), canvas = can || (layer && layer.hitCanvas);\n        if (layer && layer.clearBeforeDraw()) {\n            layer.getHitCanvas().getContext().clear();\n        }\n        Container.prototype.drawHit.call(this, canvas, top);\n        return this;\n    }\n    enableHitGraph() {\n        this.hitGraphEnabled(true);\n        return this;\n    }\n    disableHitGraph() {\n        this.hitGraphEnabled(false);\n        return this;\n    }\n    setHitGraphEnabled(val) {\n        Util.warn('hitGraphEnabled method is deprecated. Please use layer.listening() instead.');\n        this.listening(val);\n    }\n    getHitGraphEnabled(val) {\n        Util.warn('hitGraphEnabled method is deprecated. Please use layer.listening() instead.');\n        return this.listening();\n    }\n    toggleHitCanvas() {\n        if (!this.parent || !this.parent['content']) {\n            return;\n        }\n        const parent = this.parent;\n        const added = !!this.hitCanvas._canvas.parentNode;\n        if (added) {\n            parent.content.removeChild(this.hitCanvas._canvas);\n        }\n        else {\n            parent.content.appendChild(this.hitCanvas._canvas);\n        }\n    }\n    destroy() {\n        Util.releaseCanvas(this.getNativeCanvasElement(), this.getHitCanvas()._canvas);\n        return super.destroy();\n    }\n}\nLayer.prototype.nodeType = 'Layer';\n_registerNode(Layer);\nFactory.addGetterSetter(Layer, 'imageSmoothingEnabled', true);\nFactory.addGetterSetter(Layer, 'clearBeforeDraw', true);\nFactory.addGetterSetter(Layer, 'hitGraphEnabled', true, getBooleanValidator());\n", "import { Util } from \"./Util.js\";\nimport { Layer } from \"./Layer.js\";\nimport { _registerNode } from \"./Global.js\";\nexport class FastLayer extends Layer {\n    constructor(attrs) {\n        super(attrs);\n        this.listening(false);\n        Util.warn('Konva.Fast layer is deprecated. Please use \"new Konva.Layer({ listening: false })\" instead.');\n    }\n}\nFastLayer.prototype.nodeType = 'FastLayer';\n_registerNode(FastLayer);\n", "import { Util } from \"./Util.js\";\nimport { Container } from \"./Container.js\";\nimport { _registerNode } from \"./Global.js\";\nexport class Group extends Container {\n    _validateAdd(child) {\n        const type = child.getType();\n        if (type !== 'Group' && type !== 'Shape') {\n            Util.throw('You may only add groups and shapes to groups.');\n        }\n    }\n}\nGroup.prototype.nodeType = 'Group';\n_registerNode(Group);\n", "import { glob } from \"./Global.js\";\nimport { Util } from \"./Util.js\";\nconst now = (function () {\n    if (glob.performance && glob.performance.now) {\n        return function () {\n            return glob.performance.now();\n        };\n    }\n    return function () {\n        return new Date().getTime();\n    };\n})();\nexport class Animation {\n    constructor(func, layers) {\n        this.id = Animation.animIdCounter++;\n        this.frame = {\n            time: 0,\n            timeDiff: 0,\n            lastTime: now(),\n            frameRate: 0,\n        };\n        this.func = func;\n        this.setLayers(layers);\n    }\n    setLayers(layers) {\n        let lays = [];\n        if (layers) {\n            lays = Array.isArray(layers) ? layers : [layers];\n        }\n        this.layers = lays;\n        return this;\n    }\n    getLayers() {\n        return this.layers;\n    }\n    addLayer(layer) {\n        const layers = this.layers;\n        const len = layers.length;\n        for (let n = 0; n < len; n++) {\n            if (layers[n]._id === layer._id) {\n                return false;\n            }\n        }\n        this.layers.push(layer);\n        return true;\n    }\n    isRunning() {\n        const a = Animation;\n        const animations = a.animations;\n        const len = animations.length;\n        for (let n = 0; n < len; n++) {\n            if (animations[n].id === this.id) {\n                return true;\n            }\n        }\n        return false;\n    }\n    start() {\n        this.stop();\n        this.frame.timeDiff = 0;\n        this.frame.lastTime = now();\n        Animation._addAnimation(this);\n        return this;\n    }\n    stop() {\n        Animation._removeAnimation(this);\n        return this;\n    }\n    _updateFrameObject(time) {\n        this.frame.timeDiff = time - this.frame.lastTime;\n        this.frame.lastTime = time;\n        this.frame.time += this.frame.timeDiff;\n        this.frame.frameRate = 1000 / this.frame.timeDiff;\n    }\n    static _addAnimation(anim) {\n        this.animations.push(anim);\n        this._handleAnimation();\n    }\n    static _removeAnimation(anim) {\n        const id = anim.id;\n        const animations = this.animations;\n        const len = animations.length;\n        for (let n = 0; n < len; n++) {\n            if (animations[n].id === id) {\n                this.animations.splice(n, 1);\n                break;\n            }\n        }\n    }\n    static _runFrames() {\n        const layerHash = {};\n        const animations = this.animations;\n        for (let n = 0; n < animations.length; n++) {\n            const anim = animations[n];\n            const layers = anim.layers;\n            const func = anim.func;\n            anim._updateFrameObject(now());\n            const layersLen = layers.length;\n            let needRedraw;\n            if (func) {\n                needRedraw = func.call(anim, anim.frame) !== false;\n            }\n            else {\n                needRedraw = true;\n            }\n            if (!needRedraw) {\n                continue;\n            }\n            for (let i = 0; i < layersLen; i++) {\n                const layer = layers[i];\n                if (layer._id !== undefined) {\n                    layerHash[layer._id] = layer;\n                }\n            }\n        }\n        for (const key in layerHash) {\n            if (!layerHash.hasOwnProperty(key)) {\n                continue;\n            }\n            layerHash[key].batchDraw();\n        }\n    }\n    static _animationLoop() {\n        const Anim = Animation;\n        if (Anim.animations.length) {\n            Anim._runFrames();\n            Util.requestAnimFrame(Anim._animationLoop);\n        }\n        else {\n            Anim.animRunning = false;\n        }\n    }\n    static _handleAnimation() {\n        if (!this.animRunning) {\n            this.animRunning = true;\n            Util.requestAnimFrame(this._animationLoop);\n        }\n    }\n}\nAnimation.animations = [];\nAnimation.animIdCounter = 0;\nAnimation.animRunning = false;\n", "import { Util } from \"./Util.js\";\nimport { Animation } from \"./Animation.js\";\nimport { Node } from \"./Node.js\";\nimport { Konva } from \"./Global.js\";\nconst blacklist = {\n    node: 1,\n    duration: 1,\n    easing: 1,\n    onFinish: 1,\n    yoyo: 1,\n}, PAUSED = 1, PLAYING = 2, REVERSING = 3, colorAttrs = ['fill', 'stroke', 'shadowColor'];\nlet idCounter = 0;\nclass TweenEngine {\n    constructor(prop, propFunc, func, begin, finish, duration, yoyo) {\n        this.prop = prop;\n        this.propFunc = propFunc;\n        this.begin = begin;\n        this._pos = begin;\n        this.duration = duration;\n        this._change = 0;\n        this.prevPos = 0;\n        this.yoyo = yoyo;\n        this._time = 0;\n        this._position = 0;\n        this._startTime = 0;\n        this._finish = 0;\n        this.func = func;\n        this._change = finish - this.begin;\n        this.pause();\n    }\n    fire(str) {\n        const handler = this[str];\n        if (handler) {\n            handler();\n        }\n    }\n    setTime(t) {\n        if (t > this.duration) {\n            if (this.yoyo) {\n                this._time = this.duration;\n                this.reverse();\n            }\n            else {\n                this.finish();\n            }\n        }\n        else if (t < 0) {\n            if (this.yoyo) {\n                this._time = 0;\n                this.play();\n            }\n            else {\n                this.reset();\n            }\n        }\n        else {\n            this._time = t;\n            this.update();\n        }\n    }\n    getTime() {\n        return this._time;\n    }\n    setPosition(p) {\n        this.prevPos = this._pos;\n        this.propFunc(p);\n        this._pos = p;\n    }\n    getPosition(t) {\n        if (t === undefined) {\n            t = this._time;\n        }\n        return this.func(t, this.begin, this._change, this.duration);\n    }\n    play() {\n        this.state = PLAYING;\n        this._startTime = this.getTimer() - this._time;\n        this.onEnterFrame();\n        this.fire('onPlay');\n    }\n    reverse() {\n        this.state = REVERSING;\n        this._time = this.duration - this._time;\n        this._startTime = this.getTimer() - this._time;\n        this.onEnterFrame();\n        this.fire('onReverse');\n    }\n    seek(t) {\n        this.pause();\n        this._time = t;\n        this.update();\n        this.fire('onSeek');\n    }\n    reset() {\n        this.pause();\n        this._time = 0;\n        this.update();\n        this.fire('onReset');\n    }\n    finish() {\n        this.pause();\n        this._time = this.duration;\n        this.update();\n        this.fire('onFinish');\n    }\n    update() {\n        this.setPosition(this.getPosition(this._time));\n        this.fire('onUpdate');\n    }\n    onEnterFrame() {\n        const t = this.getTimer() - this._startTime;\n        if (this.state === PLAYING) {\n            this.setTime(t);\n        }\n        else if (this.state === REVERSING) {\n            this.setTime(this.duration - t);\n        }\n    }\n    pause() {\n        this.state = PAUSED;\n        this.fire('onPause');\n    }\n    getTimer() {\n        return new Date().getTime();\n    }\n}\nexport class Tween {\n    constructor(config) {\n        const that = this, node = config.node, nodeId = node._id, easing = config.easing || Easings.Linear, yoyo = !!config.yoyo;\n        let duration, key;\n        if (typeof config.duration === 'undefined') {\n            duration = 0.3;\n        }\n        else if (config.duration === 0) {\n            duration = 0.001;\n        }\n        else {\n            duration = config.duration;\n        }\n        this.node = node;\n        this._id = idCounter++;\n        const layers = node.getLayer() ||\n            (node instanceof Konva['Stage'] ? node.getLayers() : null);\n        if (!layers) {\n            Util.error('Tween constructor have `node` that is not in a layer. Please add node into layer first.');\n        }\n        this.anim = new Animation(function () {\n            that.tween.onEnterFrame();\n        }, layers);\n        this.tween = new TweenEngine(key, function (i) {\n            that._tweenFunc(i);\n        }, easing, 0, 1, duration * 1000, yoyo);\n        this._addListeners();\n        if (!Tween.attrs[nodeId]) {\n            Tween.attrs[nodeId] = {};\n        }\n        if (!Tween.attrs[nodeId][this._id]) {\n            Tween.attrs[nodeId][this._id] = {};\n        }\n        if (!Tween.tweens[nodeId]) {\n            Tween.tweens[nodeId] = {};\n        }\n        for (key in config) {\n            if (blacklist[key] === undefined) {\n                this._addAttr(key, config[key]);\n            }\n        }\n        this.reset();\n        this.onFinish = config.onFinish;\n        this.onReset = config.onReset;\n        this.onUpdate = config.onUpdate;\n    }\n    _addAttr(key, end) {\n        const node = this.node, nodeId = node._id;\n        let diff, len, trueEnd, trueStart, endRGBA;\n        const tweenId = Tween.tweens[nodeId][key];\n        if (tweenId) {\n            delete Tween.attrs[nodeId][tweenId][key];\n        }\n        let start = node.getAttr(key);\n        if (Util._isArray(end)) {\n            diff = [];\n            len = Math.max(end.length, start.length);\n            if (key === 'points' && end.length !== start.length) {\n                if (end.length > start.length) {\n                    trueStart = start;\n                    start = Util._prepareArrayForTween(start, end, node.closed());\n                }\n                else {\n                    trueEnd = end;\n                    end = Util._prepareArrayForTween(end, start, node.closed());\n                }\n            }\n            if (key.indexOf('fill') === 0) {\n                for (let n = 0; n < len; n++) {\n                    if (n % 2 === 0) {\n                        diff.push(end[n] - start[n]);\n                    }\n                    else {\n                        const startRGBA = Util.colorToRGBA(start[n]);\n                        endRGBA = Util.colorToRGBA(end[n]);\n                        start[n] = startRGBA;\n                        diff.push({\n                            r: endRGBA.r - startRGBA.r,\n                            g: endRGBA.g - startRGBA.g,\n                            b: endRGBA.b - startRGBA.b,\n                            a: endRGBA.a - startRGBA.a,\n                        });\n                    }\n                }\n            }\n            else {\n                for (let n = 0; n < len; n++) {\n                    diff.push(end[n] - start[n]);\n                }\n            }\n        }\n        else if (colorAttrs.indexOf(key) !== -1) {\n            start = Util.colorToRGBA(start);\n            endRGBA = Util.colorToRGBA(end);\n            diff = {\n                r: endRGBA.r - start.r,\n                g: endRGBA.g - start.g,\n                b: endRGBA.b - start.b,\n                a: endRGBA.a - start.a,\n            };\n        }\n        else {\n            diff = end - start;\n        }\n        Tween.attrs[nodeId][this._id][key] = {\n            start: start,\n            diff: diff,\n            end: end,\n            trueEnd: trueEnd,\n            trueStart: trueStart,\n        };\n        Tween.tweens[nodeId][key] = this._id;\n    }\n    _tweenFunc(i) {\n        const node = this.node, attrs = Tween.attrs[node._id][this._id];\n        let key, attr, start, diff, newVal, n, len, end;\n        for (key in attrs) {\n            attr = attrs[key];\n            start = attr.start;\n            diff = attr.diff;\n            end = attr.end;\n            if (Util._isArray(start)) {\n                newVal = [];\n                len = Math.max(start.length, end.length);\n                if (key.indexOf('fill') === 0) {\n                    for (n = 0; n < len; n++) {\n                        if (n % 2 === 0) {\n                            newVal.push((start[n] || 0) + diff[n] * i);\n                        }\n                        else {\n                            newVal.push('rgba(' +\n                                Math.round(start[n].r + diff[n].r * i) +\n                                ',' +\n                                Math.round(start[n].g + diff[n].g * i) +\n                                ',' +\n                                Math.round(start[n].b + diff[n].b * i) +\n                                ',' +\n                                (start[n].a + diff[n].a * i) +\n                                ')');\n                        }\n                    }\n                }\n                else {\n                    for (n = 0; n < len; n++) {\n                        newVal.push((start[n] || 0) + diff[n] * i);\n                    }\n                }\n            }\n            else if (colorAttrs.indexOf(key) !== -1) {\n                newVal =\n                    'rgba(' +\n                        Math.round(start.r + diff.r * i) +\n                        ',' +\n                        Math.round(start.g + diff.g * i) +\n                        ',' +\n                        Math.round(start.b + diff.b * i) +\n                        ',' +\n                        (start.a + diff.a * i) +\n                        ')';\n            }\n            else {\n                newVal = start + diff * i;\n            }\n            node.setAttr(key, newVal);\n        }\n    }\n    _addListeners() {\n        this.tween.onPlay = () => {\n            this.anim.start();\n        };\n        this.tween.onReverse = () => {\n            this.anim.start();\n        };\n        this.tween.onPause = () => {\n            this.anim.stop();\n        };\n        this.tween.onFinish = () => {\n            const node = this.node;\n            const attrs = Tween.attrs[node._id][this._id];\n            if (attrs.points && attrs.points.trueEnd) {\n                node.setAttr('points', attrs.points.trueEnd);\n            }\n            if (this.onFinish) {\n                this.onFinish.call(this);\n            }\n        };\n        this.tween.onReset = () => {\n            const node = this.node;\n            const attrs = Tween.attrs[node._id][this._id];\n            if (attrs.points && attrs.points.trueStart) {\n                node.points(attrs.points.trueStart);\n            }\n            if (this.onReset) {\n                this.onReset();\n            }\n        };\n        this.tween.onUpdate = () => {\n            if (this.onUpdate) {\n                this.onUpdate.call(this);\n            }\n        };\n    }\n    play() {\n        this.tween.play();\n        return this;\n    }\n    reverse() {\n        this.tween.reverse();\n        return this;\n    }\n    reset() {\n        this.tween.reset();\n        return this;\n    }\n    seek(t) {\n        this.tween.seek(t * 1000);\n        return this;\n    }\n    pause() {\n        this.tween.pause();\n        return this;\n    }\n    finish() {\n        this.tween.finish();\n        return this;\n    }\n    destroy() {\n        const nodeId = this.node._id, thisId = this._id, attrs = Tween.tweens[nodeId];\n        this.pause();\n        if (this.anim) {\n            this.anim.stop();\n        }\n        for (const key in attrs) {\n            delete Tween.tweens[nodeId][key];\n        }\n        delete Tween.attrs[nodeId][thisId];\n        if (Tween.tweens[nodeId]) {\n            if (Object.keys(Tween.tweens[nodeId]).length === 0) {\n                delete Tween.tweens[nodeId];\n            }\n            if (Object.keys(Tween.attrs[nodeId]).length === 0) {\n                delete Tween.attrs[nodeId];\n            }\n        }\n    }\n}\nTween.attrs = {};\nTween.tweens = {};\nNode.prototype.to = function (params) {\n    const onFinish = params.onFinish;\n    params.node = this;\n    params.onFinish = function () {\n        this.destroy();\n        if (onFinish) {\n            onFinish();\n        }\n    };\n    const tween = new Tween(params);\n    tween.play();\n};\nexport const Easings = {\n    BackEaseIn(t, b, c, d) {\n        const s = 1.70158;\n        return c * (t /= d) * t * ((s + 1) * t - s) + b;\n    },\n    BackEaseOut(t, b, c, d) {\n        const s = 1.70158;\n        return c * ((t = t / d - 1) * t * ((s + 1) * t + s) + 1) + b;\n    },\n    BackEaseInOut(t, b, c, d) {\n        let s = 1.70158;\n        if ((t /= d / 2) < 1) {\n            return (c / 2) * (t * t * (((s *= 1.525) + 1) * t - s)) + b;\n        }\n        return (c / 2) * ((t -= 2) * t * (((s *= 1.525) + 1) * t + s) + 2) + b;\n    },\n    ElasticEaseIn(t, b, c, d, a, p) {\n        let s = 0;\n        if (t === 0) {\n            return b;\n        }\n        if ((t /= d) === 1) {\n            return b + c;\n        }\n        if (!p) {\n            p = d * 0.3;\n        }\n        if (!a || a < Math.abs(c)) {\n            a = c;\n            s = p / 4;\n        }\n        else {\n            s = (p / (2 * Math.PI)) * Math.asin(c / a);\n        }\n        return (-(a *\n            Math.pow(2, 10 * (t -= 1)) *\n            Math.sin(((t * d - s) * (2 * Math.PI)) / p)) + b);\n    },\n    ElasticEaseOut(t, b, c, d, a, p) {\n        let s = 0;\n        if (t === 0) {\n            return b;\n        }\n        if ((t /= d) === 1) {\n            return b + c;\n        }\n        if (!p) {\n            p = d * 0.3;\n        }\n        if (!a || a < Math.abs(c)) {\n            a = c;\n            s = p / 4;\n        }\n        else {\n            s = (p / (2 * Math.PI)) * Math.asin(c / a);\n        }\n        return (a * Math.pow(2, -10 * t) * Math.sin(((t * d - s) * (2 * Math.PI)) / p) +\n            c +\n            b);\n    },\n    ElasticEaseInOut(t, b, c, d, a, p) {\n        let s = 0;\n        if (t === 0) {\n            return b;\n        }\n        if ((t /= d / 2) === 2) {\n            return b + c;\n        }\n        if (!p) {\n            p = d * (0.3 * 1.5);\n        }\n        if (!a || a < Math.abs(c)) {\n            a = c;\n            s = p / 4;\n        }\n        else {\n            s = (p / (2 * Math.PI)) * Math.asin(c / a);\n        }\n        if (t < 1) {\n            return (-0.5 *\n                (a *\n                    Math.pow(2, 10 * (t -= 1)) *\n                    Math.sin(((t * d - s) * (2 * Math.PI)) / p)) +\n                b);\n        }\n        return (a *\n            Math.pow(2, -10 * (t -= 1)) *\n            Math.sin(((t * d - s) * (2 * Math.PI)) / p) *\n            0.5 +\n            c +\n            b);\n    },\n    BounceEaseOut(t, b, c, d) {\n        if ((t /= d) < 1 / 2.75) {\n            return c * (7.5625 * t * t) + b;\n        }\n        else if (t < 2 / 2.75) {\n            return c * (7.5625 * (t -= 1.5 / 2.75) * t + 0.75) + b;\n        }\n        else if (t < 2.5 / 2.75) {\n            return c * (7.5625 * (t -= 2.25 / 2.75) * t + 0.9375) + b;\n        }\n        else {\n            return c * (7.5625 * (t -= 2.625 / 2.75) * t + 0.984375) + b;\n        }\n    },\n    BounceEaseIn(t, b, c, d) {\n        return c - Easings.BounceEaseOut(d - t, 0, c, d) + b;\n    },\n    BounceEaseInOut(t, b, c, d) {\n        if (t < d / 2) {\n            return Easings.BounceEaseIn(t * 2, 0, c, d) * 0.5 + b;\n        }\n        else {\n            return Easings.BounceEaseOut(t * 2 - d, 0, c, d) * 0.5 + c * 0.5 + b;\n        }\n    },\n    EaseIn(t, b, c, d) {\n        return c * (t /= d) * t + b;\n    },\n    EaseOut(t, b, c, d) {\n        return -c * (t /= d) * (t - 2) + b;\n    },\n    EaseInOut(t, b, c, d) {\n        if ((t /= d / 2) < 1) {\n            return (c / 2) * t * t + b;\n        }\n        return (-c / 2) * (--t * (t - 2) - 1) + b;\n    },\n    StrongEaseIn(t, b, c, d) {\n        return c * (t /= d) * t * t * t * t + b;\n    },\n    StrongEaseOut(t, b, c, d) {\n        return c * ((t = t / d - 1) * t * t * t * t + 1) + b;\n    },\n    StrongEaseInOut(t, b, c, d) {\n        if ((t /= d / 2) < 1) {\n            return (c / 2) * t * t * t * t * t + b;\n        }\n        return (c / 2) * ((t -= 2) * t * t * t * t + 2) + b;\n    },\n    Linear(t, b, c, d) {\n        return (c * t) / d + b;\n    },\n};\n", "import { Konva as Global } from \"./Global.js\";\nimport { Util, Transform } from \"./Util.js\";\nimport { Node } from \"./Node.js\";\nimport { Container } from \"./Container.js\";\nimport { Stage, stages } from \"./Stage.js\";\nimport { Layer } from \"./Layer.js\";\nimport { FastLayer } from \"./FastLayer.js\";\nimport { Group } from \"./Group.js\";\nimport { DD } from \"./DragAndDrop.js\";\nimport { Shape, shapes } from \"./Shape.js\";\nimport { Animation } from \"./Animation.js\";\nimport { Tween, Easings } from \"./Tween.js\";\nimport { Context } from \"./Context.js\";\nimport { Canvas } from \"./Canvas.js\";\nexport const Konva = Util._assign(Global, {\n    Util,\n    Transform,\n    Node,\n    Container,\n    Stage,\n    stages,\n    Layer,\n    FastLayer,\n    Group,\n    DD,\n    Shape,\n    shapes,\n    Animation,\n    Tween,\n    Easings,\n    Context,\n    Canvas,\n});\nexport default Konva;\n", "export { Konva } from \"./_CoreInternals.js\";\nimport { Konva } from \"./_CoreInternals.js\";\nexport default Konva;\n", "import { Factory } from \"../Factory.js\";\nimport { _registerNode } from \"../Global.js\";\nimport { Shape } from \"../Shape.js\";\nimport { getNumberArrayValidator, getNumberValidator } from \"../Validators.js\";\nfunction getControlPoints(x0, y0, x1, y1, x2, y2, t) {\n    const d01 = Math.sqrt(Math.pow(x1 - x0, 2) + Math.pow(y1 - y0, 2)), d12 = Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2)), fa = (t * d01) / (d01 + d12), fb = (t * d12) / (d01 + d12), p1x = x1 - fa * (x2 - x0), p1y = y1 - fa * (y2 - y0), p2x = x1 + fb * (x2 - x0), p2y = y1 + fb * (y2 - y0);\n    return [p1x, p1y, p2x, p2y];\n}\nfunction expandPoints(p, tension) {\n    const len = p.length, allPoints = [];\n    for (let n = 2; n < len - 2; n += 2) {\n        const cp = getControlPoints(p[n - 2], p[n - 1], p[n], p[n + 1], p[n + 2], p[n + 3], tension);\n        if (isNaN(cp[0])) {\n            continue;\n        }\n        allPoints.push(cp[0]);\n        allPoints.push(cp[1]);\n        allPoints.push(p[n]);\n        allPoints.push(p[n + 1]);\n        allPoints.push(cp[2]);\n        allPoints.push(cp[3]);\n    }\n    return allPoints;\n}\nexport class Line extends Shape {\n    constructor(config) {\n        super(config);\n        this.on('pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva', function () {\n            this._clearCache('tensionPoints');\n        });\n    }\n    _sceneFunc(context) {\n        const points = this.points(), length = points.length, tension = this.tension(), closed = this.closed(), bezier = this.bezier();\n        if (!length) {\n            return;\n        }\n        let n = 0;\n        context.beginPath();\n        context.moveTo(points[0], points[1]);\n        if (tension !== 0 && length > 4) {\n            const tp = this.getTensionPoints();\n            const len = tp.length;\n            n = closed ? 0 : 4;\n            if (!closed) {\n                context.quadraticCurveTo(tp[0], tp[1], tp[2], tp[3]);\n            }\n            while (n < len - 2) {\n                context.bezierCurveTo(tp[n++], tp[n++], tp[n++], tp[n++], tp[n++], tp[n++]);\n            }\n            if (!closed) {\n                context.quadraticCurveTo(tp[len - 2], tp[len - 1], points[length - 2], points[length - 1]);\n            }\n        }\n        else if (bezier) {\n            n = 2;\n            while (n < length) {\n                context.bezierCurveTo(points[n++], points[n++], points[n++], points[n++], points[n++], points[n++]);\n            }\n        }\n        else {\n            for (n = 2; n < length; n += 2) {\n                context.lineTo(points[n], points[n + 1]);\n            }\n        }\n        if (closed) {\n            context.closePath();\n            context.fillStrokeShape(this);\n        }\n        else {\n            context.strokeShape(this);\n        }\n    }\n    getTensionPoints() {\n        return this._getCache('tensionPoints', this._getTensionPoints);\n    }\n    _getTensionPoints() {\n        if (this.closed()) {\n            return this._getTensionPointsClosed();\n        }\n        else {\n            return expandPoints(this.points(), this.tension());\n        }\n    }\n    _getTensionPointsClosed() {\n        const p = this.points(), len = p.length, tension = this.tension(), firstControlPoints = getControlPoints(p[len - 2], p[len - 1], p[0], p[1], p[2], p[3], tension), lastControlPoints = getControlPoints(p[len - 4], p[len - 3], p[len - 2], p[len - 1], p[0], p[1], tension), middle = expandPoints(p, tension), tp = [firstControlPoints[2], firstControlPoints[3]]\n            .concat(middle)\n            .concat([\n            lastControlPoints[0],\n            lastControlPoints[1],\n            p[len - 2],\n            p[len - 1],\n            lastControlPoints[2],\n            lastControlPoints[3],\n            firstControlPoints[0],\n            firstControlPoints[1],\n            p[0],\n            p[1],\n        ]);\n        return tp;\n    }\n    getWidth() {\n        return this.getSelfRect().width;\n    }\n    getHeight() {\n        return this.getSelfRect().height;\n    }\n    getSelfRect() {\n        let points = this.points();\n        if (points.length < 4) {\n            return {\n                x: points[0] || 0,\n                y: points[1] || 0,\n                width: 0,\n                height: 0,\n            };\n        }\n        if (this.tension() !== 0) {\n            points = [\n                points[0],\n                points[1],\n                ...this._getTensionPoints(),\n                points[points.length - 2],\n                points[points.length - 1],\n            ];\n        }\n        else {\n            points = this.points();\n        }\n        let minX = points[0];\n        let maxX = points[0];\n        let minY = points[1];\n        let maxY = points[1];\n        let x, y;\n        for (let i = 0; i < points.length / 2; i++) {\n            x = points[i * 2];\n            y = points[i * 2 + 1];\n            minX = Math.min(minX, x);\n            maxX = Math.max(maxX, x);\n            minY = Math.min(minY, y);\n            maxY = Math.max(maxY, y);\n        }\n        return {\n            x: minX,\n            y: minY,\n            width: maxX - minX,\n            height: maxY - minY,\n        };\n    }\n}\nLine.prototype.className = 'Line';\nLine.prototype._attrsAffectingSize = ['points', 'bezier', 'tension'];\n_registerNode(Line);\nFactory.addGetterSetter(Line, 'closed', false);\nFactory.addGetterSetter(Line, 'bezier', false);\nFactory.addGetterSetter(Line, 'tension', 0, getNumberValidator());\nFactory.addGetterSetter(Line, 'points', [], getNumberArrayValidator());\n", "import { Factory } from \"../Factory.js\";\nimport { Shape } from \"../Shape.js\";\nimport { _registerNode } from \"../Global.js\";\nimport { Util } from \"../Util.js\";\nimport { getNumberOrArrayOfNumbersValidator } from \"../Validators.js\";\nexport class Rect extends Shape {\n    _sceneFunc(context) {\n        const cornerRadius = this.cornerRadius(), width = this.width(), height = this.height();\n        context.beginPath();\n        if (!cornerRadius) {\n            context.rect(0, 0, width, height);\n        }\n        else {\n            Util.drawRoundedRectPath(context, width, height, cornerRadius);\n        }\n        context.closePath();\n        context.fillStrokeShape(this);\n    }\n}\nRect.prototype.className = 'Rect';\n_registerNode(Rect);\nFactory.addGetterSetter(Rect, 'cornerRadius', 0, getNumberOrArrayOfNumbersValidator(4));\n", "import { Util } from \"../Util.js\";\nimport { Factory } from \"../Factory.js\";\nimport { Shape } from \"../Shape.js\";\nimport { Konva } from \"../Global.js\";\nimport { getNumberValidator, getStringValidator, getNumberOrAutoValidator, getBooleanValidator, } from \"../Validators.js\";\nimport { _registerNode } from \"../Global.js\";\nexport function stringToArray(string) {\n    return [...string].reduce((acc, char, index, array) => {\n        if (/\\p{Emoji}/u.test(char)) {\n            const nextChar = array[index + 1];\n            if (nextChar && /\\p{Emoji_Modifier}|\\u200D/u.test(nextChar)) {\n                acc.push(char + nextChar);\n                array[index + 1] = '';\n            }\n            else {\n                acc.push(char);\n            }\n        }\n        else if (/\\p{Regional_Indicator}{2}/u.test(char + (array[index + 1] || ''))) {\n            acc.push(char + array[index + 1]);\n        }\n        else if (index > 0 && /\\p{Mn}|\\p{Me}|\\p{Mc}/u.test(char)) {\n            acc[acc.length - 1] += char;\n        }\n        else if (char) {\n            acc.push(char);\n        }\n        return acc;\n    }, []);\n}\nconst AUTO = 'auto', CENTER = 'center', INHERIT = 'inherit', JUSTIFY = 'justify', CHANGE_KONVA = 'Change.konva', CONTEXT_2D = '2d', DASH = '-', LEFT = 'left', TEXT = 'text', TEXT_UPPER = 'Text', TOP = 'top', BOTTOM = 'bottom', MIDDLE = 'middle', NORMAL = 'normal', PX_SPACE = 'px ', SPACE = ' ', RIGHT = 'right', RTL = 'rtl', WORD = 'word', CHAR = 'char', NONE = 'none', ELLIPSIS = '', ATTR_CHANGE_LIST = [\n    'direction',\n    'fontFamily',\n    'fontSize',\n    'fontStyle',\n    'fontVariant',\n    'padding',\n    'align',\n    'verticalAlign',\n    'lineHeight',\n    'text',\n    'width',\n    'height',\n    'wrap',\n    'ellipsis',\n    'letterSpacing',\n], attrChangeListLen = ATTR_CHANGE_LIST.length;\nfunction normalizeFontFamily(fontFamily) {\n    return fontFamily\n        .split(',')\n        .map((family) => {\n        family = family.trim();\n        const hasSpace = family.indexOf(' ') >= 0;\n        const hasQuotes = family.indexOf('\"') >= 0 || family.indexOf(\"'\") >= 0;\n        if (hasSpace && !hasQuotes) {\n            family = `\"${family}\"`;\n        }\n        return family;\n    })\n        .join(', ');\n}\nlet dummyContext;\nfunction getDummyContext() {\n    if (dummyContext) {\n        return dummyContext;\n    }\n    dummyContext = Util.createCanvasElement().getContext(CONTEXT_2D);\n    return dummyContext;\n}\nfunction _fillFunc(context) {\n    context.fillText(this._partialText, this._partialTextX, this._partialTextY);\n}\nfunction _strokeFunc(context) {\n    context.setAttr('miterLimit', 2);\n    context.strokeText(this._partialText, this._partialTextX, this._partialTextY);\n}\nfunction checkDefaultFill(config) {\n    config = config || {};\n    if (!config.fillLinearGradientColorStops &&\n        !config.fillRadialGradientColorStops &&\n        !config.fillPatternImage) {\n        config.fill = config.fill || 'black';\n    }\n    return config;\n}\nexport class Text extends Shape {\n    constructor(config) {\n        super(checkDefaultFill(config));\n        this._partialTextX = 0;\n        this._partialTextY = 0;\n        for (let n = 0; n < attrChangeListLen; n++) {\n            this.on(ATTR_CHANGE_LIST[n] + CHANGE_KONVA, this._setTextData);\n        }\n        this._setTextData();\n    }\n    _sceneFunc(context) {\n        var _a, _b;\n        const textArr = this.textArr, textArrLen = textArr.length;\n        if (!this.text()) {\n            return;\n        }\n        let padding = this.padding(), fontSize = this.fontSize(), lineHeightPx = this.lineHeight() * fontSize, verticalAlign = this.verticalAlign(), direction = this.direction(), alignY = 0, align = this.align(), totalWidth = this.getWidth(), letterSpacing = this.letterSpacing(), charRenderFunc = this.charRenderFunc(), fill = this.fill(), textDecoration = this.textDecoration(), shouldUnderline = textDecoration.indexOf('underline') !== -1, shouldLineThrough = textDecoration.indexOf('line-through') !== -1, n;\n        direction = direction === INHERIT ? context.direction : direction;\n        let translateY = lineHeightPx / 2;\n        let baseline = MIDDLE;\n        if (!Konva.legacyTextRendering) {\n            const metrics = this.measureSize('M');\n            baseline = 'alphabetic';\n            const ascent = (_a = metrics.fontBoundingBoxAscent) !== null && _a !== void 0 ? _a : metrics.actualBoundingBoxAscent;\n            const descent = (_b = metrics.fontBoundingBoxDescent) !== null && _b !== void 0 ? _b : metrics.actualBoundingBoxDescent;\n            translateY = (ascent - descent) / 2 + lineHeightPx / 2;\n        }\n        if (direction === RTL) {\n            context.setAttr('direction', direction);\n        }\n        context.setAttr('font', this._getContextFont());\n        context.setAttr('textBaseline', baseline);\n        context.setAttr('textAlign', LEFT);\n        if (verticalAlign === MIDDLE) {\n            alignY = (this.getHeight() - textArrLen * lineHeightPx - padding * 2) / 2;\n        }\n        else if (verticalAlign === BOTTOM) {\n            alignY = this.getHeight() - textArrLen * lineHeightPx - padding * 2;\n        }\n        context.translate(padding, alignY + padding);\n        for (n = 0; n < textArrLen; n++) {\n            let lineTranslateX = 0;\n            let lineTranslateY = 0;\n            const obj = textArr[n], text = obj.text, width = obj.width, lastLine = obj.lastInParagraph;\n            context.save();\n            if (align === RIGHT) {\n                lineTranslateX += totalWidth - width - padding * 2;\n            }\n            else if (align === CENTER) {\n                lineTranslateX += (totalWidth - width - padding * 2) / 2;\n            }\n            if (shouldUnderline) {\n                context.save();\n                context.beginPath();\n                const yOffset = !Konva.legacyTextRendering\n                    ? Math.round(fontSize / 4)\n                    : Math.round(fontSize / 2);\n                const x = lineTranslateX;\n                const y = translateY + lineTranslateY + yOffset;\n                context.moveTo(x, y);\n                const lineWidth = align === JUSTIFY && !lastLine ? totalWidth - padding * 2 : width;\n                context.lineTo(x + Math.round(lineWidth), y);\n                context.lineWidth = fontSize / 15;\n                const gradient = this._getLinearGradient();\n                context.strokeStyle = gradient || fill;\n                context.stroke();\n                context.restore();\n            }\n            const lineThroughStartX = lineTranslateX;\n            if (direction !== RTL &&\n                (letterSpacing !== 0 || align === JUSTIFY || charRenderFunc)) {\n                const spacesNumber = text.split(' ').length - 1;\n                const array = stringToArray(text);\n                for (let li = 0; li < array.length; li++) {\n                    const letter = array[li];\n                    if (letter === ' ' && !lastLine && align === JUSTIFY) {\n                        lineTranslateX += (totalWidth - padding * 2 - width) / spacesNumber;\n                    }\n                    this._partialTextX = lineTranslateX;\n                    this._partialTextY = translateY + lineTranslateY;\n                    this._partialText = letter;\n                    if (charRenderFunc) {\n                        context.save();\n                        const previousLines = textArr.slice(0, n);\n                        const previousGraphemes = previousLines.reduce((acc, line) => acc + stringToArray(line.text).length, 0);\n                        const charIndex = li + previousGraphemes;\n                        charRenderFunc({\n                            char: letter,\n                            index: charIndex,\n                            x: lineTranslateX,\n                            y: translateY + lineTranslateY,\n                            lineIndex: n,\n                            column: li,\n                            isLastInLine: lastLine,\n                            width: this.measureSize(letter).width,\n                            context,\n                        });\n                    }\n                    context.fillStrokeShape(this);\n                    if (charRenderFunc) {\n                        context.restore();\n                    }\n                    lineTranslateX += this.measureSize(letter).width + letterSpacing;\n                }\n            }\n            else {\n                if (letterSpacing !== 0) {\n                    context.setAttr('letterSpacing', `${letterSpacing}px`);\n                }\n                this._partialTextX = lineTranslateX;\n                this._partialTextY = translateY + lineTranslateY;\n                this._partialText = text;\n                context.fillStrokeShape(this);\n            }\n            if (shouldLineThrough) {\n                context.save();\n                context.beginPath();\n                const yOffset = !Konva.legacyTextRendering\n                    ? -Math.round(fontSize / 4)\n                    : 0;\n                const x = lineThroughStartX;\n                context.moveTo(x, translateY + lineTranslateY + yOffset);\n                const lineWidth = align === JUSTIFY && !lastLine ? totalWidth - padding * 2 : width;\n                context.lineTo(x + Math.round(lineWidth), translateY + lineTranslateY + yOffset);\n                context.lineWidth = fontSize / 15;\n                const gradient = this._getLinearGradient();\n                context.strokeStyle = gradient || fill;\n                context.stroke();\n                context.restore();\n            }\n            context.restore();\n            if (textArrLen > 1) {\n                translateY += lineHeightPx;\n            }\n        }\n    }\n    _hitFunc(context) {\n        const width = this.getWidth(), height = this.getHeight();\n        context.beginPath();\n        context.rect(0, 0, width, height);\n        context.closePath();\n        context.fillStrokeShape(this);\n    }\n    setText(text) {\n        const str = Util._isString(text)\n            ? text\n            : text === null || text === undefined\n                ? ''\n                : text + '';\n        this._setAttr(TEXT, str);\n        return this;\n    }\n    getWidth() {\n        const isAuto = this.attrs.width === AUTO || this.attrs.width === undefined;\n        return isAuto ? this.getTextWidth() + this.padding() * 2 : this.attrs.width;\n    }\n    getHeight() {\n        const isAuto = this.attrs.height === AUTO || this.attrs.height === undefined;\n        return isAuto\n            ? this.fontSize() * this.textArr.length * this.lineHeight() +\n                this.padding() * 2\n            : this.attrs.height;\n    }\n    getTextWidth() {\n        return this.textWidth;\n    }\n    getTextHeight() {\n        Util.warn('text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height.');\n        return this.textHeight;\n    }\n    measureSize(text) {\n        var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l;\n        let _context = getDummyContext(), fontSize = this.fontSize(), metrics;\n        _context.save();\n        _context.font = this._getContextFont();\n        metrics = _context.measureText(text);\n        _context.restore();\n        const scaleFactor = fontSize / 100;\n        return {\n            actualBoundingBoxAscent: (_a = metrics.actualBoundingBoxAscent) !== null && _a !== void 0 ? _a : 71.58203125 * scaleFactor,\n            actualBoundingBoxDescent: (_b = metrics.actualBoundingBoxDescent) !== null && _b !== void 0 ? _b : 0,\n            actualBoundingBoxLeft: (_c = metrics.actualBoundingBoxLeft) !== null && _c !== void 0 ? _c : -7.421875 * scaleFactor,\n            actualBoundingBoxRight: (_d = metrics.actualBoundingBoxRight) !== null && _d !== void 0 ? _d : 75.732421875 * scaleFactor,\n            alphabeticBaseline: (_e = metrics.alphabeticBaseline) !== null && _e !== void 0 ? _e : 0,\n            emHeightAscent: (_f = metrics.emHeightAscent) !== null && _f !== void 0 ? _f : 100 * scaleFactor,\n            emHeightDescent: (_g = metrics.emHeightDescent) !== null && _g !== void 0 ? _g : -20 * scaleFactor,\n            fontBoundingBoxAscent: (_h = metrics.fontBoundingBoxAscent) !== null && _h !== void 0 ? _h : 91 * scaleFactor,\n            fontBoundingBoxDescent: (_j = metrics.fontBoundingBoxDescent) !== null && _j !== void 0 ? _j : 21 * scaleFactor,\n            hangingBaseline: (_k = metrics.hangingBaseline) !== null && _k !== void 0 ? _k : 72.80000305175781 * scaleFactor,\n            ideographicBaseline: (_l = metrics.ideographicBaseline) !== null && _l !== void 0 ? _l : -21 * scaleFactor,\n            width: metrics.width,\n            height: fontSize,\n        };\n    }\n    _getContextFont() {\n        return (this.fontStyle() +\n            SPACE +\n            this.fontVariant() +\n            SPACE +\n            (this.fontSize() + PX_SPACE) +\n            normalizeFontFamily(this.fontFamily()));\n    }\n    _addTextLine(line) {\n        const align = this.align();\n        if (align === JUSTIFY) {\n            line = line.trim();\n        }\n        const width = this._getTextWidth(line);\n        return this.textArr.push({\n            text: line,\n            width: width,\n            lastInParagraph: false,\n        });\n    }\n    _getTextWidth(text) {\n        const letterSpacing = this.letterSpacing();\n        const length = text.length;\n        return getDummyContext().measureText(text).width + letterSpacing * length;\n    }\n    _setTextData() {\n        let lines = this.text().split('\\n'), fontSize = +this.fontSize(), textWidth = 0, lineHeightPx = this.lineHeight() * fontSize, width = this.attrs.width, height = this.attrs.height, fixedWidth = width !== AUTO && width !== undefined, fixedHeight = height !== AUTO && height !== undefined, padding = this.padding(), maxWidth = width - padding * 2, maxHeightPx = height - padding * 2, currentHeightPx = 0, wrap = this.wrap(), shouldWrap = wrap !== NONE, wrapAtWord = wrap !== CHAR && shouldWrap, shouldAddEllipsis = this.ellipsis();\n        this.textArr = [];\n        getDummyContext().font = this._getContextFont();\n        const additionalWidth = shouldAddEllipsis\n            ? this._getTextWidth(ELLIPSIS)\n            : 0;\n        for (let i = 0, max = lines.length; i < max; ++i) {\n            let line = lines[i];\n            let lineWidth = this._getTextWidth(line);\n            if (fixedWidth && lineWidth > maxWidth) {\n                while (line.length > 0) {\n                    let low = 0, high = stringToArray(line).length, match = '', matchWidth = 0;\n                    while (low < high) {\n                        const mid = (low + high) >>> 1, lineArray = stringToArray(line), substr = lineArray.slice(0, mid + 1).join(''), substrWidth = this._getTextWidth(substr);\n                        const shouldConsiderEllipsis = shouldAddEllipsis &&\n                            fixedHeight &&\n                            currentHeightPx + lineHeightPx > maxHeightPx;\n                        const effectiveWidth = shouldConsiderEllipsis\n                            ? substrWidth + additionalWidth\n                            : substrWidth;\n                        if (effectiveWidth <= maxWidth) {\n                            low = mid + 1;\n                            match = substr;\n                            matchWidth = substrWidth;\n                        }\n                        else {\n                            high = mid;\n                        }\n                    }\n                    if (match) {\n                        if (wrapAtWord) {\n                            const lineArray = stringToArray(line);\n                            const matchArray = stringToArray(match);\n                            const nextChar = lineArray[matchArray.length];\n                            const nextIsSpaceOrDash = nextChar === SPACE || nextChar === DASH;\n                            let wrapIndex;\n                            if (nextIsSpaceOrDash && matchWidth <= maxWidth) {\n                                wrapIndex = matchArray.length;\n                            }\n                            else {\n                                const lastSpaceIndex = matchArray.lastIndexOf(SPACE);\n                                const lastDashIndex = matchArray.lastIndexOf(DASH);\n                                wrapIndex = Math.max(lastSpaceIndex, lastDashIndex) + 1;\n                            }\n                            if (wrapIndex > 0) {\n                                low = wrapIndex;\n                                match = lineArray.slice(0, low).join('');\n                                matchWidth = this._getTextWidth(match);\n                            }\n                        }\n                        match = match.trimRight();\n                        this._addTextLine(match);\n                        textWidth = Math.max(textWidth, matchWidth);\n                        currentHeightPx += lineHeightPx;\n                        const shouldHandleEllipsis = this._shouldHandleEllipsis(currentHeightPx);\n                        if (shouldHandleEllipsis) {\n                            this._tryToAddEllipsisToLastLine();\n                            break;\n                        }\n                        const lineArray = stringToArray(line);\n                        line = lineArray.slice(low).join('').trimLeft();\n                        if (line.length > 0) {\n                            lineWidth = this._getTextWidth(line);\n                            if (lineWidth <= maxWidth) {\n                                this._addTextLine(line);\n                                currentHeightPx += lineHeightPx;\n                                textWidth = Math.max(textWidth, lineWidth);\n                                break;\n                            }\n                        }\n                    }\n                    else {\n                        break;\n                    }\n                }\n            }\n            else {\n                this._addTextLine(line);\n                currentHeightPx += lineHeightPx;\n                textWidth = Math.max(textWidth, lineWidth);\n                if (this._shouldHandleEllipsis(currentHeightPx) && i < max - 1) {\n                    this._tryToAddEllipsisToLastLine();\n                }\n            }\n            if (this.textArr[this.textArr.length - 1]) {\n                this.textArr[this.textArr.length - 1].lastInParagraph = true;\n            }\n            if (fixedHeight && currentHeightPx + lineHeightPx > maxHeightPx) {\n                break;\n            }\n        }\n        this.textHeight = fontSize;\n        this.textWidth = textWidth;\n    }\n    _shouldHandleEllipsis(currentHeightPx) {\n        const fontSize = +this.fontSize(), lineHeightPx = this.lineHeight() * fontSize, height = this.attrs.height, fixedHeight = height !== AUTO && height !== undefined, padding = this.padding(), maxHeightPx = height - padding * 2, wrap = this.wrap(), shouldWrap = wrap !== NONE;\n        return (!shouldWrap ||\n            (fixedHeight && currentHeightPx + lineHeightPx > maxHeightPx));\n    }\n    _tryToAddEllipsisToLastLine() {\n        const width = this.attrs.width, fixedWidth = width !== AUTO && width !== undefined, padding = this.padding(), maxWidth = width - padding * 2, shouldAddEllipsis = this.ellipsis();\n        const lastLine = this.textArr[this.textArr.length - 1];\n        if (!lastLine || !shouldAddEllipsis) {\n            return;\n        }\n        if (fixedWidth) {\n            const haveSpace = this._getTextWidth(lastLine.text + ELLIPSIS) < maxWidth;\n            if (!haveSpace) {\n                lastLine.text = lastLine.text.slice(0, lastLine.text.length - 3);\n            }\n        }\n        this.textArr.splice(this.textArr.length - 1, 1);\n        this._addTextLine(lastLine.text + ELLIPSIS);\n    }\n    getStrokeScaleEnabled() {\n        return true;\n    }\n    _useBufferCanvas() {\n        const hasLine = this.textDecoration().indexOf('underline') !== -1 ||\n            this.textDecoration().indexOf('line-through') !== -1;\n        const hasShadow = this.hasShadow();\n        if (hasLine && hasShadow) {\n            return true;\n        }\n        return super._useBufferCanvas();\n    }\n}\nText.prototype._fillFunc = _fillFunc;\nText.prototype._strokeFunc = _strokeFunc;\nText.prototype.className = TEXT_UPPER;\nText.prototype._attrsAffectingSize = [\n    'text',\n    'fontSize',\n    'padding',\n    'wrap',\n    'lineHeight',\n    'letterSpacing',\n];\n_registerNode(Text);\nFactory.overWriteSetter(Text, 'width', getNumberOrAutoValidator());\nFactory.overWriteSetter(Text, 'height', getNumberOrAutoValidator());\nFactory.addGetterSetter(Text, 'direction', INHERIT);\nFactory.addGetterSetter(Text, 'fontFamily', 'Arial');\nFactory.addGetterSetter(Text, 'fontSize', 12, getNumberValidator());\nFactory.addGetterSetter(Text, 'fontStyle', NORMAL);\nFactory.addGetterSetter(Text, 'fontVariant', NORMAL);\nFactory.addGetterSetter(Text, 'padding', 0, getNumberValidator());\nFactory.addGetterSetter(Text, 'align', LEFT);\nFactory.addGetterSetter(Text, 'verticalAlign', TOP);\nFactory.addGetterSetter(Text, 'lineHeight', 1, getNumberValidator());\nFactory.addGetterSetter(Text, 'wrap', WORD);\nFactory.addGetterSetter(Text, 'ellipsis', false, getBooleanValidator());\nFactory.addGetterSetter(Text, 'letterSpacing', 0, getNumberValidator());\nFactory.addGetterSetter(Text, 'text', '', getStringValidator());\nFactory.addGetterSetter(Text, 'textDecoration', '');\nFactory.addGetterSetter(Text, 'charRenderFunc', undefined);\n", "/**\n * Provides access to the waveform data for a single audio channel.\n */\n\nfunction WaveformDataChannel(waveformData, channelIndex) {\n  this._waveformData = waveformData;\n  this._channelIndex = channelIndex;\n}\n\n/**\n * Returns the waveform minimum at the given index position.\n */\n\nWaveformDataChannel.prototype.min_sample = function (index) {\n  var offset = (index * this._waveformData.channels + this._channelIndex) * 2;\n  return this._waveformData._at(offset);\n};\n\n/**\n * Returns the waveform maximum at the given index position.\n */\n\nWaveformDataChannel.prototype.max_sample = function (index) {\n  var offset = (index * this._waveformData.channels + this._channelIndex) * 2 + 1;\n  return this._waveformData._at(offset);\n};\n\n/**\n * Sets the waveform minimum at the given index position.\n */\n\nWaveformDataChannel.prototype.set_min_sample = function (index, sample) {\n  var offset = (index * this._waveformData.channels + this._channelIndex) * 2;\n  return this._waveformData._set_at(offset, sample);\n};\n\n/**\n * Sets the waveform maximum at the given index position.\n */\n\nWaveformDataChannel.prototype.set_max_sample = function (index, sample) {\n  var offset = (index * this._waveformData.channels + this._channelIndex) * 2 + 1;\n  return this._waveformData._set_at(offset, sample);\n};\n\n/**\n * Returns all the waveform minimum values as an array.\n */\n\nWaveformDataChannel.prototype.min_array = function () {\n  var length = this._waveformData.length;\n  var values = [];\n  for (var i = 0; i < length; i++) {\n    values.push(this.min_sample(i));\n  }\n  return values;\n};\n\n/**\n * Returns all the waveform maximum values as an array.\n */\n\nWaveformDataChannel.prototype.max_array = function () {\n  var length = this._waveformData.length;\n  var values = [];\n  for (var i = 0; i < length; i++) {\n    values.push(this.max_sample(i));\n  }\n  return values;\n};\n\n/**\n * AudioBuffer-based WaveformData generator\n *\n * Adapted from BlockFile::CalcSummary in Audacity, with permission.\n * See https://github.com/audacity/audacity/blob/\n *   1108c1376c09166162335fab4743008cba57c4ee/src/BlockFile.cpp#L198\n */\n\nvar INT8_MAX = 127;\nvar INT8_MIN = -128;\nvar INT16_MAX = 32767;\nvar INT16_MIN = -32768;\nfunction calculateWaveformDataLength(audio_sample_count, scale) {\n  var data_length = Math.floor(audio_sample_count / scale);\n  var samples_remaining = audio_sample_count - data_length * scale;\n  if (samples_remaining > 0) {\n    data_length++;\n  }\n  return data_length;\n}\nfunction generateWaveformData(options) {\n  var scale = options.scale;\n  var amplitude_scale = options.amplitude_scale;\n  var split_channels = options.split_channels;\n  var length = options.length;\n  var sample_rate = options.sample_rate;\n  var channels = options.channels.map(function (channel) {\n    return new Float32Array(channel);\n  });\n  var output_channels = split_channels ? channels.length : 1;\n  var header_size = 24;\n  var data_length = calculateWaveformDataLength(length, scale);\n  var bytes_per_sample = options.bits === 8 ? 1 : 2;\n  var total_size = header_size + data_length * 2 * bytes_per_sample * output_channels;\n  var buffer = new ArrayBuffer(total_size);\n  var data_view = new DataView(buffer);\n  var scale_counter = 0;\n  var offset = header_size;\n  var min_value = new Array(output_channels);\n  var max_value = new Array(output_channels);\n  for (var channel = 0; channel < output_channels; channel++) {\n    min_value[channel] = Infinity;\n    max_value[channel] = -Infinity;\n  }\n  var range_min = options.bits === 8 ? INT8_MIN : INT16_MIN;\n  var range_max = options.bits === 8 ? INT8_MAX : INT16_MAX;\n  data_view.setInt32(0, 2, true); // Version\n  data_view.setUint32(4, options.bits === 8, true); // Is 8 bit?\n  data_view.setInt32(8, sample_rate, true); // Sample rate\n  data_view.setInt32(12, scale, true); // Scale\n  data_view.setInt32(16, data_length, true); // Length\n  data_view.setInt32(20, output_channels, true);\n  for (var i = 0; i < length; i++) {\n    var sample = 0;\n    if (output_channels === 1) {\n      for (var _channel = 0; _channel < channels.length; ++_channel) {\n        sample += channels[_channel][i];\n      }\n      sample = Math.floor(range_max * sample * amplitude_scale / channels.length);\n      if (sample < min_value[0]) {\n        min_value[0] = sample;\n        if (min_value[0] < range_min) {\n          min_value[0] = range_min;\n        }\n      }\n      if (sample > max_value[0]) {\n        max_value[0] = sample;\n        if (max_value[0] > range_max) {\n          max_value[0] = range_max;\n        }\n      }\n    } else {\n      for (var _channel2 = 0; _channel2 < output_channels; ++_channel2) {\n        sample = Math.floor(range_max * channels[_channel2][i] * amplitude_scale);\n        if (sample < min_value[_channel2]) {\n          min_value[_channel2] = sample;\n          if (min_value[_channel2] < range_min) {\n            min_value[_channel2] = range_min;\n          }\n        }\n        if (sample > max_value[_channel2]) {\n          max_value[_channel2] = sample;\n          if (max_value[_channel2] > range_max) {\n            max_value[_channel2] = range_max;\n          }\n        }\n      }\n    }\n    if (++scale_counter === scale) {\n      for (var _channel3 = 0; _channel3 < output_channels; _channel3++) {\n        if (options.bits === 8) {\n          data_view.setInt8(offset++, min_value[_channel3]);\n          data_view.setInt8(offset++, max_value[_channel3]);\n        } else {\n          data_view.setInt16(offset, min_value[_channel3], true);\n          data_view.setInt16(offset + 2, max_value[_channel3], true);\n          offset += 4;\n        }\n        min_value[_channel3] = Infinity;\n        max_value[_channel3] = -Infinity;\n      }\n      scale_counter = 0;\n    }\n  }\n  if (scale_counter > 0) {\n    for (var _channel4 = 0; _channel4 < output_channels; _channel4++) {\n      if (options.bits === 8) {\n        data_view.setInt8(offset++, min_value[_channel4]);\n        data_view.setInt8(offset++, max_value[_channel4]);\n      } else {\n        data_view.setInt16(offset, min_value[_channel4], true);\n        data_view.setInt16(offset + 2, max_value[_channel4], true);\n      }\n    }\n  }\n  return buffer;\n}\n\nfunction _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, _typeof(o);\n}\n\nfunction isJsonWaveformData(data) {\n  return data && _typeof(data) === 'object' && 'sample_rate' in data && 'samples_per_pixel' in data && 'bits' in data && 'length' in data && 'data' in data;\n}\nfunction isBinaryWaveformData(data) {\n  var isCompatible = data && _typeof(data) === 'object' && 'byteLength' in data;\n  if (isCompatible) {\n    var view = new DataView(data);\n    var version = view.getInt32(0, true);\n    if (version !== 1 && version !== 2) {\n      throw new TypeError('WaveformData.create(): This waveform data version not supported');\n    }\n  }\n  return isCompatible;\n}\nfunction convertJsonToBinary(data) {\n  var waveformData = data.data;\n  var channels = data.channels || 1;\n  var header_size = 24; // version 2\n  var bytes_per_sample = data.bits === 8 ? 1 : 2;\n  var expected_length = data.length * 2 * channels;\n  if (waveformData.length !== expected_length) {\n    throw new Error('WaveformData.create(): Length mismatch in JSON waveform data');\n  }\n  var total_size = header_size + waveformData.length * bytes_per_sample;\n  var array_buffer = new ArrayBuffer(total_size);\n  var data_object = new DataView(array_buffer);\n  data_object.setInt32(0, 2, true); // Version\n  data_object.setUint32(4, data.bits === 8, true);\n  data_object.setInt32(8, data.sample_rate, true);\n  data_object.setInt32(12, data.samples_per_pixel, true);\n  data_object.setInt32(16, data.length, true);\n  data_object.setInt32(20, channels, true);\n  var index = header_size;\n  if (data.bits === 8) {\n    for (var i = 0; i < waveformData.length; i++) {\n      data_object.setInt8(index++, waveformData[i], true);\n    }\n  } else {\n    for (var _i = 0; _i < waveformData.length; _i++) {\n      data_object.setInt16(index, waveformData[_i], true);\n      index += 2;\n    }\n  }\n  return array_buffer;\n}\n\nfunction isNullOrUndefined(value) {\n  return value === undefined || value === null;\n}\n\nfunction decodeBase64(base64, enableUnicode) {\n    var binaryString = atob(base64);\n    if (enableUnicode) {\n        var binaryView = new Uint8Array(binaryString.length);\n        for (var i = 0, n = binaryString.length; i < n; ++i) {\n            binaryView[i] = binaryString.charCodeAt(i);\n        }\n        return String.fromCharCode.apply(null, new Uint16Array(binaryView.buffer));\n    }\n    return binaryString;\n}\n\nfunction createURL(base64, sourcemapArg, enableUnicodeArg) {\n    var sourcemap = sourcemapArg === undefined ? null : sourcemapArg;\n    var enableUnicode = enableUnicodeArg === undefined ? false : enableUnicodeArg;\n    var source = decodeBase64(base64, enableUnicode);\n    var start = source.indexOf('\\n', 10) + 1;\n    var body = source.substring(start) + (sourcemap ? '\\/\\/# sourceMappingURL=' + sourcemap : '');\n    var blob = new Blob([body], { type: 'application/javascript' });\n    return URL.createObjectURL(blob);\n}\n\nfunction createBase64WorkerFactory(base64, sourcemapArg, enableUnicodeArg) {\n    var url;\n    return function WorkerFactory(options) {\n        url = url || createURL(base64, sourcemapArg, enableUnicodeArg);\n        return new Worker(url, options);\n    };\n}\n\nvar WorkerFactory = /*#__PURE__*/createBase64WorkerFactory('Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewogICd1c2Ugc3RyaWN0JzsKCiAgLyoqCiAgICogQXVkaW9CdWZmZXItYmFzZWQgV2F2ZWZvcm1EYXRhIGdlbmVyYXRvcgogICAqCiAgICogQWRhcHRlZCBmcm9tIEJsb2NrRmlsZTo6Q2FsY1N1bW1hcnkgaW4gQXVkYWNpdHksIHdpdGggcGVybWlzc2lvbi4KICAgKiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL2F1ZGFjaXR5L2F1ZGFjaXR5L2Jsb2IvCiAgICogICAxMTA4YzEzNzZjMDkxNjYxNjIzMzVmYWI0NzQzMDA4Y2JhNTdjNGVlL3NyYy9CbG9ja0ZpbGUuY3BwI0wxOTgKICAgKi8KCiAgdmFyIElOVDhfTUFYID0gMTI3OwogIHZhciBJTlQ4X01JTiA9IC0xMjg7CiAgdmFyIElOVDE2X01BWCA9IDMyNzY3OwogIHZhciBJTlQxNl9NSU4gPSAtMzI3Njg7CiAgZnVuY3Rpb24gY2FsY3VsYXRlV2F2ZWZvcm1EYXRhTGVuZ3RoKGF1ZGlvX3NhbXBsZV9jb3VudCwgc2NhbGUpIHsKICAgIHZhciBkYXRhX2xlbmd0aCA9IE1hdGguZmxvb3IoYXVkaW9fc2FtcGxlX2NvdW50IC8gc2NhbGUpOwogICAgdmFyIHNhbXBsZXNfcmVtYWluaW5nID0gYXVkaW9fc2FtcGxlX2NvdW50IC0gZGF0YV9sZW5ndGggKiBzY2FsZTsKICAgIGlmIChzYW1wbGVzX3JlbWFpbmluZyA+IDApIHsKICAgICAgZGF0YV9sZW5ndGgrKzsKICAgIH0KICAgIHJldHVybiBkYXRhX2xlbmd0aDsKICB9CiAgZnVuY3Rpb24gZ2VuZXJhdGVXYXZlZm9ybURhdGEob3B0aW9ucykgewogICAgdmFyIHNjYWxlID0gb3B0aW9ucy5zY2FsZTsKICAgIHZhciBhbXBsaXR1ZGVfc2NhbGUgPSBvcHRpb25zLmFtcGxpdHVkZV9zY2FsZTsKICAgIHZhciBzcGxpdF9jaGFubmVscyA9IG9wdGlvbnMuc3BsaXRfY2hhbm5lbHM7CiAgICB2YXIgbGVuZ3RoID0gb3B0aW9ucy5sZW5ndGg7CiAgICB2YXIgc2FtcGxlX3JhdGUgPSBvcHRpb25zLnNhbXBsZV9yYXRlOwogICAgdmFyIGNoYW5uZWxzID0gb3B0aW9ucy5jaGFubmVscy5tYXAoZnVuY3Rpb24gKGNoYW5uZWwpIHsKICAgICAgcmV0dXJuIG5ldyBGbG9hdDMyQXJyYXkoY2hhbm5lbCk7CiAgICB9KTsKICAgIHZhciBvdXRwdXRfY2hhbm5lbHMgPSBzcGxpdF9jaGFubmVscyA/IGNoYW5uZWxzLmxlbmd0aCA6IDE7CiAgICB2YXIgaGVhZGVyX3NpemUgPSAyNDsKICAgIHZhciBkYXRhX2xlbmd0aCA9IGNhbGN1bGF0ZVdhdmVmb3JtRGF0YUxlbmd0aChsZW5ndGgsIHNjYWxlKTsKICAgIHZhciBieXRlc19wZXJfc2FtcGxlID0gb3B0aW9ucy5iaXRzID09PSA4ID8gMSA6IDI7CiAgICB2YXIgdG90YWxfc2l6ZSA9IGhlYWRlcl9zaXplICsgZGF0YV9sZW5ndGggKiAyICogYnl0ZXNfcGVyX3NhbXBsZSAqIG91dHB1dF9jaGFubmVsczsKICAgIHZhciBidWZmZXIgPSBuZXcgQXJyYXlCdWZmZXIodG90YWxfc2l6ZSk7CiAgICB2YXIgZGF0YV92aWV3ID0gbmV3IERhdGFWaWV3KGJ1ZmZlcik7CiAgICB2YXIgc2NhbGVfY291bnRlciA9IDA7CiAgICB2YXIgb2Zmc2V0ID0gaGVhZGVyX3NpemU7CiAgICB2YXIgbWluX3ZhbHVlID0gbmV3IEFycmF5KG91dHB1dF9jaGFubmVscyk7CiAgICB2YXIgbWF4X3ZhbHVlID0gbmV3IEFycmF5KG91dHB1dF9jaGFubmVscyk7CiAgICBmb3IgKHZhciBjaGFubmVsID0gMDsgY2hhbm5lbCA8IG91dHB1dF9jaGFubmVsczsgY2hhbm5lbCsrKSB7CiAgICAgIG1pbl92YWx1ZVtjaGFubmVsXSA9IEluZmluaXR5OwogICAgICBtYXhfdmFsdWVbY2hhbm5lbF0gPSAtSW5maW5pdHk7CiAgICB9CiAgICB2YXIgcmFuZ2VfbWluID0gb3B0aW9ucy5iaXRzID09PSA4ID8gSU5UOF9NSU4gOiBJTlQxNl9NSU47CiAgICB2YXIgcmFuZ2VfbWF4ID0gb3B0aW9ucy5iaXRzID09PSA4ID8gSU5UOF9NQVggOiBJTlQxNl9NQVg7CiAgICBkYXRhX3ZpZXcuc2V0SW50MzIoMCwgMiwgdHJ1ZSk7IC8vIFZlcnNpb24KICAgIGRhdGFfdmlldy5zZXRVaW50MzIoNCwgb3B0aW9ucy5iaXRzID09PSA4LCB0cnVlKTsgLy8gSXMgOCBiaXQ/CiAgICBkYXRhX3ZpZXcuc2V0SW50MzIoOCwgc2FtcGxlX3JhdGUsIHRydWUpOyAvLyBTYW1wbGUgcmF0ZQogICAgZGF0YV92aWV3LnNldEludDMyKDEyLCBzY2FsZSwgdHJ1ZSk7IC8vIFNjYWxlCiAgICBkYXRhX3ZpZXcuc2V0SW50MzIoMTYsIGRhdGFfbGVuZ3RoLCB0cnVlKTsgLy8gTGVuZ3RoCiAgICBkYXRhX3ZpZXcuc2V0SW50MzIoMjAsIG91dHB1dF9jaGFubmVscywgdHJ1ZSk7CiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgIHZhciBzYW1wbGUgPSAwOwogICAgICBpZiAob3V0cHV0X2NoYW5uZWxzID09PSAxKSB7CiAgICAgICAgZm9yICh2YXIgX2NoYW5uZWwgPSAwOyBfY2hhbm5lbCA8IGNoYW5uZWxzLmxlbmd0aDsgKytfY2hhbm5lbCkgewogICAgICAgICAgc2FtcGxlICs9IGNoYW5uZWxzW19jaGFubmVsXVtpXTsKICAgICAgICB9CiAgICAgICAgc2FtcGxlID0gTWF0aC5mbG9vcihyYW5nZV9tYXggKiBzYW1wbGUgKiBhbXBsaXR1ZGVfc2NhbGUgLyBjaGFubmVscy5sZW5ndGgpOwogICAgICAgIGlmIChzYW1wbGUgPCBtaW5fdmFsdWVbMF0pIHsKICAgICAgICAgIG1pbl92YWx1ZVswXSA9IHNhbXBsZTsKICAgICAgICAgIGlmIChtaW5fdmFsdWVbMF0gPCByYW5nZV9taW4pIHsKICAgICAgICAgICAgbWluX3ZhbHVlWzBdID0gcmFuZ2VfbWluOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAoc2FtcGxlID4gbWF4X3ZhbHVlWzBdKSB7CiAgICAgICAgICBtYXhfdmFsdWVbMF0gPSBzYW1wbGU7CiAgICAgICAgICBpZiAobWF4X3ZhbHVlWzBdID4gcmFuZ2VfbWF4KSB7CiAgICAgICAgICAgIG1heF92YWx1ZVswXSA9IHJhbmdlX21heDsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZm9yICh2YXIgX2NoYW5uZWwyID0gMDsgX2NoYW5uZWwyIDwgb3V0cHV0X2NoYW5uZWxzOyArK19jaGFubmVsMikgewogICAgICAgICAgc2FtcGxlID0gTWF0aC5mbG9vcihyYW5nZV9tYXggKiBjaGFubmVsc1tfY2hhbm5lbDJdW2ldICogYW1wbGl0dWRlX3NjYWxlKTsKICAgICAgICAgIGlmIChzYW1wbGUgPCBtaW5fdmFsdWVbX2NoYW5uZWwyXSkgewogICAgICAgICAgICBtaW5fdmFsdWVbX2NoYW5uZWwyXSA9IHNhbXBsZTsKICAgICAgICAgICAgaWYgKG1pbl92YWx1ZVtfY2hhbm5lbDJdIDwgcmFuZ2VfbWluKSB7CiAgICAgICAgICAgICAgbWluX3ZhbHVlW19jaGFubmVsMl0gPSByYW5nZV9taW47CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIGlmIChzYW1wbGUgPiBtYXhfdmFsdWVbX2NoYW5uZWwyXSkgewogICAgICAgICAgICBtYXhfdmFsdWVbX2NoYW5uZWwyXSA9IHNhbXBsZTsKICAgICAgICAgICAgaWYgKG1heF92YWx1ZVtfY2hhbm5lbDJdID4gcmFuZ2VfbWF4KSB7CiAgICAgICAgICAgICAgbWF4X3ZhbHVlW19jaGFubmVsMl0gPSByYW5nZV9tYXg7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKCsrc2NhbGVfY291bnRlciA9PT0gc2NhbGUpIHsKICAgICAgICBmb3IgKHZhciBfY2hhbm5lbDMgPSAwOyBfY2hhbm5lbDMgPCBvdXRwdXRfY2hhbm5lbHM7IF9jaGFubmVsMysrKSB7CiAgICAgICAgICBpZiAob3B0aW9ucy5iaXRzID09PSA4KSB7CiAgICAgICAgICAgIGRhdGFfdmlldy5zZXRJbnQ4KG9mZnNldCsrLCBtaW5fdmFsdWVbX2NoYW5uZWwzXSk7CiAgICAgICAgICAgIGRhdGFfdmlldy5zZXRJbnQ4KG9mZnNldCsrLCBtYXhfdmFsdWVbX2NoYW5uZWwzXSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBkYXRhX3ZpZXcuc2V0SW50MTYob2Zmc2V0LCBtaW5fdmFsdWVbX2NoYW5uZWwzXSwgdHJ1ZSk7CiAgICAgICAgICAgIGRhdGFfdmlldy5zZXRJbnQxNihvZmZzZXQgKyAyLCBtYXhfdmFsdWVbX2NoYW5uZWwzXSwgdHJ1ZSk7CiAgICAgICAgICAgIG9mZnNldCArPSA0OwogICAgICAgICAgfQogICAgICAgICAgbWluX3ZhbHVlW19jaGFubmVsM10gPSBJbmZpbml0eTsKICAgICAgICAgIG1heF92YWx1ZVtfY2hhbm5lbDNdID0gLUluZmluaXR5OwogICAgICAgIH0KICAgICAgICBzY2FsZV9jb3VudGVyID0gMDsKICAgICAgfQogICAgfQogICAgaWYgKHNjYWxlX2NvdW50ZXIgPiAwKSB7CiAgICAgIGZvciAodmFyIF9jaGFubmVsNCA9IDA7IF9jaGFubmVsNCA8IG91dHB1dF9jaGFubmVsczsgX2NoYW5uZWw0KyspIHsKICAgICAgICBpZiAob3B0aW9ucy5iaXRzID09PSA4KSB7CiAgICAgICAgICBkYXRhX3ZpZXcuc2V0SW50OChvZmZzZXQrKywgbWluX3ZhbHVlW19jaGFubmVsNF0pOwogICAgICAgICAgZGF0YV92aWV3LnNldEludDgob2Zmc2V0KyssIG1heF92YWx1ZVtfY2hhbm5lbDRdKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgZGF0YV92aWV3LnNldEludDE2KG9mZnNldCwgbWluX3ZhbHVlW19jaGFubmVsNF0sIHRydWUpOwogICAgICAgICAgZGF0YV92aWV3LnNldEludDE2KG9mZnNldCArIDIsIG1heF92YWx1ZVtfY2hhbm5lbDRdLCB0cnVlKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIHJldHVybiBidWZmZXI7CiAgfQoKICBvbm1lc3NhZ2UgPSBmdW5jdGlvbiBvbm1lc3NhZ2UoZXZ0KSB7CiAgICB2YXIgYnVmZmVyID0gZ2VuZXJhdGVXYXZlZm9ybURhdGEoZXZ0LmRhdGEpOwoKICAgIC8vIFRyYW5zZmVyIGJ1ZmZlciB0byB0aGUgY2FsbGluZyB0aHJlYWQKICAgIHRoaXMucG9zdE1lc3NhZ2UoYnVmZmVyLCBbYnVmZmVyXSk7CiAgICB0aGlzLmNsb3NlKCk7CiAgfTsKCn0pKCk7Ci8vIyBzb3VyY2VNYXBwaW5nVVJMPXdhdmVmb3JtLWRhdGEtd29ya2VyLmpzLm1hcAoK', null, false);\n/* eslint-enable */\n\n/**\n * Provides access to waveform data.\n */\n\nfunction WaveformData(data) {\n  if (isJsonWaveformData(data)) {\n    data = convertJsonToBinary(data);\n  }\n  if (isBinaryWaveformData(data)) {\n    this._data = new DataView(data);\n    this._offset = this._version() === 2 ? 24 : 20;\n    this._channels = [];\n    for (var channel = 0; channel < this.channels; channel++) {\n      this._channels[channel] = new WaveformDataChannel(this, channel);\n    }\n  } else {\n    throw new TypeError('WaveformData.create(): Unknown data format');\n  }\n}\nvar defaultOptions = {\n  scale: 512,\n  bits: 8,\n  amplitude_scale: 1.0,\n  split_channels: false,\n  disable_worker: false\n};\nfunction getOptions(options) {\n  var opts = {\n    scale: options.scale || defaultOptions.scale,\n    bits: options.bits || defaultOptions.bits,\n    amplitude_scale: options.amplitude_scale || defaultOptions.amplitude_scale,\n    split_channels: options.split_channels || defaultOptions.split_channels,\n    disable_worker: options.disable_worker || defaultOptions.disable_worker\n  };\n  return opts;\n}\nfunction getChannelData(audio_buffer) {\n  var channels = [];\n  for (var i = 0; i < audio_buffer.numberOfChannels; ++i) {\n    channels.push(audio_buffer.getChannelData(i).buffer);\n  }\n  return channels;\n}\nfunction createFromAudioBuffer(audio_buffer, options, callback) {\n  var channels = getChannelData(audio_buffer);\n  if (options.disable_worker) {\n    var buffer = generateWaveformData({\n      scale: options.scale,\n      bits: options.bits,\n      amplitude_scale: options.amplitude_scale,\n      split_channels: options.split_channels,\n      length: audio_buffer.length,\n      sample_rate: audio_buffer.sampleRate,\n      channels: channels\n    });\n    callback(undefined, new WaveformData(buffer), audio_buffer);\n  } else {\n    var worker = new WorkerFactory();\n    worker.onmessage = function (evt) {\n      callback(undefined, new WaveformData(evt.data), audio_buffer);\n    };\n    worker.postMessage({\n      scale: options.scale,\n      bits: options.bits,\n      amplitude_scale: options.amplitude_scale,\n      split_channels: options.split_channels,\n      length: audio_buffer.length,\n      sample_rate: audio_buffer.sampleRate,\n      channels: channels\n    }, channels);\n  }\n}\nfunction createFromArrayBuffer(audioContext, audioData, options, callback) {\n  // The following function is a workaround for a Webkit bug where decodeAudioData\n  // invokes the errorCallback with null instead of a DOMException.\n  // See https://webaudio.github.io/web-audio-api/#dom-baseaudiocontext-decodeaudiodata\n  // and http://stackoverflow.com/q/10365335/103396\n\n  function errorCallback(error) {\n    if (!error) {\n      error = new DOMException('EncodingError');\n    }\n    callback(error);\n    // prevent double-calling the callback on errors:\n    callback = function callback() {};\n  }\n  var promise = audioContext.decodeAudioData(audioData, function (audio_buffer) {\n    createFromAudioBuffer(audio_buffer, options, callback);\n  }, errorCallback);\n  if (promise) {\n    promise.catch(errorCallback);\n  }\n}\n\n/**\n * Creates and returns a WaveformData instance from the given waveform data.\n */\n\nWaveformData.create = function create(data) {\n  return new WaveformData(data);\n};\n\n/**\n * Creates a WaveformData instance from audio.\n */\n\nWaveformData.createFromAudio = function (options, callback) {\n  var opts = getOptions(options);\n  if (options.audio_context && options.array_buffer) {\n    return createFromArrayBuffer(options.audio_context, options.array_buffer, opts, callback);\n  } else if (options.audio_buffer) {\n    return createFromAudioBuffer(options.audio_buffer, opts, callback);\n  } else {\n    throw new TypeError(\n    // eslint-disable-next-line\n    'WaveformData.createFromAudio(): Pass either an AudioContext and ArrayBuffer, or an AudioBuffer object');\n  }\n};\nfunction WaveformResampler(options) {\n  this._inputData = options.waveformData;\n\n  // Scale we want to reach\n  this._output_samples_per_pixel = options.scale;\n  this._scale = this._inputData.scale; // scale we are coming from\n\n  // The amount of data we want to resample i.e. final zoom want to resample\n  // all data but for intermediate zoom we want to resample subset\n  this._input_buffer_size = this._inputData.length;\n  var input_buffer_length_samples = this._input_buffer_size * this._inputData.scale;\n  var output_buffer_length_samples = Math.ceil(input_buffer_length_samples / this._output_samples_per_pixel);\n  var output_header_size = 24; // version 2\n  var bytes_per_sample = this._inputData.bits === 8 ? 1 : 2;\n  var total_size = output_header_size + output_buffer_length_samples * 2 * this._inputData.channels * bytes_per_sample;\n  this._output_data = new ArrayBuffer(total_size);\n  this.output_dataview = new DataView(this._output_data);\n  this.output_dataview.setInt32(0, 2, true); // Version\n  this.output_dataview.setUint32(4, this._inputData.bits === 8, true); // Is 8 bit?\n  this.output_dataview.setInt32(8, this._inputData.sample_rate, true);\n  this.output_dataview.setInt32(12, this._output_samples_per_pixel, true);\n  this.output_dataview.setInt32(16, output_buffer_length_samples, true);\n  this.output_dataview.setInt32(20, this._inputData.channels, true);\n  this._outputWaveformData = new WaveformData(this._output_data);\n  this._input_index = 0;\n  this._output_index = 0;\n  var channels = this._inputData.channels;\n  this._min = new Array(channels);\n  this._max = new Array(channels);\n  for (var channel = 0; channel < channels; ++channel) {\n    if (this._input_buffer_size > 0) {\n      this._min[channel] = this._inputData.channel(channel).min_sample(this._input_index);\n      this._max[channel] = this._inputData.channel(channel).max_sample(this._input_index);\n    } else {\n      this._min[channel] = 0;\n      this._max[channel] = 0;\n    }\n  }\n  this._min_value = this._inputData.bits === 8 ? -128 : -32768;\n  this._max_value = this._inputData.bits === 8 ? 127 : 32767;\n  this._where = 0;\n  this._prev_where = 0;\n  this._stop = 0;\n  this._last_input_index = 0;\n}\nWaveformResampler.prototype.sample_at_pixel = function (x) {\n  return Math.floor(x * this._output_samples_per_pixel);\n};\nWaveformResampler.prototype.next = function () {\n  var count = 0;\n  var total = 1000;\n  var channels = this._inputData.channels;\n  var channel;\n  while (this._input_index < this._input_buffer_size && count < total) {\n    while (Math.floor(this.sample_at_pixel(this._output_index) / this._scale) === this._input_index) {\n      if (this._output_index > 0) {\n        for (var i = 0; i < channels; ++i) {\n          channel = this._outputWaveformData.channel(i);\n          channel.set_min_sample(this._output_index - 1, this._min[i]);\n          channel.set_max_sample(this._output_index - 1, this._max[i]);\n        }\n      }\n      this._last_input_index = this._input_index;\n      this._output_index++;\n      this._where = this.sample_at_pixel(this._output_index);\n      this._prev_where = this.sample_at_pixel(this._output_index - 1);\n      if (this._where !== this._prev_where) {\n        for (var _i = 0; _i < channels; ++_i) {\n          this._min[_i] = this._max_value;\n          this._max[_i] = this._min_value;\n        }\n      }\n    }\n    this._where = this.sample_at_pixel(this._output_index);\n    this._stop = Math.floor(this._where / this._scale);\n    if (this._stop > this._input_buffer_size) {\n      this._stop = this._input_buffer_size;\n    }\n    while (this._input_index < this._stop) {\n      for (var _i2 = 0; _i2 < channels; ++_i2) {\n        channel = this._inputData.channel(_i2);\n        var value = channel.min_sample(this._input_index);\n        if (value < this._min[_i2]) {\n          this._min[_i2] = value;\n        }\n        value = channel.max_sample(this._input_index);\n        if (value > this._max[_i2]) {\n          this._max[_i2] = value;\n        }\n      }\n      this._input_index++;\n    }\n    count++;\n  }\n  if (this._input_index < this._input_buffer_size) {\n    // More to do\n    return false;\n  } else {\n    // Done\n    if (this._input_index !== this._last_input_index) {\n      for (var _i3 = 0; _i3 < channels; ++_i3) {\n        channel = this._outputWaveformData.channel(_i3);\n        channel.set_min_sample(this._output_index - 1, this._min[_i3]);\n        channel.set_max_sample(this._output_index - 1, this._max[_i3]);\n      }\n    }\n    return true;\n  }\n};\nWaveformResampler.prototype.getOutputData = function () {\n  return this._output_data;\n};\nWaveformData.prototype = {\n  _getResampleOptions: function _getResampleOptions(options) {\n    var opts = {};\n    opts.scale = options.scale;\n    opts.width = options.width;\n    if (!isNullOrUndefined(opts.width) && (typeof opts.width !== 'number' || opts.width <= 0)) {\n      throw new RangeError('WaveformData.resample(): width should be a positive integer value');\n    }\n    if (!isNullOrUndefined(opts.scale) && (typeof opts.scale !== 'number' || opts.scale <= 0)) {\n      throw new RangeError('WaveformData.resample(): scale should be a positive integer value');\n    }\n    if (!opts.scale && !opts.width) {\n      throw new Error('WaveformData.resample(): Missing scale or width option');\n    }\n    if (opts.width) {\n      // Calculate the target scale for the resampled waveform\n      opts.scale = Math.floor(this.duration * this.sample_rate / opts.width);\n    }\n    if (opts.scale < this.scale) {\n      throw new Error('WaveformData.resample(): Zoom level ' + opts.scale + ' too low, minimum: ' + this.scale);\n    }\n    opts.abortSignal = options.abortSignal;\n    return opts;\n  },\n  resample: function resample(options) {\n    options = this._getResampleOptions(options);\n    options.waveformData = this;\n    var resampler = new WaveformResampler(options);\n    while (!resampler.next()) {\n      // nothing\n    }\n    return new WaveformData(resampler.getOutputData());\n  },\n  /**\n   * Concatenates with one or more other waveforms, returning a new WaveformData object.\n   */\n\n  concat: function concat() {\n    var self = this;\n    var otherWaveforms = Array.prototype.slice.call(arguments);\n\n    // Check that all the supplied waveforms are compatible\n    otherWaveforms.forEach(function (otherWaveform) {\n      if (self.channels !== otherWaveform.channels || self.sample_rate !== otherWaveform.sample_rate || self.bits !== otherWaveform.bits || self.scale !== otherWaveform.scale) {\n        throw new Error('WaveformData.concat(): Waveforms are incompatible');\n      }\n    });\n    var combinedBuffer = this._concatBuffers.apply(this, otherWaveforms);\n    return WaveformData.create(combinedBuffer);\n  },\n  /**\n   * Returns a new ArrayBuffer with the concatenated waveform.\n   * All waveforms must have identical metadata (version, channels, etc)\n   */\n\n  _concatBuffers: function _concatBuffers() {\n    var otherWaveforms = Array.prototype.slice.call(arguments);\n    var headerSize = this._offset;\n    var totalSize = headerSize;\n    var totalDataLength = 0;\n    var bufferCollection = [this].concat(otherWaveforms).map(function (w) {\n      return w._data.buffer;\n    });\n    for (var i = 0; i < bufferCollection.length; i++) {\n      var buffer = bufferCollection[i];\n      var dataSize = new DataView(buffer).getInt32(16, true);\n      totalSize += buffer.byteLength - headerSize;\n      totalDataLength += dataSize;\n    }\n    var totalBuffer = new ArrayBuffer(totalSize);\n    var sourceHeader = new DataView(bufferCollection[0]);\n    var totalBufferView = new DataView(totalBuffer);\n\n    // Copy the header from the first chunk\n    for (var _i4 = 0; _i4 < headerSize; _i4++) {\n      totalBufferView.setUint8(_i4, sourceHeader.getUint8(_i4));\n    }\n\n    // Rewrite the data-length header item to reflect all of the samples concatenated together\n    totalBufferView.setInt32(16, totalDataLength, true);\n    var offset = 0;\n    var dataOfTotalBuffer = new Uint8Array(totalBuffer, headerSize);\n    for (var _i5 = 0; _i5 < bufferCollection.length; _i5++) {\n      var _buffer = bufferCollection[_i5];\n      dataOfTotalBuffer.set(new Uint8Array(_buffer, headerSize), offset);\n      offset += _buffer.byteLength - headerSize;\n    }\n    return totalBuffer;\n  },\n  slice: function slice(options) {\n    var startIndex = 0;\n    var endIndex = 0;\n    if (!isNullOrUndefined(options.startIndex) && !isNullOrUndefined(options.endIndex)) {\n      startIndex = options.startIndex;\n      endIndex = options.endIndex;\n    } else if (!isNullOrUndefined(options.startTime) && !isNullOrUndefined(options.endTime)) {\n      startIndex = this.at_time(options.startTime);\n      endIndex = this.at_time(options.endTime);\n    }\n    if (startIndex < 0) {\n      throw new RangeError('startIndex or startTime must not be negative');\n    }\n    if (endIndex < 0) {\n      throw new RangeError('endIndex or endTime must not be negative');\n    }\n    if (startIndex > this.length) {\n      startIndex = this.length;\n    }\n    if (endIndex > this.length) {\n      endIndex = this.length;\n    }\n    if (startIndex > endIndex) {\n      startIndex = endIndex;\n    }\n    var length = endIndex - startIndex;\n    var header_size = 24; // Version 2\n    var bytes_per_sample = this.bits === 8 ? 1 : 2;\n    var total_size = header_size + length * 2 * this.channels * bytes_per_sample;\n    var output_data = new ArrayBuffer(total_size);\n    var output_dataview = new DataView(output_data);\n    output_dataview.setInt32(0, 2, true); // Version\n    output_dataview.setUint32(4, this.bits === 8, true); // Is 8 bit?\n    output_dataview.setInt32(8, this.sample_rate, true);\n    output_dataview.setInt32(12, this.scale, true);\n    output_dataview.setInt32(16, length, true);\n    output_dataview.setInt32(20, this.channels, true);\n    for (var i = 0; i < length * this.channels * 2; i++) {\n      var sample = this._at(startIndex * this.channels * 2 + i);\n      if (this.bits === 8) {\n        output_dataview.setInt8(header_size + i, sample);\n      } else {\n        output_dataview.setInt16(header_size + i * 2, sample, true);\n      }\n    }\n    return new WaveformData(output_data);\n  },\n  /**\n   * Returns the data format version number.\n   */\n\n  _version: function _version() {\n    return this._data.getInt32(0, true);\n  },\n  /**\n   * Returns the length of the waveform, in pixels.\n   */\n\n  get length() {\n    return this._data.getUint32(16, true);\n  },\n  /**\n   * Returns the number of bits per sample, either 8 or 16.\n   */\n\n  get bits() {\n    var bits = Boolean(this._data.getUint32(4, true));\n    return bits ? 8 : 16;\n  },\n  /**\n   * Returns the (approximate) duration of the audio file, in seconds.\n   */\n\n  get duration() {\n    return this.length * this.scale / this.sample_rate;\n  },\n  /**\n   * Returns the number of pixels per second.\n   */\n\n  get pixels_per_second() {\n    return this.sample_rate / this.scale;\n  },\n  /**\n   * Returns the amount of time represented by a single pixel, in seconds.\n   */\n\n  get seconds_per_pixel() {\n    return this.scale / this.sample_rate;\n  },\n  /**\n   * Returns the number of waveform channels.\n   */\n\n  get channels() {\n    if (this._version() === 2) {\n      return this._data.getInt32(20, true);\n    } else {\n      return 1;\n    }\n  },\n  /**\n   * Returns a waveform channel.\n   */\n\n  channel: function channel(index) {\n    if (index >= 0 && index < this._channels.length) {\n      return this._channels[index];\n    } else {\n      throw new RangeError('Invalid channel: ' + index);\n    }\n  },\n  /**\n   * Returns the number of audio samples per second.\n   */\n\n  get sample_rate() {\n    return this._data.getInt32(8, true);\n  },\n  /**\n   * Returns the number of audio samples per pixel.\n   */\n\n  get scale() {\n    return this._data.getInt32(12, true);\n  },\n  /**\n   * Returns a waveform data value at a specific offset.\n   */\n\n  _at: function at_sample(index) {\n    if (this.bits === 8) {\n      return this._data.getInt8(this._offset + index);\n    } else {\n      return this._data.getInt16(this._offset + index * 2, true);\n    }\n  },\n  /**\n   * Sets a waveform data value at a specific offset.\n   */\n\n  _set_at: function set_at(index, sample) {\n    if (this.bits === 8) {\n      return this._data.setInt8(this._offset + index, sample);\n    } else {\n      return this._data.setInt16(this._offset + index * 2, sample, true);\n    }\n  },\n  /**\n   * Returns the waveform data index position for a given time.\n   */\n\n  at_time: function at_time(time) {\n    return Math.floor(time * this.sample_rate / this.scale);\n  },\n  /**\n   * Returns the time in seconds for a given index.\n   */\n\n  time: function time(index) {\n    return index * this.scale / this.sample_rate;\n  },\n  /**\n   * Returns an object containing the waveform data.\n   */\n\n  toJSON: function toJSON() {\n    var waveform = {\n      version: 2,\n      channels: this.channels,\n      sample_rate: this.sample_rate,\n      samples_per_pixel: this.scale,\n      bits: this.bits,\n      length: this.length,\n      data: []\n    };\n    for (var i = 0; i < this.length; i++) {\n      for (var channel = 0; channel < this.channels; channel++) {\n        waveform.data.push(this.channel(channel).min_sample(i));\n        waveform.data.push(this.channel(channel).max_sample(i));\n      }\n    }\n    return waveform;\n  },\n  /**\n   * Returns the waveform data in binary format as an ArrayBuffer.\n   */\n\n  toArrayBuffer: function toArrayBuffer() {\n    return this._data.buffer;\n  }\n};\n\nexport { WaveformData as default };\n", "import Konva from 'konva/lib/Core';\nimport { Line } from 'konva/lib/shapes/Line';\nimport { Rect } from 'konva/lib/shapes/Rect';\nimport { Text } from 'konva/lib/shapes/Text';\nimport { Animation } from 'konva/lib/Animation';\nimport WaveformData from 'waveform-data';\n\nfunction getDefaultExportFromCjs (x) {\n\treturn x && x.__esModule && Object.prototype.hasOwnProperty.call(x, 'default') ? x['default'] : x;\n}\n\nvar eventemitter3 = {exports: {}};\n\nvar hasRequiredEventemitter3;\nfunction requireEventemitter3() {\n  if (hasRequiredEventemitter3) return eventemitter3.exports;\n  hasRequiredEventemitter3 = 1;\n  (function (module) {\n\n    var has = Object.prototype.hasOwnProperty,\n      prefix = '~';\n\n    /**\n     * Constructor to create a storage for our `EE` objects.\n     * An `Events` instance is a plain object whose properties are event names.\n     *\n     * @constructor\n     * @private\n     */\n    function Events() {}\n\n    //\n    // We try to not inherit from `Object.prototype`. In some engines creating an\n    // instance in this way is faster than calling `Object.create(null)` directly.\n    // If `Object.create(null)` is not supported we prefix the event names with a\n    // character to make sure that the built-in object properties are not\n    // overridden or used as an attack vector.\n    //\n    if (Object.create) {\n      Events.prototype = Object.create(null);\n\n      //\n      // This hack is needed because the `__proto__` property is still inherited in\n      // some old browsers like Android 4, iPhone 5.1, Opera 11 and Safari 5.\n      //\n      if (!new Events().__proto__) prefix = false;\n    }\n\n    /**\n     * Representation of a single event listener.\n     *\n     * @param {Function} fn The listener function.\n     * @param {*} context The context to invoke the listener with.\n     * @param {Boolean} [once=false] Specify if the listener is a one-time listener.\n     * @constructor\n     * @private\n     */\n    function EE(fn, context, once) {\n      this.fn = fn;\n      this.context = context;\n      this.once = once || false;\n    }\n\n    /**\n     * Add a listener for a given event.\n     *\n     * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n     * @param {(String|Symbol)} event The event name.\n     * @param {Function} fn The listener function.\n     * @param {*} context The context to invoke the listener with.\n     * @param {Boolean} once Specify if the listener is a one-time listener.\n     * @returns {EventEmitter}\n     * @private\n     */\n    function addListener(emitter, event, fn, context, once) {\n      if (typeof fn !== 'function') {\n        throw new TypeError('The listener must be a function');\n      }\n      var listener = new EE(fn, context || emitter, once),\n        evt = prefix ? prefix + event : event;\n      if (!emitter._events[evt]) emitter._events[evt] = listener, emitter._eventsCount++;else if (!emitter._events[evt].fn) emitter._events[evt].push(listener);else emitter._events[evt] = [emitter._events[evt], listener];\n      return emitter;\n    }\n\n    /**\n     * Clear event by name.\n     *\n     * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n     * @param {(String|Symbol)} evt The Event name.\n     * @private\n     */\n    function clearEvent(emitter, evt) {\n      if (--emitter._eventsCount === 0) emitter._events = new Events();else delete emitter._events[evt];\n    }\n\n    /**\n     * Minimal `EventEmitter` interface that is molded against the Node.js\n     * `EventEmitter` interface.\n     *\n     * @constructor\n     * @public\n     */\n    function EventEmitter() {\n      this._events = new Events();\n      this._eventsCount = 0;\n    }\n\n    /**\n     * Return an array listing the events for which the emitter has registered\n     * listeners.\n     *\n     * @returns {Array}\n     * @public\n     */\n    EventEmitter.prototype.eventNames = function eventNames() {\n      var names = [],\n        events,\n        name;\n      if (this._eventsCount === 0) return names;\n      for (name in events = this._events) {\n        if (has.call(events, name)) names.push(prefix ? name.slice(1) : name);\n      }\n      if (Object.getOwnPropertySymbols) {\n        return names.concat(Object.getOwnPropertySymbols(events));\n      }\n      return names;\n    };\n\n    /**\n     * Return the listeners registered for a given event.\n     *\n     * @param {(String|Symbol)} event The event name.\n     * @returns {Array} The registered listeners.\n     * @public\n     */\n    EventEmitter.prototype.listeners = function listeners(event) {\n      var evt = prefix ? prefix + event : event,\n        handlers = this._events[evt];\n      if (!handlers) return [];\n      if (handlers.fn) return [handlers.fn];\n      for (var i = 0, l = handlers.length, ee = new Array(l); i < l; i++) {\n        ee[i] = handlers[i].fn;\n      }\n      return ee;\n    };\n\n    /**\n     * Return the number of listeners listening to a given event.\n     *\n     * @param {(String|Symbol)} event The event name.\n     * @returns {Number} The number of listeners.\n     * @public\n     */\n    EventEmitter.prototype.listenerCount = function listenerCount(event) {\n      var evt = prefix ? prefix + event : event,\n        listeners = this._events[evt];\n      if (!listeners) return 0;\n      if (listeners.fn) return 1;\n      return listeners.length;\n    };\n\n    /**\n     * Calls each of the listeners registered for a given event.\n     *\n     * @param {(String|Symbol)} event The event name.\n     * @returns {Boolean} `true` if the event had listeners, else `false`.\n     * @public\n     */\n    EventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\n      var evt = prefix ? prefix + event : event;\n      if (!this._events[evt]) return false;\n      var listeners = this._events[evt],\n        len = arguments.length,\n        args,\n        i;\n      if (listeners.fn) {\n        if (listeners.once) this.removeListener(event, listeners.fn, undefined, true);\n        switch (len) {\n          case 1:\n            return listeners.fn.call(listeners.context), true;\n          case 2:\n            return listeners.fn.call(listeners.context, a1), true;\n          case 3:\n            return listeners.fn.call(listeners.context, a1, a2), true;\n          case 4:\n            return listeners.fn.call(listeners.context, a1, a2, a3), true;\n          case 5:\n            return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;\n          case 6:\n            return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;\n        }\n        for (i = 1, args = new Array(len - 1); i < len; i++) {\n          args[i - 1] = arguments[i];\n        }\n        listeners.fn.apply(listeners.context, args);\n      } else {\n        var length = listeners.length,\n          j;\n        for (i = 0; i < length; i++) {\n          if (listeners[i].once) this.removeListener(event, listeners[i].fn, undefined, true);\n          switch (len) {\n            case 1:\n              listeners[i].fn.call(listeners[i].context);\n              break;\n            case 2:\n              listeners[i].fn.call(listeners[i].context, a1);\n              break;\n            case 3:\n              listeners[i].fn.call(listeners[i].context, a1, a2);\n              break;\n            case 4:\n              listeners[i].fn.call(listeners[i].context, a1, a2, a3);\n              break;\n            default:\n              if (!args) for (j = 1, args = new Array(len - 1); j < len; j++) {\n                args[j - 1] = arguments[j];\n              }\n              listeners[i].fn.apply(listeners[i].context, args);\n          }\n        }\n      }\n      return true;\n    };\n\n    /**\n     * Add a listener for a given event.\n     *\n     * @param {(String|Symbol)} event The event name.\n     * @param {Function} fn The listener function.\n     * @param {*} [context=this] The context to invoke the listener with.\n     * @returns {EventEmitter} `this`.\n     * @public\n     */\n    EventEmitter.prototype.on = function on(event, fn, context) {\n      return addListener(this, event, fn, context, false);\n    };\n\n    /**\n     * Add a one-time listener for a given event.\n     *\n     * @param {(String|Symbol)} event The event name.\n     * @param {Function} fn The listener function.\n     * @param {*} [context=this] The context to invoke the listener with.\n     * @returns {EventEmitter} `this`.\n     * @public\n     */\n    EventEmitter.prototype.once = function once(event, fn, context) {\n      return addListener(this, event, fn, context, true);\n    };\n\n    /**\n     * Remove the listeners of a given event.\n     *\n     * @param {(String|Symbol)} event The event name.\n     * @param {Function} fn Only remove the listeners that match this function.\n     * @param {*} context Only remove the listeners that have this context.\n     * @param {Boolean} once Only remove one-time listeners.\n     * @returns {EventEmitter} `this`.\n     * @public\n     */\n    EventEmitter.prototype.removeListener = function removeListener(event, fn, context, once) {\n      var evt = prefix ? prefix + event : event;\n      if (!this._events[evt]) return this;\n      if (!fn) {\n        clearEvent(this, evt);\n        return this;\n      }\n      var listeners = this._events[evt];\n      if (listeners.fn) {\n        if (listeners.fn === fn && (!once || listeners.once) && (!context || listeners.context === context)) {\n          clearEvent(this, evt);\n        }\n      } else {\n        for (var i = 0, events = [], length = listeners.length; i < length; i++) {\n          if (listeners[i].fn !== fn || once && !listeners[i].once || context && listeners[i].context !== context) {\n            events.push(listeners[i]);\n          }\n        }\n\n        //\n        // Reset the array, or remove it completely if we have no more listeners.\n        //\n        if (events.length) this._events[evt] = events.length === 1 ? events[0] : events;else clearEvent(this, evt);\n      }\n      return this;\n    };\n\n    /**\n     * Remove all listeners, or those of the specified event.\n     *\n     * @param {(String|Symbol)} [event] The event name.\n     * @returns {EventEmitter} `this`.\n     * @public\n     */\n    EventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {\n      var evt;\n      if (event) {\n        evt = prefix ? prefix + event : event;\n        if (this._events[evt]) clearEvent(this, evt);\n      } else {\n        this._events = new Events();\n        this._eventsCount = 0;\n      }\n      return this;\n    };\n\n    //\n    // Alias methods names because people roll like that.\n    //\n    EventEmitter.prototype.off = EventEmitter.prototype.removeListener;\n    EventEmitter.prototype.addListener = EventEmitter.prototype.on;\n\n    //\n    // Expose the prefix.\n    //\n    EventEmitter.prefixed = prefix;\n\n    //\n    // Allow `EventEmitter` to be imported as module namespace.\n    //\n    EventEmitter.EventEmitter = EventEmitter;\n\n    //\n    // Expose the module.\n    //\n    {\n      module.exports = EventEmitter;\n    }\n  })(eventemitter3);\n  return eventemitter3.exports;\n}\n\nvar eventemitter3Exports = requireEventemitter3();\nvar EventEmitter = /*@__PURE__*/getDefaultExportFromCjs(eventemitter3Exports);\n\nfunction _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, _typeof(o);\n}\n\n/**\n * @file\n *\n * Defines the {@link Cue} class.\n *\n * @module cue\n */\n\n/**\n * A cue represents an event to be triggered at some point on the media\n * timeline.\n *\n * @class\n * @alias Cue\n *\n * @param {Number} time Cue time, in seconds.\n * @param {Number} type Cue mark type, either <code>Cue.POINT</code>,\n *   <code>Cue.SEGMENT_START</code>, or <code>Cue.SEGMENT_END</code>.\n * @param {String} id The id of the {@link Point} or {@link Segment}.\n */\n\nfunction Cue(time, type, id) {\n  this.time = time;\n  this.type = type;\n  this.id = id;\n}\n\n/**\n  * @constant\n  * @type {Number}\n  */\n\nCue.POINT = 0;\nCue.SEGMENT_START = 1;\nCue.SEGMENT_END = 2;\n\n/**\n * Callback function for use with Array.prototype.sort().\n *\n * @static\n * @param {Cue} a\n * @param {Cue} b\n * @return {Number}\n */\n\nCue.sorter = function (a, b) {\n  return a.time - b.time;\n};\n\nfunction zeroPad(number, precision) {\n  number = number.toString();\n  while (number.length < precision) {\n    number = '0' + number;\n  }\n  return number;\n}\n\n/**\n * Returns a formatted time string.\n *\n * @param {Number} time The time to be formatted, in seconds.\n * @param {Number} precision Decimal places to which time is displayed\n * @returns {String}\n */\n\nfunction formatTime(time, precision) {\n  var result = [];\n  var fractionSeconds = Math.floor(time % 1 * Math.pow(10, precision));\n  var seconds = Math.floor(time);\n  var minutes = Math.floor(seconds / 60);\n  var hours = Math.floor(minutes / 60);\n  if (hours > 0) {\n    result.push(hours); // Hours\n  }\n  result.push(minutes % 60); // Mins\n  result.push(seconds % 60); // Seconds\n\n  for (var i = 0; i < result.length; i++) {\n    result[i] = zeroPad(result[i], 2);\n  }\n  result = result.join(':');\n  if (precision > 0) {\n    result += '.' + zeroPad(fractionSeconds, precision);\n  }\n  return result;\n}\n\n/**\n * Rounds the given value up to the nearest given multiple.\n *\n * @param {Number} value\n * @param {Number} multiple\n * @returns {Number}\n *\n * @example\n * roundUpToNearest(5.5, 3); // returns 6\n * roundUpToNearest(141.0, 10); // returns 150\n * roundUpToNearest(-5.5, 3); // returns -6\n */\n\nfunction roundUpToNearest(value, multiple) {\n  if (multiple === 0) {\n    return 0;\n  }\n  var multiplier = 1;\n  if (value < 0.0) {\n    multiplier = -1;\n    value = -value;\n  }\n  var roundedUp = Math.ceil(value);\n  return multiplier * ((roundedUp + multiple - 1) / multiple | 0) * multiple;\n}\nfunction clamp(value, min, max) {\n  if (value < min) {\n    return min;\n  } else if (value > max) {\n    return max;\n  } else {\n    return value;\n  }\n}\nfunction objectHasProperty(object, field) {\n  return Object.prototype.hasOwnProperty.call(object, field);\n}\nfunction extend(to, from) {\n  for (var key in from) {\n    if (objectHasProperty(from, key)) {\n      to[key] = from[key];\n    }\n  }\n  return to;\n}\n\n/**\n * Checks whether the given array contains values in ascending order.\n *\n * @param {Array<Number>} array The array to test\n * @returns {Boolean}\n */\n\nfunction isInAscendingOrder(array) {\n  if (array.length === 0) {\n    return true;\n  }\n  var value = array[0];\n  for (var i = 1; i < array.length; i++) {\n    if (value >= array[i]) {\n      return false;\n    }\n    value = array[i];\n  }\n  return true;\n}\n\n/**\n * Checks whether the given value is a number.\n *\n * @param {Number} value The value to test\n * @returns {Boolean}\n */\n\nfunction isNumber(value) {\n  return typeof value === 'number';\n}\n\n/**\n * Checks whether the given value is a finite number.\n *\n * @param {Number} value The value to test\n * @returns {Boolean}\n */\n\nfunction isFinite(value) {\n  if (typeof value !== 'number') {\n    return false;\n  }\n\n  // Check for NaN and infinity\n  // eslint-disable-next-line no-self-compare\n  if (value !== value || value === Infinity || value === -Infinity) {\n    return false;\n  }\n  return true;\n}\n\n/**\n * Checks whether the given value is a valid timestamp.\n *\n * @param {Number} value The value to test\n * @returns {Boolean}\n */\n\nfunction isValidTime(value) {\n  return typeof value === 'number' && Number.isFinite(value);\n}\n\n/**\n * Checks whether the given value is a valid object.\n *\n * @param {Object|Array} value The value to test\n * @returns {Boolean}\n */\n\nfunction isObject(value) {\n  return value !== null && _typeof(value) === 'object' && !Array.isArray(value);\n}\n\n/**\n * Checks whether the given value is a valid string.\n *\n * @param {String} value The value to test\n * @returns {Boolean}\n */\n\nfunction isString(value) {\n  return typeof value === 'string';\n}\n\n/**\n * Checks whether the given value is a valid ArrayBuffer.\n *\n * @param {ArrayBuffer} value The value to test\n * @returns {Boolean}\n */\n\nfunction isArrayBuffer(value) {\n  return Object.prototype.toString.call(value).includes('ArrayBuffer');\n}\n\n/**\n * Checks whether the given value is null or undefined.\n *\n * @param {Object} value The value to test\n * @returns {Boolean}\n */\n\nfunction isNullOrUndefined(value) {\n  return value === undefined || value === null;\n}\n\n/**\n * Checks whether the given value is a function.\n *\n * @param {Function} value The value to test\n * @returns {Boolean}\n */\n\nfunction isFunction(value) {\n  return typeof value === 'function';\n}\n\n/**\n * Checks whether the given value is a boolean.\n *\n * @param {Function} value The value to test\n * @returns {Boolean}\n */\n\nfunction isBoolean(value) {\n  return value === true || value === false;\n}\n\n/**\n * Checks whether the given value is a valid HTML element.\n *\n * @param {HTMLElement} value The value to test\n * @returns {Boolean}\n */\n\nfunction isHTMLElement(value) {\n  return value instanceof HTMLElement;\n}\n\n/**\n * Checks whether the given value is an array\n *\n * @param {Function} value The value to test\n * @returns {Boolean}\n */\n\nfunction isArray(value) {\n  return Array.isArray(value);\n}\n\n/**\n * Checks whether the given value is a valid linear gradient color\n *\n * @param {Function} value The value to test\n * @returns {Boolean}\n */\n\nfunction isLinearGradientColor(value) {\n  return isObject(value) && objectHasProperty(value, 'linearGradientStart') && objectHasProperty(value, 'linearGradientEnd') && objectHasProperty(value, 'linearGradientColorStops') && isNumber(value.linearGradientStart) && isNumber(value.linearGradientEnd) && isArray(value.linearGradientColorStops) && value.linearGradientColorStops.length === 2;\n}\nfunction getMarkerObject(obj) {\n  while (obj.parent !== null) {\n    if (obj.parent instanceof Konva.Layer) {\n      return obj;\n    }\n    obj = obj.parent;\n  }\n  return null;\n}\n\nvar isHeadless = /HeadlessChrome/.test(navigator.userAgent);\nfunction windowIsVisible() {\n  if (isHeadless || navigator.webdriver) {\n    return false;\n  }\n  return (typeof document === \"undefined\" ? \"undefined\" : _typeof(document)) === 'object' && 'visibilityState' in document && document.visibilityState === 'visible';\n}\nvar requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.msRequestAnimationFrame;\nvar cancelAnimationFrame = window.cancelAnimationFrame || window.mozCancelAnimationFrame || window.webkitCancelAnimationFrame || window.msCancelAnimationFrame;\nvar eventTypes = {\n  forward: {},\n  reverse: {}\n};\nvar EVENT_TYPE_POINT = 0;\nvar EVENT_TYPE_SEGMENT_ENTER = 1;\nvar EVENT_TYPE_SEGMENT_EXIT = 2;\neventTypes.forward[Cue.POINT] = EVENT_TYPE_POINT;\neventTypes.forward[Cue.SEGMENT_START] = EVENT_TYPE_SEGMENT_ENTER;\neventTypes.forward[Cue.SEGMENT_END] = EVENT_TYPE_SEGMENT_EXIT;\neventTypes.reverse[Cue.POINT] = EVENT_TYPE_POINT;\neventTypes.reverse[Cue.SEGMENT_START] = EVENT_TYPE_SEGMENT_EXIT;\neventTypes.reverse[Cue.SEGMENT_END] = EVENT_TYPE_SEGMENT_ENTER;\nvar eventNames = {};\neventNames[EVENT_TYPE_POINT] = 'points.enter';\neventNames[EVENT_TYPE_SEGMENT_ENTER] = 'segments.enter';\neventNames[EVENT_TYPE_SEGMENT_EXIT] = 'segments.exit';\nvar eventAttributes = {};\neventAttributes[EVENT_TYPE_POINT] = 'point';\neventAttributes[EVENT_TYPE_SEGMENT_ENTER] = 'segment';\neventAttributes[EVENT_TYPE_SEGMENT_EXIT] = 'segment';\n\n/**\n * Given a cue instance, returns the corresponding {@link Point}\n * {@link Segment}.\n *\n * @param {Peaks} peaks\n * @param {Cue} cue\n * @return {Point|Segment}\n * @throws {Error}\n */\n\nfunction getPointOrSegment(peaks, cue) {\n  switch (cue.type) {\n    case Cue.POINT:\n      return peaks.points.getPoint(cue.id);\n    case Cue.SEGMENT_START:\n    case Cue.SEGMENT_END:\n      return peaks.segments.getSegment(cue.id);\n    default:\n      throw new Error('getPointOrSegment: id not found?');\n  }\n}\n\n/**\n * CueEmitter is responsible for emitting <code>points.enter</code>,\n * <code>segments.enter</code>, and <code>segments.exit</code> events.\n *\n * @class\n * @alias CueEmitter\n *\n * @param {Peaks} peaks Parent {@link Peaks} instance.\n */\n\nfunction CueEmitter(peaks) {\n  this._cues = [];\n  this._peaks = peaks;\n  this._previousTime = -1;\n  this._updateCues = this._updateCues.bind(this);\n  this._onPlaying = this._onPlaying.bind(this);\n  this._onSeeked = this._onSeeked.bind(this);\n  this._onTimeUpdate = this._onTimeUpdate.bind(this);\n  this._onAnimationFrame = this._onAnimationFrame.bind(this);\n  this._rAFHandle = null;\n  this._activeSegments = {};\n  this._attachEventHandlers();\n}\n\n/**\n * This function is bound to all {@link Peaks} events relating to mutated\n * [Points]{@link Point} or [Segments]{@link Segment}, and updates the\n * list of cues accordingly.\n *\n * @private\n */\n\nCueEmitter.prototype._updateCues = function () {\n  var self = this;\n  var points = self._peaks.points.getPoints();\n  var segments = self._peaks.segments.getSegments();\n  self._cues.length = 0;\n  points.forEach(function (point) {\n    self._cues.push(new Cue(point.time, Cue.POINT, point.id));\n  });\n  segments.forEach(function (segment) {\n    self._cues.push(new Cue(segment.startTime, Cue.SEGMENT_START, segment.id));\n    self._cues.push(new Cue(segment.endTime, Cue.SEGMENT_END, segment.id));\n  });\n  self._cues.sort(Cue.sorter);\n  var time = self._peaks.player.getCurrentTime();\n  self._updateActiveSegments(time);\n};\n\n/**\n * Emits events for any cues passed through during media playback.\n *\n * @param {Number} time The current time on the media timeline.\n * @param {Number} previousTime The previous time on the media timeline when\n *   this function was called.\n */\n\nCueEmitter.prototype._onUpdate = function (time, previousTime) {\n  var isForward = time > previousTime;\n  var start;\n  var end;\n  var step;\n  if (isForward) {\n    start = 0;\n    end = this._cues.length;\n    step = 1;\n  } else {\n    start = this._cues.length - 1;\n    end = -1;\n    step = -1;\n  }\n\n  // Cues are sorted.\n\n  for (var i = start; isForward ? i < end : i > end; i += step) {\n    var cue = this._cues[i];\n    if (isForward ? cue.time > previousTime : cue.time < previousTime) {\n      if (isForward ? cue.time > time : cue.time < time) {\n        break;\n      }\n\n      // Cue falls between time and previousTime.\n\n      var marker = getPointOrSegment(this._peaks, cue);\n      var eventType = isForward ? eventTypes.forward[cue.type] : eventTypes.reverse[cue.type];\n      if (eventType === EVENT_TYPE_SEGMENT_ENTER) {\n        this._activeSegments[marker.id] = marker;\n      } else if (eventType === EVENT_TYPE_SEGMENT_EXIT) {\n        delete this._activeSegments[marker.id];\n      }\n      var event = {\n        time: time\n      };\n      event[eventAttributes[eventType]] = marker;\n      this._peaks.emit(eventNames[eventType], event);\n    }\n  }\n};\n\n// The next handler and onAnimationFrame are bound together\n// when the window isn't in focus, rAF is throttled\n// falling back to timeUpdate.\n\nCueEmitter.prototype._onTimeUpdate = function (time) {\n  if (windowIsVisible()) {\n    return;\n  }\n  if (this._peaks.player.isPlaying() && !this._peaks.player.isSeeking()) {\n    this._onUpdate(time, this._previousTime);\n  }\n  this._previousTime = time;\n};\nCueEmitter.prototype._onAnimationFrame = function () {\n  var time = this._peaks.player.getCurrentTime();\n  if (!this._peaks.player.isSeeking()) {\n    this._onUpdate(time, this._previousTime);\n  }\n  this._previousTime = time;\n  if (this._peaks.player.isPlaying()) {\n    this._rAFHandle = requestAnimationFrame(this._onAnimationFrame);\n  }\n};\nCueEmitter.prototype._onPlaying = function () {\n  this._previousTime = this._peaks.player.getCurrentTime();\n  this._rAFHandle = requestAnimationFrame(this._onAnimationFrame);\n};\nCueEmitter.prototype._onSeeked = function (time) {\n  this._previousTime = time;\n  this._updateActiveSegments(time);\n};\nfunction getSegmentIdComparator(id) {\n  return function compareSegmentIds(segment) {\n    return segment.id === id;\n  };\n}\n\n/**\n * The active segments is the set of all segments which overlap the current\n * playhead position. This function updates that set and emits\n * <code>segments.enter</code> and <code>segments.exit</code> events.\n */\n\nCueEmitter.prototype._updateActiveSegments = function (time) {\n  var self = this;\n  var activeSegments = self._peaks.segments.getSegmentsAtTime(time);\n\n  // Remove any segments no longer active.\n\n  for (var id in self._activeSegments) {\n    if (objectHasProperty(self._activeSegments, id)) {\n      var segment = activeSegments.find(getSegmentIdComparator(id));\n      if (!segment) {\n        self._peaks.emit('segments.exit', {\n          segment: self._activeSegments[id],\n          time: time\n        });\n        delete self._activeSegments[id];\n      }\n    }\n  }\n\n  // Add new active segments.\n\n  activeSegments.forEach(function (segment) {\n    if (!(segment.id in self._activeSegments)) {\n      self._activeSegments[segment.id] = segment;\n      self._peaks.emit('segments.enter', {\n        segment: segment,\n        time: time\n      });\n    }\n  });\n};\nvar events = ['points.update', 'points.dragmove', 'points.add', 'points.remove', 'points.remove_all', 'segments.update', 'segments.dragged', 'segments.add', 'segments.remove', 'segments.remove_all'];\nCueEmitter.prototype._attachEventHandlers = function () {\n  this._peaks.on('player.timeupdate', this._onTimeUpdate);\n  this._peaks.on('player.playing', this._onPlaying);\n  this._peaks.on('player.seeked', this._onSeeked);\n  for (var i = 0; i < events.length; i++) {\n    this._peaks.on(events[i], this._updateCues);\n  }\n  this._updateCues();\n};\nCueEmitter.prototype._detachEventHandlers = function () {\n  this._peaks.off('player.timeupdate', this._onTimeUpdate);\n  this._peaks.off('player.playing', this._onPlaying);\n  this._peaks.off('player.seeked', this._onSeeked);\n  for (var i = 0; i < events.length; i++) {\n    this._peaks.off(events[i], this._updateCues);\n  }\n};\nCueEmitter.prototype.destroy = function () {\n  if (this._rAFHandle) {\n    cancelAnimationFrame(this._rAFHandle);\n    this._rAFHandle = null;\n  }\n  this._detachEventHandlers();\n  this._previousTime = -1;\n};\n\n/**\n * @file\n *\n * Defines the {@link Point} class.\n *\n * @module point\n */\n\nvar pointOptions = ['id', 'pid', 'time', 'labelText', 'color', 'editable'];\nvar invalidOptions$1 = ['update', 'isVisible', 'peaks', 'pid'];\nfunction setDefaultPointOptions(options, peaksOptions) {\n  if (isNullOrUndefined(options.labelText)) {\n    options.labelText = '';\n  }\n  if (isNullOrUndefined(options.editable)) {\n    options.editable = false;\n  }\n  if (isNullOrUndefined(options.color)) {\n    options.color = peaksOptions.pointMarkerColor;\n  }\n}\nfunction validatePointOptions(options, updating) {\n  var context = updating ? 'update()' : 'add()';\n  if (!updating || updating && objectHasProperty(options, 'time')) {\n    if (!isValidTime(options.time)) {\n      throw new TypeError('peaks.points.' + context + ': time should be a numeric value');\n    }\n  }\n  if (options.time < 0) {\n    throw new RangeError('peaks.points.' + context + ': time should not be negative');\n  }\n  if (objectHasProperty(options, 'labelText') && !isString(options.labelText)) {\n    throw new TypeError('peaks.points.' + context + ': labelText must be a string');\n  }\n  if (objectHasProperty(options, 'editable') && !isBoolean(options.editable)) {\n    throw new TypeError('peaks.points.' + context + ': editable must be true or false');\n  }\n  if (objectHasProperty(options, 'color') && !isString(options.color) && !isLinearGradientColor(options.color)) {\n    // eslint-disable-next-line @stylistic/js/max-len\n    throw new TypeError('peaks.points.' + context + ': color must be a string or a valid linear gradient object');\n  }\n  invalidOptions$1.forEach(function (name) {\n    if (objectHasProperty(options, name)) {\n      throw new Error('peaks.points.' + context + ': invalid option name: ' + name);\n    }\n  });\n  pointOptions.forEach(function (name) {\n    if (objectHasProperty(options, '_' + name)) {\n      throw new Error('peaks.points.' + context + ': invalid option name: _' + name);\n    }\n  });\n}\n\n/**\n * A point is a single instant of time, with associated label and color.\n *\n * @class\n * @alias Point\n *\n * @param {Peaks} peaks A reference to the Peaks instance.\n * @param {Number} pid An internal unique identifier for the point.\n * @param {PointOptions} options User specified point attributes.\n */\n\nfunction Point(peaks, pid, options) {\n  this._peaks = peaks;\n  this._pid = pid;\n  this._setUserData(options);\n}\nPoint.prototype._setUserData = function (options) {\n  for (var key in options) {\n    if (objectHasProperty(options, key)) {\n      if (pointOptions.indexOf(key) === -1) {\n        this[key] = options[key];\n      } else {\n        this['_' + key] = options[key];\n      }\n    }\n  }\n};\nObject.defineProperties(Point.prototype, {\n  id: {\n    enumerable: true,\n    get: function get() {\n      return this._id;\n    }\n  },\n  pid: {\n    enumerable: true,\n    get: function get() {\n      return this._pid;\n    }\n  },\n  time: {\n    enumerable: true,\n    get: function get() {\n      return this._time;\n    }\n  },\n  labelText: {\n    get: function get() {\n      return this._labelText;\n    }\n  },\n  color: {\n    enumerable: true,\n    get: function get() {\n      return this._color;\n    }\n  },\n  editable: {\n    enumerable: true,\n    get: function get() {\n      return this._editable;\n    }\n  }\n});\nPoint.prototype.update = function (options) {\n  validatePointOptions(options, true);\n  if (objectHasProperty(options, 'id')) {\n    if (isNullOrUndefined(options.id)) {\n      throw new TypeError('point.update(): invalid id');\n    }\n    this._peaks.points.updatePointId(this, options.id);\n  }\n  this._setUserData(options);\n  this._peaks.emit('points.update', this, options);\n};\n\n/**\n * Returns <code>true</code> if the point lies with in a given time range.\n *\n * @param {Number} startTime The start of the time region, in seconds.\n * @param {Number} endTime The end of the time region, in seconds.\n * @returns {Boolean}\n */\n\nPoint.prototype.isVisible = function (startTime, endTime) {\n  return this.time >= startTime && this.time < endTime;\n};\nPoint.prototype._setTime = function (time) {\n  this._time = time;\n};\n\n/**\n * @file\n *\n * Defines the {@link WaveformPoints} class.\n *\n * @module waveform-points\n */\n\n\n/**\n * Point parameters.\n *\n * @typedef {Object} PointOptions\n * @global\n * @property {Number} time Point time, in seconds.\n * @property {Boolean=} editable If <code>true</code> the point time can be\n *   adjusted via the user interface.\n *   Default: <code>false</code>.\n * @property {String=} color Point marker color.\n *   Default: a random color.\n * @property {String=} labelText Point label text.\n *   Default: an empty string.\n * @property {String=} id A unique point identifier.\n *   Default: an automatically generated identifier.\n * @property {*} data Optional application-specific data.\n */\n\n/**\n * Handles all functionality related to the adding, removing and manipulation\n * of points. A point is a single instant of time.\n *\n * @class\n * @alias WaveformPoints\n *\n * @param {Peaks} peaks The parent Peaks object.\n */\n\nfunction WaveformPoints(peaks) {\n  this._peaks = peaks;\n  this._points = [];\n  this._pointsById = {};\n  this._pointsByPid = {};\n  this._pointIdCounter = 0;\n  this._pointPid = 0;\n}\n\n/**\n * Returns a new unique point id value.\n *\n * @returns {String}\n */\n\nWaveformPoints.prototype._getNextPointId = function () {\n  return 'peaks.point.' + this._pointIdCounter++;\n};\n\n/**\n * Returns a new unique point id value, for internal use within\n * Peaks.js only.\n *\n * @returns {Number}\n */\n\nWaveformPoints.prototype._getNextPid = function () {\n  return this._pointPid++;\n};\n\n/**\n * Adds a new point object.\n *\n * @private\n * @param {Point} point\n */\n\nWaveformPoints.prototype._addPoint = function (point) {\n  this._points.push(point);\n  this._pointsById[point.id] = point;\n  this._pointsByPid[point.pid] = point;\n};\n\n/**\n * Creates a new point object.\n *\n * @private\n * @param {PointOptions} options\n * @returns {Point}\n */\n\nWaveformPoints.prototype._createPoint = function (options) {\n  var pointOptions = {};\n  extend(pointOptions, options);\n  if (isNullOrUndefined(pointOptions.id)) {\n    pointOptions.id = this._getNextPointId();\n  }\n  var pid = this._getNextPid();\n  setDefaultPointOptions(pointOptions, this._peaks.options);\n  validatePointOptions(pointOptions, false);\n  return new Point(this._peaks, pid, pointOptions);\n};\n\n/**\n * Returns all points.\n *\n * @returns {Array<Point>}\n */\n\nWaveformPoints.prototype.getPoints = function () {\n  return this._points;\n};\n\n/**\n * Returns the point with the given id, or <code>undefined</code> if not found.\n *\n * @param {String} id\n * @returns {Point}\n */\n\nWaveformPoints.prototype.getPoint = function (id) {\n  return this._pointsById[id];\n};\n\n/**\n * Returns all points within a given time region.\n *\n * @param {Number} startTime The start of the time region, in seconds.\n * @param {Number} endTime The end of the time region, in seconds.\n * @returns {Array<Point>}\n */\n\nWaveformPoints.prototype.find = function (startTime, endTime) {\n  return this._points.filter(function (point) {\n    return point.isVisible(startTime, endTime);\n  });\n};\n\n/**\n * Adds one or more points to the timeline.\n *\n * @param {PointOptions|Array<PointOptions>} pointOrPoints\n *\n * @returns Point|Array<Point>\n */\n\nWaveformPoints.prototype.add = function /* pointOrPoints */\n() {\n  var self = this;\n  var arrayArgs = Array.isArray(arguments[0]);\n  var points = arrayArgs ? arguments[0] : Array.prototype.slice.call(arguments);\n  points = points.map(function (pointOptions) {\n    var point = self._createPoint(pointOptions);\n    if (objectHasProperty(self._pointsById, point.id)) {\n      throw new Error('peaks.points.add(): duplicate id');\n    }\n    return point;\n  });\n  points.forEach(function (point) {\n    self._addPoint(point);\n  });\n  this._peaks.emit('points.add', {\n    points: points\n  });\n  return arrayArgs ? points : points[0];\n};\nWaveformPoints.prototype.updatePointId = function (point, newPointId) {\n  if (this._pointsById[point.id]) {\n    if (this._pointsById[newPointId]) {\n      throw new Error('point.update(): duplicate id');\n    } else {\n      delete this._pointsById[point.id];\n      this._pointsById[newPointId] = point;\n    }\n  }\n};\n\n/**\n * Returns the indexes of points that match the given predicate.\n *\n * @private\n * @param {Function} predicate Predicate function to find matching points.\n * @returns {Array<Number>} An array of indexes into the points array of\n *   the matching elements.\n */\n\nWaveformPoints.prototype._findPoint = function (predicate) {\n  var indexes = [];\n  for (var i = 0, length = this._points.length; i < length; i++) {\n    if (predicate(this._points[i])) {\n      indexes.push(i);\n    }\n  }\n  return indexes;\n};\n\n/**\n * Removes the points at the given array indexes.\n *\n * @private\n * @param {Array<Number>} indexes The array indexes to remove.\n * @returns {Array<Point>} The removed {@link Point} objects.\n */\n\nWaveformPoints.prototype._removeIndexes = function (indexes) {\n  var removed = [];\n  for (var i = 0; i < indexes.length; i++) {\n    var index = indexes[i] - removed.length;\n    var itemRemoved = this._points.splice(index, 1)[0];\n    delete this._pointsById[itemRemoved.id];\n    delete this._pointsByPid[itemRemoved.pid];\n    removed.push(itemRemoved);\n  }\n  return removed;\n};\n\n/**\n * Removes all points that match a given predicate function.\n *\n * After removing the points, this function emits a\n * <code>points.remove</code> event with the removed {@link Point}\n * objects.\n *\n * @private\n * @param {Function} predicate A predicate function that identifies which\n *   points to remove.\n * @returns {Array<Point>} The removed {@link Points} objects.\n */\n\nWaveformPoints.prototype._removePoints = function (predicate) {\n  var indexes = this._findPoint(predicate);\n  var removed = this._removeIndexes(indexes);\n  this._peaks.emit('points.remove', {\n    points: removed\n  });\n  return removed;\n};\n\n/**\n * Removes the given point.\n *\n * @param {Point} point The point to remove.\n * @returns {Array<Point>} The removed points.\n */\n\nWaveformPoints.prototype.remove = function (point) {\n  return this._removePoints(function (p) {\n    return p === point;\n  });\n};\n\n/**\n * Removes any points with the given id.\n *\n * @param {String} id\n * @returns {Array<Point>} The removed {@link Point} objects.\n */\n\nWaveformPoints.prototype.removeById = function (pointId) {\n  return this._removePoints(function (point) {\n    return point.id === pointId;\n  });\n};\n\n/**\n * Removes any points at the given time.\n *\n * @param {Number} time\n * @returns {Array<Point>} The removed {@link Point} objects.\n */\n\nWaveformPoints.prototype.removeByTime = function (time) {\n  return this._removePoints(function (point) {\n    return point.time === time;\n  });\n};\n\n/**\n * Removes all points.\n *\n * After removing the points, this function emits a\n * <code>points.remove_all</code> event.\n */\n\nWaveformPoints.prototype.removeAll = function () {\n  this._points = [];\n  this._pointsById = {};\n  this._pointsByPid = {};\n  this._peaks.emit('points.remove_all');\n};\n\n/**\n * @file\n *\n * Defines the {@link Segment} class.\n *\n * @module segment\n */\n\nvar segmentOptions = ['id', 'pid', 'startTime', 'endTime', 'labelText', 'color', 'borderColor', 'markers', 'overlay', 'editable'];\nvar invalidOptions = ['update', 'isVisible', 'peaks', 'pid'];\nfunction setDefaultSegmentOptions(options, globalSegmentOptions) {\n  if (isNullOrUndefined(options.color)) {\n    if (globalSegmentOptions.overlay) {\n      options.color = globalSegmentOptions.overlayColor;\n    } else {\n      options.color = globalSegmentOptions.waveformColor;\n    }\n  }\n  if (isNullOrUndefined(options.borderColor)) {\n    options.borderColor = globalSegmentOptions.overlayBorderColor;\n  }\n  if (isNullOrUndefined(options.labelText)) {\n    options.labelText = '';\n  }\n  if (isNullOrUndefined(options.markers)) {\n    options.markers = globalSegmentOptions.markers;\n  }\n  if (isNullOrUndefined(options.overlay)) {\n    options.overlay = globalSegmentOptions.overlay;\n  }\n  if (isNullOrUndefined(options.editable)) {\n    options.editable = false;\n  }\n}\nfunction validateSegmentOptions(options, updating) {\n  var context = updating ? 'update()' : 'add()';\n  if (objectHasProperty(options, 'startTime') && !isValidTime(options.startTime)) {\n    throw new TypeError('peaks.segments.' + context + ': startTime should be a valid number');\n  }\n  if (objectHasProperty(options, 'endTime') && !isValidTime(options.endTime)) {\n    throw new TypeError('peaks.segments.' + context + ': endTime should be a valid number');\n  }\n  if (!updating) {\n    if (!objectHasProperty(options, 'startTime') || !objectHasProperty(options, 'endTime')) {\n      throw new TypeError('peaks.segments.' + context + ': missing startTime or endTime');\n    }\n  }\n  if (options.startTime < 0) {\n    throw new RangeError('peaks.segments.' + context + ': startTime should not be negative');\n  }\n  if (options.endTime < 0) {\n    throw new RangeError('peaks.segments.' + context + ': endTime should not be negative');\n  }\n  if (options.endTime < options.startTime) {\n    // eslint-disable-next-line @stylistic/js/max-len\n    throw new RangeError('peaks.segments.' + context + ': endTime should not be less than startTime');\n  }\n  if (objectHasProperty(options, 'labelText') && !isString(options.labelText)) {\n    throw new TypeError('peaks.segments.' + context + ': labelText must be a string');\n  }\n  if (updating && objectHasProperty(options, 'markers')) {\n    throw new TypeError('peaks.segments.' + context + ': cannot update markers attribute');\n  }\n  if (objectHasProperty(options, 'markers') && !isBoolean(options.markers)) {\n    throw new TypeError('peaks.segments.' + context + ': markers must be true or false');\n  }\n  if (updating && objectHasProperty(options, 'overlay')) {\n    throw new TypeError('peaks.segments.' + context + ': cannot update overlay attribute');\n  }\n  if (objectHasProperty(options, 'overlay') && !isBoolean(options.overlay)) {\n    throw new TypeError('peaks.segments.' + context + ': overlay must be true or false');\n  }\n  if (objectHasProperty(options, 'editable') && !isBoolean(options.editable)) {\n    throw new TypeError('peaks.segments.' + context + ': editable must be true or false');\n  }\n  if (objectHasProperty(options, 'color') && !isString(options.color) && !isLinearGradientColor(options.color)) {\n    // eslint-disable-next-line @stylistic/js/max-len\n    throw new TypeError('peaks.segments.' + context + ': color must be a string or a valid linear gradient object');\n  }\n  if (objectHasProperty(options, 'borderColor') && !isString(options.borderColor)) {\n    throw new TypeError('peaks.segments.' + context + ': borderColor must be a string');\n  }\n  invalidOptions.forEach(function (name) {\n    if (objectHasProperty(options, name)) {\n      throw new Error('peaks.segments.' + context + ': invalid option name: ' + name);\n    }\n  });\n  segmentOptions.forEach(function (name) {\n    if (objectHasProperty(options, '_' + name)) {\n      throw new Error('peaks.segments.' + context + ': invalid option name: _' + name);\n    }\n  });\n}\n\n/**\n * A segment is a region of time, with associated label and color.\n *\n * @class\n * @alias Segment\n *\n * @param {Peaks} peaks A reference to the Peaks instance.\n * @param {Number} pid An internal unique identifier for the segment.\n * @param {SegmentOptions} options User specified segment attributes.\n */\n\nfunction Segment(peaks, pid, options) {\n  this._peaks = peaks;\n  this._pid = pid;\n  this._id = options.id;\n  this._startTime = options.startTime;\n  this._endTime = options.endTime;\n  this._labelText = options.labelText;\n  this._color = options.color;\n  this._borderColor = options.borderColor;\n  this._editable = options.editable;\n  this._markers = options.markers;\n  this._overlay = options.overlay;\n  this._setUserData(options);\n}\nSegment.prototype._setUserData = function (options) {\n  for (var key in options) {\n    if (objectHasProperty(options, key)) {\n      if (segmentOptions.indexOf(key) === -1) {\n        this[key] = options[key];\n      } else {\n        this['_' + key] = options[key];\n      }\n    }\n  }\n};\nObject.defineProperties(Segment.prototype, {\n  id: {\n    enumerable: true,\n    get: function get() {\n      return this._id;\n    }\n  },\n  pid: {\n    enumerable: true,\n    get: function get() {\n      return this._pid;\n    }\n  },\n  startTime: {\n    enumerable: true,\n    get: function get() {\n      return this._startTime;\n    }\n  },\n  endTime: {\n    enumerable: true,\n    get: function get() {\n      return this._endTime;\n    }\n  },\n  labelText: {\n    enumerable: true,\n    get: function get() {\n      return this._labelText;\n    }\n  },\n  color: {\n    enumerable: true,\n    get: function get() {\n      return this._color;\n    }\n  },\n  borderColor: {\n    enumerable: true,\n    get: function get() {\n      return this._borderColor;\n    }\n  },\n  markers: {\n    enumerable: true,\n    get: function get() {\n      return this._markers;\n    }\n  },\n  overlay: {\n    enumerable: true,\n    get: function get() {\n      return this._overlay;\n    }\n  },\n  editable: {\n    enumerable: true,\n    get: function get() {\n      return this._editable;\n    }\n  }\n});\nSegment.prototype.update = function (options) {\n  validateSegmentOptions(options, true);\n  if (objectHasProperty(options, 'id')) {\n    if (isNullOrUndefined(options.id)) {\n      throw new TypeError('segment.update(): invalid id');\n    }\n    this._peaks.segments.updateSegmentId(this, options.id);\n  }\n  this._setUserData(options);\n  this._peaks.emit('segments.update', this, options);\n};\n\n/**\n * Returns <code>true</code> if the segment overlaps a given time region.\n *\n * @param {Number} startTime The start of the time region, in seconds.\n * @param {Number} endTime The end of the time region, in seconds.\n * @returns {Boolean}\n */\n\nSegment.prototype.isVisible = function (startTime, endTime) {\n  // A special case, where the segment has zero duration\n  // and is at the start of the region.\n  if (this.startTime === this.endTime && this.startTime === startTime) {\n    return true;\n  }\n\n  // Segment ends before start of region.\n  if (this.endTime <= startTime) {\n    return false;\n  }\n\n  // Segment starts after end of region\n  if (this.startTime >= endTime) {\n    return false;\n  }\n  return true;\n};\nSegment.prototype._setStartTime = function (time) {\n  this._startTime = time;\n};\nSegment.prototype._setEndTime = function (time) {\n  this._endTime = time;\n};\n\n/**\n * @file\n *\n * Defines the {@link WaveformSegments} class.\n *\n * @module waveform-segments\n */\n\n\n/**\n * Segment parameters.\n *\n * @typedef {Object} SegmentOptions\n * @global\n * @property {Number} startTime Segment start time, in seconds.\n * @property {Number} endTime Segment end time, in seconds.\n * @property {Boolean=} editable If <code>true</code> the segment start and\n *   end times can be adjusted via the user interface.\n *   Default: <code>false</code>.\n * @property {String=} color Segment waveform color.\n *   Default: Set by the <code>segmentOptions.waveformColor</code> option\n *   or the <code>segmentOptions.overlayColor</code> option.\n * @property {String=} borderColor Segment border color.\n *   Default: Set by the <code>segmentOptions.overlayBorderColor</code> option.\n * @property {String=} labelText Segment label text.\n *   Default: an empty string.\n * @property {String=} id A unique segment identifier.\n *   Default: an automatically generated identifier.\n * @property {*} data Optional application specific data.\n */\n\n/**\n * Handles all functionality related to the adding, removing and manipulation\n * of segments.\n *\n * @class\n * @alias WaveformSegments\n *\n * @param {Peaks} peaks The parent Peaks object.\n */\n\nfunction WaveformSegments(peaks) {\n  this._peaks = peaks;\n  this._segments = [];\n  this._segmentsById = {};\n  this._segmentsByPid = {};\n  this._segmentIdCounter = 0;\n  this._segmentPid = 0;\n  this._isInserting = false;\n}\n\n/**\n * Returns a new unique segment id value.\n *\n * @private\n * @returns {String}\n */\n\nWaveformSegments.prototype._getNextSegmentId = function () {\n  return 'peaks.segment.' + this._segmentIdCounter++;\n};\n\n/**\n * Returns a new unique segment id value, for internal use within\n * Peaks.js only.\n *\n * @private\n * @returns {Number}\n */\n\nWaveformSegments.prototype._getNextPid = function () {\n  return this._segmentPid++;\n};\n\n/**\n * Adds a new segment object.\n *\n * @private\n * @param {Segment} segment\n */\n\nWaveformSegments.prototype._addSegment = function (segment) {\n  this._segments.push(segment);\n  this._segmentsById[segment.id] = segment;\n  this._segmentsByPid[segment.pid] = segment;\n};\n\n/**\n * Creates a new segment object.\n *\n * @private\n * @param {SegmentOptions} options\n * @return {Segment}\n */\n\nWaveformSegments.prototype._createSegment = function (options) {\n  var segmentOptions = {};\n  extend(segmentOptions, options);\n  if (isNullOrUndefined(segmentOptions.id)) {\n    segmentOptions.id = this._getNextSegmentId();\n  }\n  var pid = this._getNextPid();\n  setDefaultSegmentOptions(segmentOptions, this._peaks.options.segmentOptions);\n  validateSegmentOptions(segmentOptions, false);\n  return new Segment(this._peaks, pid, segmentOptions);\n};\n\n/**\n * Returns all segments.\n *\n * @returns {Array<Segment>}\n */\n\nWaveformSegments.prototype.getSegments = function () {\n  return this._segments;\n};\n\n/**\n * Returns the segment with the given id, or <code>undefined</code> if not found.\n *\n * @param {String} id\n * @returns {Segment}\n */\n\nWaveformSegments.prototype.getSegment = function (id) {\n  return this._segmentsById[id];\n};\n\n/**\n * Returns all segments that overlap a given point in time.\n *\n * @param {Number} time\n * @returns {Array<Segment>}\n */\n\nWaveformSegments.prototype.getSegmentsAtTime = function (time) {\n  return this._segments.filter(function (segment) {\n    return time >= segment.startTime && time < segment.endTime;\n  });\n};\n\n/**\n * Returns all segments that overlap a given time region.\n *\n * @param {Number} startTime The start of the time region, in seconds.\n * @param {Number} endTime The end of the time region, in seconds.\n *\n * @returns {Array<Segment>}\n */\n\nWaveformSegments.prototype.find = function (startTime, endTime) {\n  return this._segments.filter(function (segment) {\n    return segment.isVisible(startTime, endTime);\n  });\n};\n\n/**\n * Returns a copy of the segments array, sorted by ascending segment start time.\n *\n * @returns {Array<Segment>}\n */\n\nWaveformSegments.prototype._getSortedSegments = function () {\n  return this._segments.slice().sort(function (a, b) {\n    return a.startTime - b.startTime;\n  });\n};\nWaveformSegments.prototype.findPreviousSegment = function (segment) {\n  var sortedSegments = this._getSortedSegments();\n  var index = sortedSegments.findIndex(function (s) {\n    return s.id === segment.id;\n  });\n  if (index !== -1) {\n    return sortedSegments[index - 1];\n  }\n  return undefined;\n};\nWaveformSegments.prototype.findNextSegment = function (segment) {\n  var sortedSegments = this._getSortedSegments();\n  var index = sortedSegments.findIndex(function (s) {\n    return s.id === segment.id;\n  });\n  if (index !== -1) {\n    return sortedSegments[index + 1];\n  }\n  return undefined;\n};\n\n/**\n * Adds one or more segments to the timeline.\n *\n * @param {SegmentOptions|Array<SegmentOptions>} segmentOrSegments\n *\n * @returns Segment|Array<Segment>\n */\n\nWaveformSegments.prototype.add = function /* segmentOrSegments */\n() {\n  var self = this;\n  var arrayArgs = Array.isArray(arguments[0]);\n  var segments = arrayArgs ? arguments[0] : Array.prototype.slice.call(arguments);\n  segments = segments.map(function (segmentOptions) {\n    var segment = self._createSegment(segmentOptions);\n    if (objectHasProperty(self._segmentsById, segment.id)) {\n      throw new Error('peaks.segments.add(): duplicate id');\n    }\n    return segment;\n  });\n  segments.forEach(function (segment) {\n    self._addSegment(segment);\n  });\n  this._peaks.emit('segments.add', {\n    segments: segments,\n    insert: this._isInserting\n  });\n  return arrayArgs ? segments : segments[0];\n};\nWaveformSegments.prototype.updateSegmentId = function (segment, newSegmentId) {\n  if (this._segmentsById[segment.id]) {\n    if (this._segmentsById[newSegmentId]) {\n      throw new Error('segment.update(): duplicate id');\n    } else {\n      delete this._segmentsById[segment.id];\n      this._segmentsById[newSegmentId] = segment;\n    }\n  }\n};\n\n/**\n * Returns the indexes of segments that match the given predicate.\n *\n * @private\n * @param {Function} predicate Predicate function to find matching segments.\n * @returns {Array<Number>} An array of indexes into the segments array of\n *   the matching elements.\n */\n\nWaveformSegments.prototype._findSegment = function (predicate) {\n  var indexes = [];\n  for (var i = 0, length = this._segments.length; i < length; i++) {\n    if (predicate(this._segments[i])) {\n      indexes.push(i);\n    }\n  }\n  return indexes;\n};\n\n/**\n * Removes the segments at the given array indexes.\n *\n * @private\n * @param {Array<Number>} indexes The array indexes to remove.\n * @returns {Array<Segment>} The removed {@link Segment} objects.\n */\n\nWaveformSegments.prototype._removeIndexes = function (indexes) {\n  var removed = [];\n  for (var i = 0; i < indexes.length; i++) {\n    var index = indexes[i] - removed.length;\n    var itemRemoved = this._segments.splice(index, 1)[0];\n    delete this._segmentsById[itemRemoved.id];\n    delete this._segmentsByPid[itemRemoved.pid];\n    removed.push(itemRemoved);\n  }\n  return removed;\n};\n\n/**\n * Removes all segments that match a given predicate function.\n *\n * After removing the segments, this function also emits a\n * <code>segments.remove</code> event with the removed {@link Segment}\n * objects.\n *\n * @private\n * @param {Function} predicate A predicate function that identifies which\n *   segments to remove.\n * @returns {Array<Segment>} The removed {@link Segment} objects.\n */\n\nWaveformSegments.prototype._removeSegments = function (predicate) {\n  var indexes = this._findSegment(predicate);\n  var removed = this._removeIndexes(indexes);\n  this._peaks.emit('segments.remove', {\n    segments: removed\n  });\n  return removed;\n};\n\n/**\n * Removes the given segment.\n *\n * @param {Segment} segment The segment to remove.\n * @returns {Array<Segment>} The removed segment.\n */\n\nWaveformSegments.prototype.remove = function (segment) {\n  return this._removeSegments(function (s) {\n    return s === segment;\n  });\n};\n\n/**\n * Removes any segments with the given id.\n *\n * @param {String} id\n * @returns {Array<Segment>} The removed {@link Segment} objects.\n */\n\nWaveformSegments.prototype.removeById = function (segmentId) {\n  return this._removeSegments(function (segment) {\n    return segment.id === segmentId;\n  });\n};\n\n/**\n * Removes any segments with the given start time, and optional end time.\n *\n * @param {Number} startTime Segments with this start time are removed.\n * @param {Number?} endTime If present, only segments with both the given\n *   start time and end time are removed.\n * @returns {Array<Segment>} The removed {@link Segment} objects.\n */\n\nWaveformSegments.prototype.removeByTime = function (startTime, endTime) {\n  endTime = typeof endTime === 'number' ? endTime : 0;\n  var filter;\n  if (endTime > 0) {\n    filter = function filter(segment) {\n      return segment.startTime === startTime && segment.endTime === endTime;\n    };\n  } else {\n    filter = function filter(segment) {\n      return segment.startTime === startTime;\n    };\n  }\n  return this._removeSegments(filter);\n};\n\n/**\n * Removes all segments.\n *\n * After removing the segments, this function emits a\n * <code>segments.remove_all</code> event.\n */\n\nWaveformSegments.prototype.removeAll = function () {\n  this._segments = [];\n  this._segmentsById = {};\n  this._segmentsByPid = {};\n  this._peaks.emit('segments.remove_all');\n};\nWaveformSegments.prototype.setInserting = function (value) {\n  this._isInserting = value;\n};\nWaveformSegments.prototype.isInserting = function () {\n  return this._isInserting;\n};\n\n/**\n * @file\n *\n * Defines the {@link KeyboardHandler} class.\n *\n * @module keyboard-handler\n */\n\nvar nodes = ['OBJECT', 'TEXTAREA', 'INPUT', 'SELECT', 'OPTION'];\nvar SPACE = 32,\n  TAB = 9,\n  LEFT_ARROW = 37,\n  RIGHT_ARROW = 39;\nvar keys = [SPACE, TAB, LEFT_ARROW, RIGHT_ARROW];\n\n/**\n * Configures keyboard event handling.\n *\n * @class\n * @alias KeyboardHandler\n *\n * @param {EventEmitter} eventEmitter\n */\n\nfunction KeyboardHandler(eventEmitter) {\n  this.eventEmitter = eventEmitter;\n  this._handleKeyEvent = this._handleKeyEvent.bind(this);\n  document.addEventListener('keydown', this._handleKeyEvent);\n  document.addEventListener('keypress', this._handleKeyEvent);\n  document.addEventListener('keyup', this._handleKeyEvent);\n}\n\n/**\n * Keyboard event handler function.\n *\n * @note Arrow keys only triggered on keydown, not keypress.\n *\n * @param {KeyboardEvent} event\n * @private\n */\n\nKeyboardHandler.prototype._handleKeyEvent = function handleKeyEvent(event) {\n  if (nodes.indexOf(event.target.nodeName) === -1) {\n    if (keys.indexOf(event.type) > -1) {\n      event.preventDefault();\n    }\n    if (event.type === 'keydown' || event.type === 'keypress') {\n      switch (event.keyCode) {\n        case SPACE:\n          this.eventEmitter.emit('keyboard.space');\n          break;\n        case TAB:\n          this.eventEmitter.emit('keyboard.tab');\n          break;\n      }\n    } else if (event.type === 'keyup') {\n      switch (event.keyCode) {\n        case LEFT_ARROW:\n          if (event.shiftKey) {\n            this.eventEmitter.emit('keyboard.shift_left');\n          } else {\n            this.eventEmitter.emit('keyboard.left');\n          }\n          break;\n        case RIGHT_ARROW:\n          if (event.shiftKey) {\n            this.eventEmitter.emit('keyboard.shift_right');\n          } else {\n            this.eventEmitter.emit('keyboard.right');\n          }\n          break;\n      }\n    }\n  }\n};\nKeyboardHandler.prototype.destroy = function () {\n  document.removeEventListener('keydown', this._handleKeyEvent);\n  document.removeEventListener('keypress', this._handleKeyEvent);\n  document.removeEventListener('keyup', this._handleKeyEvent);\n};\n\n/**\n * @file\n *\n * Implementation of {@link Player} adapter based on an <code>&lt;audio&gt;</code>\n * or <code>&lt;video&gt;</code> HTML element.\n *\n * @module mediaelement-player\n */\n\n/**\n * Checks whether the given HTMLMediaElement has either a src attribute\n * or any child <code>&lt;source&gt;</code> nodes.\n */\n\nfunction mediaElementHasSource(mediaElement) {\n  if (mediaElement.src) {\n    return true;\n  }\n  if (mediaElement.querySelector('source')) {\n    return true;\n  }\n  return false;\n}\n\n/**\n * A wrapper for interfacing with the HTMLMediaElement API.\n * Initializes the player for a given media element.\n *\n * @class\n * @alias MediaElementPlayer\n * @param {HTMLMediaElement} mediaElement The HTML <code>&lt;audio&gt;</code>\n *   or <code>&lt;video&gt;</code> element to associate with the\n *   {@link Peaks} instance.\n */\n\nfunction MediaElementPlayer(mediaElement) {\n  this._mediaElement = mediaElement;\n}\n\n/**\n * Adds an event listener to the media element.\n *\n * @private\n * @param {String} type The event type to listen for.\n * @param {Function} callback An event handler function.\n */\n\nMediaElementPlayer.prototype._addMediaListener = function (type, callback) {\n  this._listeners.push({\n    type: type,\n    callback: callback\n  });\n  this._mediaElement.addEventListener(type, callback);\n};\nMediaElementPlayer.prototype.init = function (eventEmitter) {\n  var self = this;\n  self._eventEmitter = eventEmitter;\n  self._listeners = [];\n  self._duration = self.getDuration();\n  self._addMediaListener('timeupdate', function () {\n    self._eventEmitter.emit('player.timeupdate', self.getCurrentTime());\n  });\n  self._addMediaListener('playing', function () {\n    self._eventEmitter.emit('player.playing', self.getCurrentTime());\n  });\n  self._addMediaListener('pause', function () {\n    self._eventEmitter.emit('player.pause', self.getCurrentTime());\n  });\n  self._addMediaListener('ended', function () {\n    self._eventEmitter.emit('player.ended');\n  });\n  self._addMediaListener('seeked', function () {\n    self._eventEmitter.emit('player.seeked', self.getCurrentTime());\n  });\n  self._addMediaListener('canplay', function () {\n    self._eventEmitter.emit('player.canplay');\n  });\n  self._addMediaListener('error', function (event) {\n    self._eventEmitter.emit('player.error', event.target.error);\n  });\n  self._interval = null;\n  if (!mediaElementHasSource(self._mediaElement)) {\n    return Promise.resolve();\n  } else if (self._mediaElement.error && self._mediaElement.error.code === MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED) {\n    // The media element has a source, but the format is not supported.\n    return Promise.reject(self._mediaElement.error);\n  }\n  return new Promise(function (resolve, reject) {\n    function eventHandler(event) {\n      self._mediaElement.removeEventListener('loadedmetadata', eventHandler);\n      self._mediaElement.removeEventListener('error', eventHandler);\n      if (event.type === 'loadedmetadata') {\n        resolve();\n      } else {\n        reject(event.target.error);\n      }\n    }\n\n    // If the media element has preload=\"none\", clicking to seek in the\n    // waveform won't work, so here we force the media to load.\n    if (self._mediaElement.readyState === HTMLMediaElement.HAVE_NOTHING) {\n      // Wait for the readyState to change to HAVE_METADATA so we know the\n      // duration is valid, otherwise it could be NaN.\n      self._mediaElement.addEventListener('loadedmetadata', eventHandler);\n      self._mediaElement.addEventListener('error', eventHandler);\n      self._mediaElement.load();\n    } else {\n      resolve();\n    }\n  });\n};\n\n/**\n * Cleans up the player object, removing all event listeners from the\n * associated media element.\n */\n\nMediaElementPlayer.prototype.destroy = function () {\n  for (var i = 0; i < this._listeners.length; i++) {\n    var listener = this._listeners[i];\n    this._mediaElement.removeEventListener(listener.type, listener.callback);\n  }\n  this._listeners.length = 0;\n  this._mediaElement = null;\n};\nMediaElementPlayer.prototype.play = function () {\n  return this._mediaElement.play();\n};\nMediaElementPlayer.prototype.pause = function () {\n  this._mediaElement.pause();\n};\nMediaElementPlayer.prototype.isPlaying = function () {\n  return !this._mediaElement.paused;\n};\nMediaElementPlayer.prototype.isSeeking = function () {\n  return this._mediaElement.seeking;\n};\nMediaElementPlayer.prototype.getCurrentTime = function () {\n  return this._mediaElement.currentTime;\n};\nMediaElementPlayer.prototype.getDuration = function () {\n  return this._mediaElement.duration;\n};\nMediaElementPlayer.prototype.seek = function (time) {\n  this._mediaElement.currentTime = time;\n};\nfunction SetSourceHandler(eventEmitter, mediaElement) {\n  this._eventEmitter = eventEmitter;\n  this._mediaElement = mediaElement;\n  this._playerCanPlayHandler = this._playerCanPlayHandler.bind(this);\n  this._playerErrorHandler = this._playerErrorHandler.bind(this);\n}\nSetSourceHandler.prototype.setSource = function (options, callback) {\n  var self = this;\n  self._options = options;\n  self._callback = callback;\n  self._eventEmitter.on('player.canplay', self._playerCanPlayHandler);\n  self._eventEmitter.on('player.error', self._playerErrorHandler);\n  return new Promise(function (resolve, reject) {\n    self._resolve = resolve;\n    self._reject = reject;\n    self._eventEmitter.on('player.canplay', self._playerCanPlayHandler);\n    self._eventEmitter.on('player.error', self._playerErrorHandler);\n    self._mediaElement.setAttribute('src', options.mediaUrl);\n\n    // Force the media element to load, in case the media element\n    // has preload=\"none\".\n    if (self._mediaElement.readyState === HTMLMediaElement.HAVE_NOTHING) {\n      self._mediaElement.load();\n    }\n  });\n};\nSetSourceHandler.prototype._reset = function () {\n  this._eventEmitter.removeListener('player.canplay', this._playerCanPlayHandler);\n  this._eventEmitter.removeListener('player.error', this._playerErrorHandler);\n};\nSetSourceHandler.prototype._playerCanPlayHandler = function () {\n  this._reset();\n  this._resolve();\n};\nSetSourceHandler.prototype._playerErrorHandler = function (err) {\n  this._reset();\n\n  // Return the MediaError object from the media element\n  this._reject(err);\n};\nMediaElementPlayer.prototype.setSource = function (options) {\n  if (!options.mediaUrl) {\n    // eslint-disable-next-line @stylistic/js/max-len\n    return Promise.reject(new Error('peaks.setSource(): options must contain a mediaUrl when using mediaElement'));\n  }\n  var setSourceHandler = new SetSourceHandler(this._eventEmitter, this._mediaElement);\n  return setSourceHandler.setSource(options);\n};\n\n/**\n * @file\n *\n * A general audio player class which interfaces with external audio players.\n * The default audio player in Peaks.js is {@link MediaElementPlayer}.\n *\n * @module player\n */\n\nfunction getAllPropertiesFrom(adapter) {\n  var allProperties = [];\n  var obj = adapter;\n  while (obj) {\n    Object.getOwnPropertyNames(obj).forEach(function (p) {\n      allProperties.push(p);\n    });\n    obj = Object.getPrototypeOf(obj);\n  }\n  return allProperties;\n}\nfunction validateAdapter(adapter) {\n  var publicAdapterMethods = ['init', 'destroy', 'play', 'pause', 'isPlaying', 'isSeeking', 'getCurrentTime', 'getDuration', 'seek'];\n  var allProperties = getAllPropertiesFrom(adapter);\n  publicAdapterMethods.forEach(function (method) {\n    if (!allProperties.includes(method)) {\n      throw new TypeError('Peaks.init(): Player method ' + method + ' is undefined');\n    }\n    if (typeof adapter[method] !== 'function') {\n      throw new TypeError('Peaks.init(): Player method ' + method + ' is not a function');\n    }\n  });\n}\n\n/**\n * A wrapper for interfacing with an external player API.\n *\n * @class\n * @alias Player\n *\n * @param {Peaks} peaks The parent {@link Peaks} object.\n * @param {Adapter} adapter The player adapter.\n */\n\nfunction Player(peaks, adapter) {\n  this._peaks = peaks;\n  this._playingSegment = false;\n  this._segment = null;\n  this._loop = false;\n  this._playSegmentTimerCallback = this._playSegmentTimerCallback.bind(this);\n  validateAdapter(adapter);\n  this._adapter = adapter;\n}\nPlayer.prototype.init = function () {\n  return this._adapter.init(this._peaks);\n};\n\n/**\n * Cleans up the player object.\n */\n\nPlayer.prototype.destroy = function () {\n  this._adapter.destroy();\n};\n\n/**\n * Starts playback.\n * @returns {Promise}\n */\n\nPlayer.prototype.play = function () {\n  return this._adapter.play();\n};\n\n/**\n * Pauses playback.\n */\n\nPlayer.prototype.pause = function () {\n  this._adapter.pause();\n};\n\n/**\n * @returns {Boolean} <code>true</code> if playing, <code>false</code>\n * otherwise.\n */\n\nPlayer.prototype.isPlaying = function () {\n  return this._adapter.isPlaying();\n};\n\n/**\n * @returns {boolean} <code>true</code> if seeking\n */\n\nPlayer.prototype.isSeeking = function () {\n  return this._adapter.isSeeking();\n};\n\n/**\n * Returns the current playback time position, in seconds.\n *\n * @returns {Number}\n */\n\nPlayer.prototype.getCurrentTime = function () {\n  return this._adapter.getCurrentTime();\n};\n\n/**\n * Returns the media duration, in seconds.\n *\n * @returns {Number}\n */\n\nPlayer.prototype.getDuration = function () {\n  return this._adapter.getDuration();\n};\n\n/**\n * Seeks to a given time position within the media.\n *\n * @param {Number} time The time position, in seconds.\n */\n\nPlayer.prototype.seek = function (time) {\n  if (!isValidTime(time)) {\n    this._peaks._logger('peaks.player.seek(): parameter must be a valid time, in seconds');\n    return;\n  }\n  this._adapter.seek(time);\n};\n\n/**\n * Plays the given segment.\n *\n * @param {Segment} segment The segment denoting the time region to play.\n * @param {Boolean} loop If true, playback is looped.\n */\n\nPlayer.prototype.playSegment = function (segment, loop) {\n  var self = this;\n  if (!segment || !isValidTime(segment.startTime) || !isValidTime(segment.endTime)) {\n    return Promise.reject(new Error('peaks.player.playSegment(): parameter must be a segment object'));\n  }\n  self._segment = segment;\n  self._loop = loop;\n\n  // Set audio time to segment start time\n  self.seek(segment.startTime);\n  self._peaks.once('player.playing', function () {\n    if (!self._playingSegment) {\n      self._playingSegment = true;\n\n      // We need to use requestAnimationFrame here as the timeupdate event\n      // doesn't fire often enough.\n      window.requestAnimationFrame(self._playSegmentTimerCallback);\n    }\n  });\n\n  // Start playing audio\n  return self.play();\n};\nPlayer.prototype._playSegmentTimerCallback = function () {\n  if (!this.isPlaying()) {\n    this._playingSegment = false;\n    return;\n  } else if (this.getCurrentTime() >= this._segment.endTime) {\n    if (this._loop) {\n      this.seek(this._segment.startTime);\n    } else {\n      this.pause();\n      this._peaks.emit('player.ended');\n      this._playingSegment = false;\n      return;\n    }\n  }\n  window.requestAnimationFrame(this._playSegmentTimerCallback);\n};\nPlayer.prototype._setSource = function (options) {\n  return this._adapter.setSource(options);\n};\n\n/**\n * @file\n *\n * Defines the {@link DefaultPointMarker} class.\n *\n * @module default-point-marker\n */\n\n\n/**\n * Creates a point marker handle.\n *\n * @class\n * @alias DefaultPointMarker\n *\n * @param {CreatePointMarkerOptions} options\n */\n\nfunction DefaultPointMarker(options) {\n  this._options = options;\n  this._draggable = options.editable;\n}\nDefaultPointMarker.prototype.init = function (group) {\n  var handleWidth = 10;\n  var handleHeight = 20;\n  var handleX = -5 + 0.5; // Place in the middle of the marker\n\n  // Label\n\n  if (this._options.view === 'zoomview') {\n    // Label - create with default y, the real value is set in fitToView().\n    this._label = new Text({\n      x: 2,\n      y: 0,\n      text: this._options.point.labelText,\n      textAlign: 'left',\n      fontFamily: this._options.fontFamily || 'sans-serif',\n      fontSize: this._options.fontSize || 10,\n      fontStyle: this._options.fontStyle || 'normal',\n      fill: '#000'\n    });\n  }\n\n  // Handle - create with default y, the real value is set in fitToView().\n\n  this._handle = new Rect({\n    x: handleX,\n    y: 0,\n    width: handleWidth,\n    height: handleHeight,\n    fill: this._options.color,\n    visible: this._draggable\n  });\n\n  // Line - create with default y and points, the real values\n  // are set in fitToView().\n  this._line = new Line({\n    x: 0,\n    y: 0,\n    stroke: this._options.color,\n    strokeWidth: 1\n  });\n\n  // Time label - create with default y, the real value is set\n  // in fitToView().\n  this._time = new Text({\n    x: -24,\n    y: 0,\n    text: this._options.layer.formatTime(this._options.point.time),\n    fontFamily: this._options.fontFamily,\n    fontSize: this._options.fontSize,\n    fontStyle: this._options.fontStyle,\n    fill: '#000',\n    textAlign: 'center'\n  });\n  this._time.hide();\n  group.add(this._handle);\n  group.add(this._line);\n  if (this._label) {\n    group.add(this._label);\n  }\n  group.add(this._time);\n  this.fitToView();\n  this.bindEventHandlers(group);\n};\nDefaultPointMarker.prototype.bindEventHandlers = function (group) {\n  var self = this;\n  self._handle.on('mouseover touchstart', function () {\n    if (self._draggable) {\n      // Position text to the left of the marker\n      self._time.setX(-24 - self._time.getWidth());\n      self._time.show();\n    }\n  });\n  self._handle.on('mouseout touchend', function () {\n    if (self._draggable) {\n      self._time.hide();\n    }\n  });\n  group.on('dragstart', function () {\n    self._time.setX(-24 - self._time.getWidth());\n    self._time.show();\n  });\n  group.on('dragend', function () {\n    self._time.hide();\n  });\n};\nDefaultPointMarker.prototype.fitToView = function () {\n  var height = this._options.layer.getHeight();\n  this._line.points([0.5, 0, 0.5, height]);\n  if (this._label) {\n    this._label.y(12);\n  }\n  if (this._handle) {\n    this._handle.y(height / 2 - 10.5);\n  }\n  if (this._time) {\n    this._time.y(height / 2 - 5);\n  }\n};\nDefaultPointMarker.prototype.update = function (options) {\n  if (options.time !== undefined) {\n    if (this._time) {\n      this._time.setText(this._options.layer.formatTime(options.time));\n    }\n  }\n  if (options.labelText !== undefined) {\n    if (this._label) {\n      this._label.text(options.labelText);\n    }\n  }\n  if (options.color !== undefined) {\n    if (this._handle) {\n      this._handle.fill(options.color);\n    }\n    this._line.stroke(options.color);\n  }\n  if (options.editable !== undefined) {\n    this._draggable = options.editable;\n    this._handle.visible(this._draggable);\n  }\n};\n\n/**\n * @file\n *\n * Defines the {@link DefaultSegmentMarker} class.\n *\n * @module default-segment-marker\n */\n\n\n/**\n * Creates a segment marker handle.\n *\n * @class\n * @alias DefaultSegmentMarker\n *\n * @param {CreateSegmentMarkerOptions} options\n */\n\nfunction DefaultSegmentMarker(options) {\n  this._options = options;\n  this._editable = options.editable;\n}\nDefaultSegmentMarker.prototype.init = function (group) {\n  var handleWidth = 10;\n  var handleHeight = 20;\n  var handleX = -5 + 0.5; // Place in the middle of the marker\n\n  var xPosition = this._options.startMarker ? -24 : 24;\n  var time = this._options.startMarker ? this._options.segment.startTime : this._options.segment.endTime;\n\n  // Label - create with default y, the real value is set in fitToView().\n  this._label = new Text({\n    x: xPosition,\n    y: 0,\n    text: this._options.layer.formatTime(time),\n    fontFamily: this._options.fontFamily,\n    fontSize: this._options.fontSize,\n    fontStyle: this._options.fontStyle,\n    fill: '#000',\n    textAlign: 'center',\n    visible: this._editable\n  });\n  this._label.hide();\n\n  // Handle - create with default y, the real value is set in fitToView().\n  this._handle = new Rect({\n    x: handleX,\n    y: 0,\n    width: handleWidth,\n    height: handleHeight,\n    fill: this._options.color,\n    stroke: this._options.color,\n    strokeWidth: 1,\n    visible: this._editable\n  });\n\n  // Vertical Line - create with default y and points, the real values\n  // are set in fitToView().\n  this._line = new Line({\n    x: 0,\n    y: 0,\n    stroke: this._options.color,\n    strokeWidth: 1,\n    visible: this._editable\n  });\n  group.add(this._label);\n  group.add(this._line);\n  group.add(this._handle);\n  this.fitToView();\n  this.bindEventHandlers(group);\n};\nDefaultSegmentMarker.prototype.bindEventHandlers = function (group) {\n  var self = this;\n  var xPosition = self._options.startMarker ? -24 : 24;\n  group.on('dragstart', function () {\n    if (self._options.startMarker) {\n      self._label.setX(xPosition - self._label.getWidth());\n    }\n    self._label.show();\n  });\n  group.on('dragend', function () {\n    self._label.hide();\n  });\n  self._handle.on('mouseover touchstart', function () {\n    if (self._options.startMarker) {\n      self._label.setX(xPosition - self._label.getWidth());\n    }\n    self._label.show();\n  });\n  self._handle.on('mouseout touchend', function () {\n    self._label.hide();\n  });\n};\nDefaultSegmentMarker.prototype.fitToView = function () {\n  var height = this._options.layer.getHeight();\n  this._label.y(height / 2 - 5);\n  this._handle.y(height / 2 - 10.5);\n  this._line.points([0.5, 0, 0.5, height]);\n};\nDefaultSegmentMarker.prototype.update = function (options) {\n  if (options.startTime !== undefined && this._options.startMarker) {\n    this._label.text(this._options.layer.formatTime(options.startTime));\n  }\n  if (options.endTime !== undefined && !this._options.startMarker) {\n    this._label.text(this._options.layer.formatTime(options.endTime));\n  }\n  if (options.editable !== undefined) {\n    this._editable = options.editable;\n    this._label.visible(this._editable);\n    this._handle.visible(this._editable);\n    this._line.visible(this._editable);\n  }\n};\n\n/**\n * @file\n *\n * Factory functions for creating point and segment marker handles.\n *\n * @module marker-factories\n */\n\n\n/**\n * Parameters for the {@link createSegmentMarker} function.\n *\n * @typedef {Object} CreateSegmentMarkerOptions\n * @global\n * @property {Segment} segment\n * @property {Boolean} draggable If true, marker is draggable.\n * @property {Boolean} startMarker\n * @property {String} color\n * @property {String} fontFamily\n * @property {Number} fontSize\n * @property {String} fontStyle\n * @property {Layer} layer\n * @property {String} view\n * @property {SegmentDisplayOptions} segmentOptions\n */\n\n/**\n * Creates a left or right side segment marker handle.\n *\n * @param {CreateSegmentMarkerOptions} options\n * @returns {Marker}\n */\n\nfunction createSegmentMarker(options) {\n  if (options.view === 'zoomview') {\n    return new DefaultSegmentMarker(options);\n  }\n  return null;\n}\n\n/**\n * Parameters for the {@link createSegmentLabel} function.\n *\n * @typedef {Object} SegmentLabelOptions\n * @global\n * @property {Segment} segment The {@link Segment} object associated with this\n *   label.\n * @property {String} view The name of the view that the label is being\n *   created in, either <code>zoomview</code> or <code>overview</code>.\n * @property {SegmentsLayer} layer\n * @property {String} fontFamily\n * @property {Number} fontSize\n * @property {String} fontStyle\n */\n\n/**\n * Creates a Konva object that renders information about a segment, such as\n * its label text.\n *\n * @param {SegmentLabelOptions} options\n * @returns {Konva.Text}\n */\n\nfunction createSegmentLabel(options) {\n  return new Text({\n    x: 12,\n    y: 12,\n    text: options.segment.labelText,\n    textAlign: 'center',\n    fontFamily: options.fontFamily || 'sans-serif',\n    fontSize: options.fontSize || 12,\n    fontStyle: options.fontStyle || 'normal',\n    fill: '#000'\n  });\n}\n\n/**\n * Parameters for the {@link createPointMarker} function.\n *\n * @typedef {Object} CreatePointMarkerOptions\n * @global\n * @property {Point} point\n * @property {Boolean} editable If true, marker is draggable.\n * @property {String} color\n * @property {Layer} layer\n * @property {String} view\n * @property {String} fontFamily\n * @property {Number} fontSize\n * @property {String} fontStyle\n */\n\n/**\n * Creates a point marker handle.\n *\n * @param {CreatePointMarkerOptions} options\n * @returns {Marker}\n */\n\nfunction createPointMarker(options) {\n  return new DefaultPointMarker(options);\n}\n\n/**\n * @file\n *\n * Defines the {@link HighlightLayer} class.\n *\n * @module highlight-layer\n */\n\n\n/**\n * Highlight layer options\n *\n * @typedef {Object} HighlightLayerOptions\n * @global\n * @property {Number} highlightOffset\n * @property {String} highlightColor\n * @property {String} highlightStrokeColor\n * @property {Number} highlightOpacity\n * @property {Number} highlightCornerRadius\n */\n\n/**\n * Creates the highlight region that shows the position of the zoomable\n * waveform view in the overview waveform.\n *\n * @class\n * @alias HighlightLayer\n *\n * @param {WaveformOverview} view\n * @param {HighlightLayerOptions} options\n */\n\nfunction HighlightLayer(view, options) {\n  this._view = view;\n  this._offset = options.highlightOffset;\n  this._color = options.highlightColor;\n  this._layer = new Konva.Layer({\n    listening: false\n  });\n  this._highlightRect = null;\n  this._startTime = null;\n  this._endTime = null;\n  this._strokeColor = options.highlightStrokeColor;\n  this._opacity = options.highlightOpacity;\n  this._cornerRadius = options.highlightCornerRadius;\n}\nHighlightLayer.prototype.addToStage = function (stage) {\n  stage.add(this._layer);\n};\nHighlightLayer.prototype.showHighlight = function (startTime, endTime) {\n  if (!this._highlightRect) {\n    this._createHighlightRect(startTime, endTime);\n  }\n  this._update(startTime, endTime);\n};\n\n/**\n * Updates the position of the highlight region.\n *\n * @param {Number} startTime The start of the highlight region, in seconds.\n * @param {Number} endTime The end of the highlight region, in seconds.\n */\n\nHighlightLayer.prototype._update = function (startTime, endTime) {\n  this._startTime = startTime;\n  this._endTime = endTime;\n  var startOffset = this._view.timeToPixels(startTime);\n  var endOffset = this._view.timeToPixels(endTime);\n  this._highlightRect.setAttrs({\n    x: startOffset,\n    width: endOffset - startOffset\n  });\n};\nHighlightLayer.prototype._createHighlightRect = function (startTime, endTime) {\n  this._startTime = startTime;\n  this._endTime = endTime;\n  var startOffset = this._view.timeToPixels(startTime);\n  var endOffset = this._view.timeToPixels(endTime);\n\n  // Create with default y and height, the real values are set in fitToView().\n  this._highlightRect = new Rect({\n    x: startOffset,\n    y: 0,\n    width: endOffset - startOffset,\n    height: 0,\n    stroke: this._strokeColor,\n    strokeWidth: 1,\n    fill: this._color,\n    opacity: this._opacity,\n    cornerRadius: this._cornerRadius\n  });\n  this.fitToView();\n  this._layer.add(this._highlightRect);\n};\nHighlightLayer.prototype.removeHighlight = function () {\n  if (this._highlightRect) {\n    this._highlightRect.destroy();\n    this._highlightRect = null;\n  }\n};\nHighlightLayer.prototype.updateHighlight = function () {\n  if (this._highlightRect) {\n    this._update(this._startTime, this._endTime);\n  }\n};\nHighlightLayer.prototype.fitToView = function () {\n  if (this._highlightRect) {\n    var height = this._view.getHeight();\n    var offset = clamp(this._offset, 0, Math.floor(height / 2));\n    this._highlightRect.setAttrs({\n      y: offset,\n      height: height - offset * 2\n    });\n  }\n};\n\n/**\n * @file\n *\n * Defines the {@link PointMarker} class.\n *\n * @module point-marker\n */\n\n\n/**\n * Parameters for the {@link PointMarker} constructor.\n *\n * @typedef {Object} PointMarkerOptions\n * @global\n * @property {Point} point Point object with timestamp.\n * @property {Boolean} editable If true, marker is draggable.\n * @property {Marker} marker\n * @property {Function} onclick\n * @property {Function} onDblClick\n * @property {Function} onDragStart\n * @property {Function} onDragMove Callback during mouse drag operations.\n * @property {Function} onDragEnd\n * @property {Function} dragBoundFunc\n * @property {Function} onMouseEnter\n * @property {Function} onMouseLeave\n * @property {Function} onContextMenu\n */\n\n/**\n * Creates a point marker handle.\n *\n * @class\n * @alias PointMarker\n *\n * @param {PointMarkerOptions} options\n */\n\nfunction PointMarker(options) {\n  this._point = options.point;\n  this._marker = options.marker;\n  this._draggable = options.draggable;\n  this._onDragStart = options.onDragStart;\n  this._onDragMove = options.onDragMove;\n  this._onDragEnd = options.onDragEnd;\n  this._dragBoundFunc = options.dragBoundFunc;\n  this._onMouseEnter = options.onMouseEnter;\n  this._onMouseLeave = options.onMouseLeave;\n  this._group = new Konva.Group({\n    name: 'point-marker',\n    point: this._point,\n    draggable: this._draggable,\n    dragBoundFunc: options.dragBoundFunc\n  });\n  this._bindDefaultEventHandlers();\n  this._marker.init(this._group);\n}\nPointMarker.prototype._bindDefaultEventHandlers = function () {\n  var self = this;\n  self._group.on('dragstart', function (event) {\n    self._onDragStart(event, self._point);\n  });\n  self._group.on('dragmove', function (event) {\n    self._onDragMove(event, self._point);\n  });\n  self._group.on('dragend', function (event) {\n    self._onDragEnd(event, self._point);\n  });\n  self._group.on('mouseenter', function (event) {\n    self._onMouseEnter(event, self._point);\n  });\n  self._group.on('mouseleave', function (event) {\n    self._onMouseLeave(event, self._point);\n  });\n};\n\n/**\n * @param {Konva.Layer} layer\n */\n\nPointMarker.prototype.addToLayer = function (layer) {\n  layer.add(this._group);\n};\nPointMarker.prototype.fitToView = function () {\n  this._marker.fitToView();\n};\nPointMarker.prototype.getPoint = function () {\n  return this._point;\n};\nPointMarker.prototype.getX = function () {\n  return this._group.getX();\n};\nPointMarker.prototype.setX = function (x) {\n  this._group.setX(x);\n};\nPointMarker.prototype.getWidth = function () {\n  return this._group.getWidth();\n};\nPointMarker.prototype.getAbsolutePosition = function () {\n  return this._group.getAbsolutePosition();\n};\nPointMarker.prototype.update = function (options) {\n  if (options.editable !== undefined) {\n    this._group.draggable(options.editable);\n  }\n  if (this._marker.update) {\n    this._marker.update(options);\n  }\n};\nPointMarker.prototype.destroy = function () {\n  if (this._marker.destroy) {\n    this._marker.destroy();\n  }\n  this._group.destroyChildren();\n  this._group.destroy();\n};\n\n/**\n * @file\n *\n * Defines the {@link PointsLayer} class.\n *\n * @module points-layer\n */\n\n\n/**\n * Creates a Konva.Layer that displays point markers against the audio\n * waveform.\n *\n * @class\n * @alias PointsLayer\n *\n * @param {Peaks} peaks\n * @param {WaveformOverview|WaveformZoomView} view\n * @param {Boolean} enableEditing\n */\n\nfunction PointsLayer(peaks, view, enableEditing) {\n  this._peaks = peaks;\n  this._view = view;\n  this._enableEditing = enableEditing;\n  this._pointMarkers = {};\n  this._layer = new Konva.Layer();\n  this._onPointsDrag = this._onPointsDrag.bind(this);\n  this._onPointMarkerDragStart = this._onPointMarkerDragStart.bind(this);\n  this._onPointMarkerDragMove = this._onPointMarkerDragMove.bind(this);\n  this._onPointMarkerDragEnd = this._onPointMarkerDragEnd.bind(this);\n  this._pointMarkerDragBoundFunc = this._pointMarkerDragBoundFunc.bind(this);\n  this._onPointMarkerMouseEnter = this._onPointMarkerMouseEnter.bind(this);\n  this._onPointMarkerMouseLeave = this._onPointMarkerMouseLeave.bind(this);\n  this._onPointsUpdate = this._onPointsUpdate.bind(this);\n  this._onPointsAdd = this._onPointsAdd.bind(this);\n  this._onPointsRemove = this._onPointsRemove.bind(this);\n  this._onPointsRemoveAll = this._onPointsRemoveAll.bind(this);\n  this._peaks.on('points.update', this._onPointsUpdate);\n  this._peaks.on('points.add', this._onPointsAdd);\n  this._peaks.on('points.remove', this._onPointsRemove);\n  this._peaks.on('points.remove_all', this._onPointsRemoveAll);\n  this._peaks.on('points.dragstart', this._onPointsDrag);\n  this._peaks.on('points.dragmove', this._onPointsDrag);\n  this._peaks.on('points.dragend', this._onPointsDrag);\n}\n\n/**\n * Adds the layer to the given {Konva.Stage}.\n *\n * @param {Konva.Stage} stage\n */\n\nPointsLayer.prototype.addToStage = function (stage) {\n  stage.add(this._layer);\n};\nPointsLayer.prototype.setListening = function (listening) {\n  this._layer.listening(listening);\n};\nPointsLayer.prototype.enableEditing = function (enable) {\n  this._enableEditing = enable;\n};\nPointsLayer.prototype.getPointMarker = function (point) {\n  return this._pointMarkers[point.pid];\n};\nPointsLayer.prototype.formatTime = function (time) {\n  return this._view.formatTime(time);\n};\nPointsLayer.prototype._onPointsUpdate = function (point, options) {\n  var frameStartTime = this._view.getStartTime();\n  var frameEndTime = this._view.getEndTime();\n  var pointMarker = this.getPointMarker(point);\n  var isVisible = point.isVisible(frameStartTime, frameEndTime);\n  if (pointMarker && !isVisible) {\n    // Remove point marker that is no longer visible.\n    this._removePoint(point);\n  } else if (!pointMarker && isVisible) {\n    // Add point marker for visible point.\n    this._updatePoint(point);\n  } else if (pointMarker && isVisible) {\n    // Update the point marker with the changed attributes.\n    if (objectHasProperty(options, 'time')) {\n      var pointMarkerOffset = this._view.timeToPixels(point.time);\n      var pointMarkerX = pointMarkerOffset - this._view.getFrameOffset();\n      pointMarker.setX(pointMarkerX);\n    }\n    pointMarker.update(options);\n  }\n};\nPointsLayer.prototype._onPointsAdd = function (event) {\n  var self = this;\n  var frameStartTime = self._view.getStartTime();\n  var frameEndTime = self._view.getEndTime();\n  event.points.forEach(function (point) {\n    if (point.isVisible(frameStartTime, frameEndTime)) {\n      self._updatePoint(point);\n    }\n  });\n};\nPointsLayer.prototype._onPointsRemove = function (event) {\n  var self = this;\n  event.points.forEach(function (point) {\n    self._removePoint(point);\n  });\n};\nPointsLayer.prototype._onPointsRemoveAll = function () {\n  this._layer.removeChildren();\n  this._pointMarkers = {};\n};\n\n/**\n * Creates the Konva UI objects for a given point.\n *\n * @private\n * @param {Point} point\n * @returns {PointMarker}\n */\n\nPointsLayer.prototype._createPointMarker = function (point) {\n  var editable = this._enableEditing && point.editable;\n  var viewOptions = this._view.getViewOptions();\n  var marker = this._peaks.options.createPointMarker({\n    point: point,\n    editable: editable,\n    color: point.color,\n    fontFamily: viewOptions.fontFamily,\n    fontSize: viewOptions.fontSize,\n    fontStyle: viewOptions.fontStyle,\n    layer: this,\n    view: this._view.getName()\n  });\n  return new PointMarker({\n    point: point,\n    draggable: editable,\n    marker: marker,\n    onDragStart: this._onPointMarkerDragStart,\n    onDragMove: this._onPointMarkerDragMove,\n    onDragEnd: this._onPointMarkerDragEnd,\n    dragBoundFunc: this._pointMarkerDragBoundFunc,\n    onMouseEnter: this._onPointMarkerMouseEnter,\n    onMouseLeave: this._onPointMarkerMouseLeave\n  });\n};\nPointsLayer.prototype.getHeight = function () {\n  return this._view.getHeight();\n};\n\n/**\n * Adds a Konva UI object to the layer for a given point.\n *\n * @private\n * @param {Point} point\n * @returns {PointMarker}\n */\n\nPointsLayer.prototype._addPointMarker = function (point) {\n  var pointMarker = this._createPointMarker(point);\n  this._pointMarkers[point.pid] = pointMarker;\n  pointMarker.addToLayer(this._layer);\n  return pointMarker;\n};\nPointsLayer.prototype._onPointsDrag = function (event) {\n  var pointMarker = this._updatePoint(event.point);\n  pointMarker.update({\n    time: event.point.time\n  });\n};\n\n/**\n * @param {KonvaEventObject} event\n * @param {Point} point\n */\n\nPointsLayer.prototype._onPointMarkerMouseEnter = function (event, point) {\n  this._peaks.emit('points.mouseenter', {\n    point: point,\n    evt: event.evt\n  });\n};\n\n/**\n * @param {KonvaEventObject} event\n * @param {Point} point\n */\n\nPointsLayer.prototype._onPointMarkerMouseLeave = function (event, point) {\n  this._peaks.emit('points.mouseleave', {\n    point: point,\n    evt: event.evt\n  });\n};\n\n/**\n * @param {KonvaEventObject} event\n * @param {Point} point\n */\n\nPointsLayer.prototype._onPointMarkerDragStart = function (event, point) {\n  this._dragPointMarker = this.getPointMarker(point);\n  this._peaks.emit('points.dragstart', {\n    point: point,\n    evt: event.evt\n  });\n};\n\n/**\n * @param {KonvaEventObject} event\n * @param {Point} point\n */\n\nPointsLayer.prototype._onPointMarkerDragMove = function (event, point) {\n  var pointMarker = this._pointMarkers[point.pid];\n  var markerX = pointMarker.getX();\n  var offset = markerX + pointMarker.getWidth();\n  point._setTime(this._view.pixelOffsetToTime(offset));\n  this._peaks.emit('points.dragmove', {\n    point: point,\n    evt: event.evt\n  });\n};\n\n/**\n * @param {KonvaEventObject} event\n * @param {Point} point\n */\n\nPointsLayer.prototype._onPointMarkerDragEnd = function (event, point) {\n  this._dragPointMarker = null;\n  this._peaks.emit('points.dragend', {\n    point: point,\n    evt: event.evt\n  });\n};\nPointsLayer.prototype._pointMarkerDragBoundFunc = function (pos) {\n  // Allow the marker to be moved horizontally but not vertically.\n  return {\n    x: clamp(pos.x, 0, this._view.getWidth()),\n    y: this._dragPointMarker.getAbsolutePosition().y\n  };\n};\n\n/**\n * Updates the positions of all displayed points in the view.\n *\n * @param {Number} startTime The start of the visible range in the view,\n *   in seconds.\n * @param {Number} endTime The end of the visible range in the view,\n *   in seconds.\n */\n\nPointsLayer.prototype.updatePoints = function (startTime, endTime) {\n  // Update all points in the visible time range.\n  var points = this._peaks.points.find(startTime, endTime);\n  points.forEach(this._updatePoint.bind(this));\n\n  // TODO: In the overview all points are visible, so no need to do this.\n  this._removeInvisiblePoints(startTime, endTime);\n};\n\n/**\n * @private\n * @param {Point} point\n */\n\nPointsLayer.prototype._updatePoint = function (point) {\n  var pointMarker = this.getPointMarker(point);\n  if (!pointMarker) {\n    pointMarker = this._addPointMarker(point);\n  }\n  var pointMarkerOffset = this._view.timeToPixels(point.time);\n  var pointMarkerX = pointMarkerOffset - this._view.getFrameOffset();\n  pointMarker.setX(pointMarkerX);\n  return pointMarker;\n};\n\n/**\n * Remove any points that are not visible, i.e., are outside the given time\n * range.\n *\n * @private\n * @param {Number} startTime The start of the visible time range, in seconds.\n * @param {Number} endTime The end of the visible time range, in seconds.\n */\n\nPointsLayer.prototype._removeInvisiblePoints = function (startTime, endTime) {\n  for (var pointPid in this._pointMarkers) {\n    if (objectHasProperty(this._pointMarkers, pointPid)) {\n      var point = this._pointMarkers[pointPid].getPoint();\n      if (!point.isVisible(startTime, endTime)) {\n        this._removePoint(point);\n      }\n    }\n  }\n};\n\n/**\n * Removes the UI object for a given point.\n *\n * @private\n * @param {Point} point\n */\n\nPointsLayer.prototype._removePoint = function (point) {\n  var pointMarker = this.getPointMarker(point);\n  if (pointMarker) {\n    pointMarker.destroy();\n    delete this._pointMarkers[point.pid];\n  }\n};\n\n/**\n * Toggles visibility of the points layer.\n *\n * @param {Boolean} visible\n */\n\nPointsLayer.prototype.setVisible = function (visible) {\n  this._layer.setVisible(visible);\n};\nPointsLayer.prototype.destroy = function () {\n  this._peaks.off('points.update', this._onPointsUpdate);\n  this._peaks.off('points.add', this._onPointsAdd);\n  this._peaks.off('points.remove', this._onPointsRemove);\n  this._peaks.off('points.remove_all', this._onPointsRemoveAll);\n  this._peaks.off('points.dragstart', this._onPointsDrag);\n  this._peaks.off('points.dragmove', this._onPointsDrag);\n  this._peaks.off('points.dragend', this._onPointsDrag);\n};\nPointsLayer.prototype.fitToView = function () {\n  for (var pointPid in this._pointMarkers) {\n    if (objectHasProperty(this._pointMarkers, pointPid)) {\n      var pointMarker = this._pointMarkers[pointPid];\n      pointMarker.fitToView();\n    }\n  }\n};\nPointsLayer.prototype.draw = function () {\n  this._layer.draw();\n};\n\n/**\n * @file\n *\n * Defines the {@link PlayheadLayer} class.\n *\n * @module playhead-layer\n */\n\n\n/**\n * Creates a Konva.Layer that displays a playhead marker.\n *\n * @class\n * @alias PlayheadLayer\n *\n * @param {Player} player\n * @param {WaveformOverview|WaveformZoomView} view\n * @param {Object} options\n * @param {Boolean} options.showPlayheadTime If <code>true</code> The playback time position\n *   is shown next to the playhead.\n * @param {String} options.playheadColor\n * @param {String} options.playheadTextColor\n * @param {String} options.playheadBackgroundColor\n * @param {Number} options.playheadPadding\n * @param {Number} options.playheadWidth\n * @param {String} options.playheadFontFamily\n * @param {Number} options.playheadFontSize\n * @param {String} options.playheadFontStyle\n */\n\nfunction PlayheadLayer(player, view, options) {\n  this._player = player;\n  this._view = view;\n  this._playheadPixel = 0;\n  this._playheadLineAnimation = null;\n  this._playheadVisible = false;\n  this._playheadColor = options.playheadColor;\n  this._playheadTextColor = options.playheadTextColor;\n  this._playheadBackgroundColor = options.playheadBackgroundColor;\n  this._playheadPadding = options.playheadPadding;\n  this._playheadWidth = options.playheadWidth;\n  this._playheadFontFamily = options.playheadFontFamily;\n  this._playheadFontSize = options.playheadFontSize;\n  this._playheadFontStyle = options.playheadFontStyle;\n  this._playheadLayer = new Konva.Layer({\n    listening: false\n  });\n  this._createPlayhead();\n  if (options.showPlayheadTime) {\n    this._createPlayheadText();\n  }\n  this.fitToView();\n  this.zoomLevelChanged();\n}\n\n/**\n * Adds the layer to the given {Konva.Stage}.\n *\n * @param {Konva.Stage} stage\n */\n\nPlayheadLayer.prototype.addToStage = function (stage) {\n  stage.add(this._playheadLayer);\n};\n\n/**\n * Decides whether to use an animation to update the playhead position.\n *\n * If the zoom level is such that the number of pixels per second of audio is\n * low, we can use timeupdate events from the HTMLMediaElement to\n * set the playhead position. Otherwise, we use an animation to update the\n * playhead position more smoothly. The animation is CPU intensive, so we\n * avoid using it where possible.\n */\n\nPlayheadLayer.prototype.zoomLevelChanged = function () {\n  var pixelsPerSecond = this._view.timeToPixels(1.0);\n  this._useAnimation = pixelsPerSecond >= 5;\n  if (this._useAnimation) {\n    if (this._player.isPlaying() && !this._playheadLineAnimation) {\n      // Start the animation\n      this._start();\n    }\n  } else {\n    if (this._playheadLineAnimation) {\n      // Stop the animation\n      var time = this._player.getCurrentTime();\n      this.stop(time);\n    }\n  }\n};\n\n/**\n * Resizes the playhead UI objects to fit the available space in the\n * view.\n */\n\nPlayheadLayer.prototype.fitToView = function () {\n  var height = this._view.getHeight();\n  this._playheadLine.points([0.5, 0, 0.5, height]);\n  if (this._playheadText) {\n    this._playheadText.y(12);\n  }\n};\n\n/**\n * Creates the playhead UI objects.\n *\n * @private\n * @param {String} color\n */\n\nPlayheadLayer.prototype._createPlayhead = function () {\n  // Create with default points, the real values are set in fitToView().\n  this._playheadLine = new Line({\n    stroke: this._playheadColor,\n    strokeWidth: this._playheadWidth\n  });\n  this._playheadGroup = new Konva.Group({\n    x: 0,\n    y: 0\n  });\n  this._playheadGroup.add(this._playheadLine);\n  this._playheadLayer.add(this._playheadGroup);\n};\nPlayheadLayer.prototype._createPlayheadText = function () {\n  var self = this;\n  var time = self._player.getCurrentTime();\n  var text = self._view.formatTime(time);\n\n  // Create with default y, the real value is set in fitToView().\n  self._playheadText = new Text({\n    x: 0,\n    y: 0,\n    padding: self._playheadPadding,\n    text: text,\n    fontSize: self._playheadFontSize,\n    fontFamily: self._playheadFontFamily,\n    fontStyle: self._playheadFontStyle,\n    fill: self._playheadTextColor,\n    align: 'right',\n    sceneFunc: function sceneFunc(context, shape) {\n      var width = shape.width();\n      var height = shape.height() + 2 * self._playheadPadding;\n      context.fillStyle = self._playheadBackgroundColor;\n      context.fillRect(0, -self._playheadPadding, width, height);\n      shape._sceneFunc(context);\n    }\n  });\n  self._playheadGroup.add(self._playheadText);\n};\n\n/**\n * Updates the playhead position.\n *\n * @param {Number} time Current playhead position, in seconds.\n */\n\nPlayheadLayer.prototype.updatePlayheadTime = function (time) {\n  this._syncPlayhead(time);\n  if (this._player.isPlaying()) {\n    this._start();\n  }\n};\n\n/**\n * Updates the playhead position.\n *\n * @private\n * @param {Number} time Current playhead position, in seconds.\n */\n\nPlayheadLayer.prototype._syncPlayhead = function (time) {\n  var pixelIndex = this._view.timeToPixels(time);\n  var frameOffset = this._view.getFrameOffset();\n  var width = this._view.getWidth();\n  var isVisible = pixelIndex >= frameOffset && pixelIndex <= frameOffset + width;\n  this._playheadPixel = pixelIndex;\n  if (isVisible) {\n    var playheadX = this._playheadPixel - frameOffset;\n    if (!this._playheadVisible) {\n      this._playheadVisible = true;\n      this._playheadGroup.show();\n    }\n    this._playheadGroup.setX(playheadX);\n    if (this._playheadText) {\n      var text = this._view.formatTime(time);\n      var playheadTextWidth = this._playheadText.width();\n      this._playheadText.setText(text);\n      if (playheadTextWidth + playheadX > width - 2) {\n        this._playheadText.setX(-playheadTextWidth);\n      } else if (playheadTextWidth + playheadX < width) {\n        this._playheadText.setX(0);\n      }\n    }\n  } else {\n    if (this._playheadVisible) {\n      this._playheadVisible = false;\n      this._playheadGroup.hide();\n    }\n  }\n  if (this._view.playheadPosChanged) {\n    this._view.playheadPosChanged(time);\n  }\n};\n\n/**\n * Starts a playhead animation in sync with the media playback.\n *\n * @private\n */\n\nPlayheadLayer.prototype._start = function () {\n  var self = this;\n  if (self._playheadLineAnimation) {\n    self._playheadLineAnimation.stop();\n    self._playheadLineAnimation = null;\n  }\n  if (!self._useAnimation) {\n    return;\n  }\n  var lastPlayheadPosition = null;\n  self._playheadLineAnimation = new Animation(function () {\n    var time = self._player.getCurrentTime();\n    var playheadPosition = self._view.timeToPixels(time);\n    if (playheadPosition !== lastPlayheadPosition) {\n      self._syncPlayhead(time);\n      lastPlayheadPosition = playheadPosition;\n    }\n  }, self._playheadLayer);\n  self._playheadLineAnimation.start();\n};\nPlayheadLayer.prototype.stop = function (time) {\n  if (this._playheadLineAnimation) {\n    this._playheadLineAnimation.stop();\n    this._playheadLineAnimation = null;\n  }\n  this._syncPlayhead(time);\n};\nPlayheadLayer.prototype.getPlayheadPixel = function () {\n  return this._playheadPixel;\n};\nPlayheadLayer.prototype.showPlayheadTime = function (show) {\n  if (show) {\n    if (!this._playheadText) {\n      // Create it\n      this._createPlayheadText(this._playheadTextColor, this._playheadBackgroundColor, this._playheadPadding);\n      this.fitToView();\n    }\n  } else {\n    if (this._playheadText) {\n      this._playheadText.remove();\n      this._playheadText.destroy();\n      this._playheadText = null;\n    }\n  }\n};\nPlayheadLayer.prototype.updatePlayheadText = function () {\n  if (this._playheadText) {\n    var time = this._player.getCurrentTime();\n    var text = this._view.formatTime(time);\n    this._playheadText.setText(text);\n  }\n};\nPlayheadLayer.prototype.destroy = function () {\n  if (this._playheadLineAnimation) {\n    this._playheadLineAnimation.stop();\n    this._playheadLineAnimation = null;\n  }\n};\n\n/**\n * @file\n *\n * Defines the {@link OverlaySegmentMarker} class.\n *\n * @module overlay-segment-marker\n */\n\n\n/**\n * Creates a segment marker handle.\n *\n * @class\n * @alias OverlaySegmentMarker\n *\n * @param {CreateSegmentMarkerOptions} options\n */\n\nfunction OverlaySegmentMarker(options) {\n  this._options = options;\n}\nOverlaySegmentMarker.prototype.init = function (group) {\n  var handleWidth = 10;\n  var handleHeight = 20;\n  var handleX = -5 + 0.5; // Place in the middle of the marker\n\n  var xPosition = this._options.startMarker ? -24 : 24;\n  var time = this._options.startMarker ? this._options.segment.startTime : this._options.segment.endTime;\n\n  // Label - create with default y, the real value is set in fitToView().\n  this._label = new Text({\n    x: xPosition,\n    y: 0,\n    text: this._options.layer.formatTime(time),\n    fontFamily: this._options.fontFamily,\n    fontSize: this._options.fontSize,\n    fontStyle: this._options.fontStyle,\n    fill: '#000',\n    textAlign: 'center',\n    visible: false\n  });\n\n  // Handle - create with default y, the real value is set in fitToView().\n  this._handle = new Rect({\n    x: handleX,\n    y: 0,\n    width: handleWidth,\n    height: handleHeight\n  });\n  group.add(this._label);\n  group.add(this._handle);\n  this.fitToView();\n  this.bindEventHandlers(group);\n};\nOverlaySegmentMarker.prototype.bindEventHandlers = function (group) {\n  var self = this;\n  var xPosition = self._options.startMarker ? -24 : 24;\n  group.on('dragstart', function () {\n    if (self._options.startMarker) {\n      self._label.setX(xPosition - self._label.getWidth());\n    }\n    self._label.show();\n  });\n  group.on('dragend', function () {\n    self._label.hide();\n  });\n  self._handle.on('mouseover touchstart', function () {\n    if (self._options.startMarker) {\n      self._label.setX(xPosition - self._label.getWidth());\n    }\n    self._label.show();\n    document.body.style.cursor = 'ew-resize';\n  });\n  self._handle.on('mouseout touchend', function () {\n    self._label.hide();\n    document.body.style.cursor = 'default';\n  });\n};\nOverlaySegmentMarker.prototype.fitToView = function () {\n  var viewHeight = this._options.layer.getHeight();\n  var overlayOffset = this._options.segmentOptions.overlayOffset;\n  var overlayRectHeight = clamp(0, viewHeight - 2 * overlayOffset);\n  this._label.y(viewHeight / 2 - 5);\n  this._handle.y(overlayOffset);\n  this._handle.height(overlayRectHeight);\n};\nOverlaySegmentMarker.prototype.update = function (options) {\n  if (options.startTime !== undefined && this._options.startMarker) {\n    this._label.text(this._options.layer.formatTime(options.startTime));\n  }\n  if (options.endTime !== undefined && !this._options.startMarker) {\n    this._label.text(this._options.layer.formatTime(options.endTime));\n  }\n};\n\n/**\n * @file\n *\n * Defines the {@link SegmentMarker} class.\n *\n * @module segment-marker\n */\n\n\n/**\n * Parameters for the {@link SegmentMarker} constructor.\n *\n * @typedef {Object} SegmentMarkerOptions\n * @global\n * @property {Segment} segment\n * @property {SegmentShape} segmentShape\n * @property {Boolean} editable If true, marker is draggable.\n * @property {Boolean} startMarker If <code>true</code>, the marker indicates\n *   the start time of the segment. If <code>false</code>, the marker\n *   indicates the end time of the segment.\n * @property {Function} onDragStart\n * @property {Function} onDragMove\n * @property {Function} onDragEnd\n * @property {Function} dragBoundFunc\n */\n\n/**\n * Creates a segment handle marker for the start or end of a segment.\n *\n * @class\n * @alias SegmentMarker\n *\n * @param {SegmentMarkerOptions} options\n */\n\nfunction SegmentMarker(options) {\n  var self = this;\n  self._segment = options.segment;\n  self._marker = options.marker;\n  self._segmentShape = options.segmentShape;\n  self._editable = options.editable;\n  self._startMarker = options.startMarker;\n  self._onClick = options.onClick;\n  self._onDragStart = options.onDragStart;\n  self._onDragMove = options.onDragMove;\n  self._onDragEnd = options.onDragEnd;\n  self._group = new Konva.Group({\n    name: 'segment-marker',\n    segment: self._segment,\n    draggable: self._editable,\n    visible: self._editable,\n    dragBoundFunc: function dragBoundFunc(pos) {\n      return options.dragBoundFunc(self, pos);\n    }\n  });\n  self._bindDefaultEventHandlers();\n  self._marker.init(self._group);\n}\nSegmentMarker.prototype._bindDefaultEventHandlers = function () {\n  var self = this;\n  self._group.on('click', function (event) {\n    self._onClick(self, event);\n  });\n  self._group.on('dragstart', function (event) {\n    self._onDragStart(self, event);\n  });\n  self._group.on('dragmove', function (event) {\n    self._onDragMove(self, event);\n  });\n  self._group.on('dragend', function (event) {\n    self._onDragEnd(self, event);\n  });\n};\nSegmentMarker.prototype.addToLayer = function (layer) {\n  layer.add(this._group);\n};\nSegmentMarker.prototype.moveToTop = function () {\n  this._group.moveToTop();\n};\nSegmentMarker.prototype.fitToView = function () {\n  this._marker.fitToView();\n};\nSegmentMarker.prototype.getSegment = function () {\n  return this._segment;\n};\nSegmentMarker.prototype.getX = function () {\n  return this._group.getX();\n};\nSegmentMarker.prototype.setX = function (x) {\n  this._group.setX(x);\n};\nSegmentMarker.prototype.getWidth = function () {\n  return this._group.getWidth();\n};\nSegmentMarker.prototype.getAbsolutePosition = function () {\n  return this._group.getAbsolutePosition();\n};\nSegmentMarker.prototype.isStartMarker = function () {\n  return this._startMarker;\n};\nSegmentMarker.prototype.update = function (options) {\n  if (options.editable !== undefined) {\n    this._group.visible(options.editable);\n    this._group.draggable(options.editable);\n  }\n  if (this._marker.update) {\n    this._marker.update(options);\n  }\n};\nSegmentMarker.prototype.destroy = function () {\n  if (this._marker.destroy) {\n    this._marker.destroy();\n  }\n  this._group.destroyChildren();\n  this._group.destroy();\n};\nSegmentMarker.prototype.startDrag = function () {\n  this._group.startDrag();\n};\nSegmentMarker.prototype.stopDrag = function () {\n  this._group.stopDrag();\n};\n\n/**\n * @file\n *\n * Defines the {@link WaveformShape} class.\n *\n * @module waveform-shape\n */\n\n\n/**\n * Waveform shape options.\n *\n * @typedef {Object} WaveformShapeOptions\n * @global\n * @property {String | LinearGradientColor} color Waveform color.\n * @property {WaveformOverview|WaveformZoomView} view The view object\n *   that contains the waveform shape.\n * @property {Segment?} segment If given, render a waveform image\n *   covering the segment's time range. Otherwise, render the entire\n *   waveform duration.\n */\n\n/**\n * Creates a Konva.Shape object that renders a waveform image.\n *\n * @class\n * @alias WaveformShape\n *\n * @param {WaveformShapeOptions} options\n */\n\nfunction WaveformShape(options) {\n  this._color = options.color;\n  var shapeOptions = {};\n  if (isString(options.color)) {\n    shapeOptions.fill = options.color;\n  } else if (isLinearGradientColor(options.color)) {\n    var startY = options.view._height * (options.color.linearGradientStart / 100);\n    var endY = options.view._height * (options.color.linearGradientEnd / 100);\n    shapeOptions.fillLinearGradientStartPointY = startY;\n    shapeOptions.fillLinearGradientEndPointY = endY;\n    shapeOptions.fillLinearGradientColorStops = [0, options.color.linearGradientColorStops[0], 1, options.color.linearGradientColorStops[1]];\n  } else {\n    throw new TypeError('Unknown type for color property');\n  }\n  this._shape = new Konva.Shape(shapeOptions);\n  this._view = options.view;\n  this._segment = options.segment;\n  this._shape.sceneFunc(this._sceneFunc.bind(this));\n}\nWaveformShape.prototype.getX = function () {\n  return this._shape.getX();\n};\nWaveformShape.prototype.setX = function (x) {\n  return this._shape.setX(x);\n};\nWaveformShape.prototype.setSegment = function (segment) {\n  this._segment = segment;\n};\nWaveformShape.prototype.setWaveformColor = function (color) {\n  if (isString(color)) {\n    this._shape.fill(color);\n    this._shape.fillLinearGradientStartPointY(null);\n    this._shape.fillLinearGradientEndPointY(null);\n    this._shape.fillLinearGradientColorStops(null);\n  } else if (isLinearGradientColor(color)) {\n    this._shape.fill(null);\n    var startY = this._view._height * (color.linearGradientStart / 100);\n    var endY = this._view._height * (color.linearGradientEnd / 100);\n    this._shape.fillLinearGradientStartPointY(startY);\n    this._shape.fillLinearGradientEndPointY(endY);\n    this._shape.fillLinearGradientColorStops([0, color.linearGradientColorStops[0], 1, color.linearGradientColorStops[1]]);\n  } else {\n    throw new TypeError('Unknown type for color property');\n  }\n};\nWaveformShape.prototype.fitToView = function () {\n  this.setWaveformColor(this._color);\n};\nWaveformShape.prototype._sceneFunc = function (context) {\n  var frameOffset = this._view.getFrameOffset();\n  var width = this._view.getWidth();\n  var height = this._view.getHeight();\n  this._drawWaveform(context, this._view.getWaveformData(), frameOffset, this._segment ? this._view.timeToPixels(this._segment.startTime) : frameOffset, this._segment ? this._view.timeToPixels(this._segment.endTime) : frameOffset + width, width, height);\n};\n\n/**\n * Draws a waveform on a canvas context.\n *\n * @param {Konva.Context} context The canvas context to draw on.\n * @param {WaveformData} waveformData The waveform data to draw.\n * @param {Number} frameOffset The start position of the waveform shown\n *   in the view, in pixels.\n * @param {Number} startPixels The start position of the waveform to draw,\n *   in pixels.\n * @param {Number} endPixels The end position of the waveform to draw,\n *   in pixels.\n * @param {Number} width The width of the waveform area, in pixels.\n * @param {Number} height The height of the waveform area, in pixels.\n */\n\nWaveformShape.prototype._drawWaveform = function (context, waveformData, frameOffset, startPixels, endPixels, width, height) {\n  if (startPixels < frameOffset) {\n    startPixels = frameOffset;\n  }\n  var limit = frameOffset + width;\n  if (endPixels > limit) {\n    endPixels = limit;\n  }\n  if (endPixels > waveformData.length - 1) {\n    endPixels = waveformData.length - 1;\n  }\n  var channels = waveformData.channels;\n  var waveformTop = 0;\n  var waveformHeight = Math.floor(height / channels);\n  for (var i = 0; i < channels; i++) {\n    if (i === channels - 1) {\n      waveformHeight = height - (channels - 1) * waveformHeight;\n    }\n    this._drawChannel(context, waveformData.channel(i), frameOffset, startPixels, endPixels, waveformTop, waveformHeight);\n    waveformTop += waveformHeight;\n  }\n};\n\n/**\n * Draws a single waveform channel on a canvas context.\n *\n * @param {Konva.Context} context The canvas context to draw on.\n * @param {WaveformDataChannel} channel The waveform data to draw.\n * @param {Number} frameOffset The start position of the waveform shown\n *   in the view, in pixels.\n * @param {Number} startPixels The start position of the waveform to draw,\n *   in pixels.\n * @param {Number} endPixels The end position of the waveform to draw,\n *   in pixels.\n * @param {Number} top The top of the waveform channel area, in pixels.\n * @param {Number} height The height of the waveform channel area, in pixels.\n */\n\nWaveformShape.prototype._drawChannel = function (context, channel, frameOffset, startPixels, endPixels, top, height) {\n  var x, amplitude;\n  var amplitudeScale = this._view.getAmplitudeScale();\n  var lineX, lineY;\n  context.beginPath();\n  for (x = startPixels; x <= endPixels; x++) {\n    amplitude = channel.min_sample(x);\n    lineX = x - frameOffset + 0.5;\n    lineY = top + WaveformShape.scaleY(amplitude, height, amplitudeScale) + 0.5;\n    context.lineTo(lineX, lineY);\n  }\n  for (x = endPixels; x >= startPixels; x--) {\n    amplitude = channel.max_sample(x);\n    lineX = x - frameOffset + 0.5;\n    lineY = top + WaveformShape.scaleY(amplitude, height, amplitudeScale) + 1.0;\n    context.lineTo(lineX, lineY);\n  }\n  context.closePath();\n  context.fillShape(this._shape);\n};\nWaveformShape.prototype.addToLayer = function (layer) {\n  layer.add(this._shape);\n};\nWaveformShape.prototype.destroy = function () {\n  this._shape.destroy();\n  this._shape = null;\n};\nWaveformShape.prototype.on = function (event, handler) {\n  this._shape.on(event, handler);\n};\nWaveformShape.prototype.off = function (event, handler) {\n  this._shape.off(event, handler);\n};\n\n/**\n * Scales the waveform data for drawing on a canvas context.\n *\n * @see {@link https://stats.stackexchange.com/questions/281162}\n *\n * @todo Assumes 8-bit waveform data (-128 to 127 range)\n *\n * @param {Number} amplitude The waveform data point amplitude.\n * @param {Number} height The height of the waveform, in pixels.\n * @param {Number} scale Amplitude scaling factor.\n * @returns {Number} The scaled waveform data point.\n */\n\nWaveformShape.scaleY = function (amplitude, height, scale) {\n  var y = -(height - 1) * (amplitude * scale + 128) / 255 + (height - 1);\n  return clamp(Math.floor(y), 0, height - 1);\n};\n\n/**\n * @file\n *\n * Defines the {@link SegmentShape} class.\n *\n * @module segment-shape\n */\n\n\n/**\n * Options that control segments' visual appearance\n *\n * @typedef {Object} SegmentDisplayOptions\n * @global\n * @property {Boolean} markers\n * @property {Boolean} overlay\n * @property {String} startMarkerColor\n * @property {String} endMarkerColor\n * @property {String} waveformColor\n * @property {String} overlayColor\n * @property {Number} overlayOpacity\n * @property {String} overlayBorderColor\n * @property {Number} overlayBorderWidth\n * @property {Number} overlayCornerRadius\n * @property {Number} overlayOffset\n * @property {String} overlayLabelAlign\n * @property {String} overlayLabelVerticalAlign\n * @property {Number} overlayLabelPadding\n * @property {String} overlayLabelColor\n * @property {String} overlayFontFamily\n * @property {Number} overlayFontSize\n * @property {String} overlayFontStyle\n */\n\n/**\n * Creates a waveform segment shape with optional start and end markers.\n *\n * @class\n * @alias SegmentShape\n *\n * @param {Segment} segment\n * @param {Peaks} peaks\n * @param {SegmentsLayer} layer\n * @param {WaveformOverview|WaveformZoomView} view\n */\n\nfunction SegmentShape(segment, peaks, layer, view) {\n  this._segment = segment;\n  this._peaks = peaks;\n  this._layer = layer;\n  this._view = view;\n  this._label = null;\n  this._startMarker = null;\n  this._endMarker = null;\n  this._color = segment.color;\n  this._borderColor = segment.borderColor;\n  this._draggable = this._segment.editable && this._view.isSegmentDraggingEnabled();\n  this._dragging = false;\n  var viewOptions = view.getViewOptions();\n  var segmentOptions = viewOptions.segmentOptions;\n  this._overlayOffset = segmentOptions.overlayOffset;\n  if (!segment.overlay) {\n    this._waveformShape = new WaveformShape({\n      color: segment.color,\n      view: view,\n      segment: segment\n    });\n  }\n  this._onMouseEnter = this._onMouseEnter.bind(this);\n  this._onMouseLeave = this._onMouseLeave.bind(this);\n  this._onMouseDown = this._onMouseDown.bind(this);\n  this._onMouseUp = this._onMouseUp.bind(this);\n  this._dragBoundFunc = this._dragBoundFunc.bind(this);\n  this._onSegmentDragStart = this._onSegmentDragStart.bind(this);\n  this._onSegmentDragMove = this._onSegmentDragMove.bind(this);\n  this._onSegmentDragEnd = this._onSegmentDragEnd.bind(this);\n\n  // Event handlers for markers\n  this._onSegmentMarkerClick = this._onSegmentMarkerClick.bind(this);\n  this._onSegmentMarkerDragStart = this._onSegmentMarkerDragStart.bind(this);\n  this._onSegmentMarkerDragMove = this._onSegmentMarkerDragMove.bind(this);\n  this._onSegmentMarkerDragEnd = this._onSegmentMarkerDragEnd.bind(this);\n  this._segmentMarkerDragBoundFunc = this._segmentMarkerDragBoundFunc.bind(this);\n  this._label = this._peaks.options.createSegmentLabel({\n    segment: segment,\n    view: this._view.getName(),\n    layer: this._layer,\n    fontFamily: viewOptions.fontFamily,\n    fontSize: viewOptions.fontSize,\n    fontStyle: viewOptions.fontStyle\n  });\n  if (this._label) {\n    this._label.hide();\n  }\n\n  // Create with default y and height, the real values are set in fitToView().\n  var segmentStartOffset = this._view.timeToPixelOffset(this._segment.startTime);\n  var segmentEndOffset = this._view.timeToPixelOffset(this._segment.endTime);\n  var overlayRectHeight = clamp(0, this._view.getHeight() - 2 * this._overlayOffset);\n\n  // The clip rectangle prevents text in the overlay from appearing\n  // outside the overlay.\n\n  this._overlay = new Konva.Group({\n    name: 'segment-overlay',\n    segment: this._segment,\n    x: segmentStartOffset,\n    y: 0,\n    width: segmentEndOffset - segmentStartOffset,\n    height: this._view.getHeight(),\n    clipX: 0,\n    clipY: this._overlayOffset,\n    clipWidth: segmentEndOffset - segmentStartOffset,\n    clipHeight: overlayRectHeight,\n    draggable: this._draggable,\n    dragBoundFunc: this._dragBoundFunc\n  });\n  var overlayBorderColor, overlayBorderWidth, overlayColor, overlayOpacity, overlayCornerRadius;\n  if (segment.overlay) {\n    overlayBorderColor = this._borderColor || segmentOptions.overlayBorderColor;\n    overlayBorderWidth = segmentOptions.overlayBorderWidth;\n    overlayColor = this._color || segmentOptions.overlayColor;\n    overlayOpacity = segmentOptions.overlayOpacity;\n    overlayCornerRadius = segmentOptions.overlayCornerRadius;\n  }\n  this._overlayRect = new Konva.Rect({\n    x: 0,\n    y: this._overlayOffset,\n    width: segmentEndOffset - segmentStartOffset,\n    stroke: overlayBorderColor,\n    strokeWidth: overlayBorderWidth,\n    height: overlayRectHeight,\n    fill: overlayColor,\n    opacity: overlayOpacity,\n    cornerRadius: overlayCornerRadius\n  });\n  this._overlay.add(this._overlayRect);\n  if (segment.overlay) {\n    this._overlayText = new Konva.Text({\n      x: 0,\n      y: this._overlayOffset,\n      text: this._segment.labelText,\n      fontFamily: segmentOptions.overlayFontFamily,\n      fontSize: segmentOptions.overlayFontSize,\n      fontStyle: segmentOptions.overlayFontStyle,\n      fill: segmentOptions.overlayLabelColor,\n      listening: false,\n      align: segmentOptions.overlayLabelAlign,\n      width: segmentEndOffset - segmentStartOffset,\n      verticalAlign: segmentOptions.overlayLabelVerticalAlign,\n      height: overlayRectHeight,\n      padding: segmentOptions.overlayLabelPadding\n    });\n    this._overlay.add(this._overlayText);\n  }\n\n  // Set up event handlers to show/hide the segment label text when the user\n  // hovers the mouse over the segment.\n  this._overlay.on('mouseenter', this._onMouseEnter);\n  this._overlay.on('mouseleave', this._onMouseLeave);\n  this._overlay.on('mousedown', this._onMouseDown);\n  this._overlay.on('mouseup', this._onMouseUp);\n  if (this._draggable) {\n    this._overlay.on('dragstart', this._onSegmentDragStart);\n    this._overlay.on('dragmove', this._onSegmentDragMove);\n    this._overlay.on('dragend', this._onSegmentDragEnd);\n  }\n  this._createMarkers();\n}\nfunction createOverlayMarker(options) {\n  return new OverlaySegmentMarker(options);\n}\nSegmentShape.prototype._createMarkers = function () {\n  var editable = this._layer.isEditingEnabled() && this._segment.editable;\n  var viewOptions = this._view.getViewOptions();\n  var segmentOptions = viewOptions.segmentOptions;\n  var createSegmentMarker, startMarker, endMarker;\n  if (this._segment.markers) {\n    createSegmentMarker = this._peaks.options.createSegmentMarker;\n  } else if (this._segment.overlay) {\n    createSegmentMarker = createOverlayMarker;\n  }\n  if (createSegmentMarker) {\n    startMarker = createSegmentMarker({\n      segment: this._segment,\n      editable: editable,\n      startMarker: true,\n      color: segmentOptions.startMarkerColor,\n      fontFamily: viewOptions.fontFamily,\n      fontSize: viewOptions.fontSize,\n      fontStyle: viewOptions.fontStyle,\n      layer: this._layer,\n      view: this._view.getName(),\n      segmentOptions: this._view.getViewOptions().segmentOptions\n    });\n  }\n  if (startMarker) {\n    this._startMarker = new SegmentMarker({\n      segment: this._segment,\n      segmentShape: this,\n      editable: editable,\n      startMarker: true,\n      marker: startMarker,\n      onClick: this._onSegmentMarkerClick,\n      onDragStart: this._onSegmentMarkerDragStart,\n      onDragMove: this._onSegmentMarkerDragMove,\n      onDragEnd: this._onSegmentMarkerDragEnd,\n      dragBoundFunc: this._segmentMarkerDragBoundFunc\n    });\n  }\n  if (createSegmentMarker) {\n    endMarker = createSegmentMarker({\n      segment: this._segment,\n      editable: editable,\n      startMarker: false,\n      color: segmentOptions.endMarkerColor,\n      fontFamily: viewOptions.fontFamily,\n      fontSize: viewOptions.fontSize,\n      fontStyle: viewOptions.fontStyle,\n      layer: this._layer,\n      view: this._view.getName(),\n      segmentOptions: this._view.getViewOptions().segmentOptions\n    });\n  }\n  if (endMarker) {\n    this._endMarker = new SegmentMarker({\n      segment: this._segment,\n      segmentShape: this,\n      editable: editable,\n      startMarker: false,\n      marker: endMarker,\n      onClick: this._onSegmentMarkerClick,\n      onDragStart: this._onSegmentMarkerDragStart,\n      onDragMove: this._onSegmentMarkerDragMove,\n      onDragEnd: this._onSegmentMarkerDragEnd,\n      dragBoundFunc: this._segmentMarkerDragBoundFunc\n    });\n  }\n};\nSegmentShape.prototype._dragBoundFunc = function (pos) {\n  // Allow the segment to be moved horizontally but not vertically.\n  return {\n    x: pos.x,\n    y: 0\n  };\n};\n\n/**\n * Update the segment shape after the segment's attributes have changed.\n */\n\nSegmentShape.prototype.update = function (options) {\n  var segmentStartOffset = this._view.timeToPixelOffset(this._segment.startTime);\n  var segmentEndOffset = this._view.timeToPixelOffset(this._segment.endTime);\n  var width = segmentEndOffset - segmentStartOffset;\n  var marker;\n  if (marker = this.getStartMarker()) {\n    marker.setX(segmentStartOffset - marker.getWidth());\n    if (options) {\n      marker.update(options);\n    }\n  }\n  if (marker = this.getEndMarker()) {\n    marker.setX(segmentEndOffset);\n    if (options) {\n      marker.update(options);\n    }\n  }\n  this._color = this._segment.color;\n  this._borderColor = this._segment.bordercolor;\n  if (this._label) {\n    this._label.text(this._segment.labelText);\n  }\n  if (this._overlayText) {\n    this._overlayText.text(this._segment.labelText);\n  }\n  if (this._segment.overlay) {\n    if (this._color) {\n      this._overlayRect.fill(this._color);\n    }\n    if (this._borderColor) {\n      this._overlayRect.stroke(this._borderColor);\n    }\n  } else {\n    this._waveformShape.setWaveformColor(this._segment.color);\n  }\n\n  // While dragging, the overlay position is controlled in _onSegmentDragMove().\n\n  if (!this._dragging) {\n    if (this._overlay) {\n      this._overlay.setAttrs({\n        x: segmentStartOffset,\n        width: width,\n        clipWidth: width < 1 ? 1 : width\n      });\n      this._overlayRect.setAttrs({\n        x: 0,\n        width: width\n      });\n      if (this._overlayText) {\n        this._overlayText.setAttrs({\n          width: width\n        });\n      }\n    }\n  }\n};\nSegmentShape.prototype.getSegment = function () {\n  return this._segment;\n};\nSegmentShape.prototype.getStartMarker = function () {\n  return this._startMarker;\n};\nSegmentShape.prototype.getEndMarker = function () {\n  return this._endMarker;\n};\nSegmentShape.prototype.addToLayer = function (layer) {\n  if (this._waveformShape) {\n    this._waveformShape.addToLayer(layer);\n  }\n  if (this._label) {\n    layer.add(this._label);\n  }\n  if (this._overlay) {\n    layer.add(this._overlay);\n  }\n  if (this._startMarker) {\n    this._startMarker.addToLayer(layer);\n  }\n  if (this._endMarker) {\n    this._endMarker.addToLayer(layer);\n  }\n};\nSegmentShape.prototype.isDragging = function () {\n  return this._dragging;\n};\nSegmentShape.prototype._onMouseEnter = function (event) {\n  if (this._label) {\n    this._label.moveToTop();\n    this._label.show();\n  }\n  this._peaks.emit('segments.mouseenter', {\n    segment: this._segment,\n    evt: event.evt\n  });\n};\nSegmentShape.prototype._onMouseLeave = function (event) {\n  if (this._label) {\n    this._label.hide();\n  }\n  this._peaks.emit('segments.mouseleave', {\n    segment: this._segment,\n    evt: event.evt\n  });\n};\nSegmentShape.prototype._onMouseDown = function (event) {\n  this._peaks.emit('segments.mousedown', {\n    segment: this._segment,\n    evt: event.evt\n  });\n};\nSegmentShape.prototype._onMouseUp = function (event) {\n  this._peaks.emit('segments.mouseup', {\n    segment: this._segment,\n    evt: event.evt\n  });\n};\nSegmentShape.prototype.segmentClicked = function (eventName, event) {\n  this._moveToTop();\n  this._peaks.emit('segments.' + eventName, event);\n};\nSegmentShape.prototype._moveToTop = function () {\n  this._overlay.moveToTop();\n  this._layer.moveSegmentMarkersToTop();\n};\nSegmentShape.prototype.enableSegmentDragging = function (enable) {\n  if (!this._segment.editable) {\n    return;\n  }\n  if (!this._draggable && enable) {\n    this._overlay.on('dragstart', this._onSegmentDragStart);\n    this._overlay.on('dragmove', this._onSegmentDragMove);\n    this._overlay.on('dragend', this._onSegmentDragEnd);\n  } else if (this._draggable && !enable) {\n    this._overlay.off('dragstart', this._onSegmentDragStart);\n    this._overlay.off('dragmove', this._onSegmentDragMove);\n    this._overlay.off('dragend', this._onSegmentDragEnd);\n  }\n  this._overlay.draggable(enable);\n  this._draggable = enable;\n};\nSegmentShape.prototype._setPreviousAndNextSegments = function () {\n  if (this._view.getSegmentDragMode() !== 'overlap') {\n    this._nextSegment = this._peaks.segments.findNextSegment(this._segment);\n    this._previousSegment = this._peaks.segments.findPreviousSegment(this._segment);\n  } else {\n    this._nextSegment = null;\n    this._previousSegment = null;\n  }\n};\nSegmentShape.prototype._onSegmentDragStart = function (event) {\n  this._setPreviousAndNextSegments();\n  this._dragging = true;\n  this._dragStartX = this._overlay.getX();\n  this._dragStartTime = this._segment.startTime;\n  this._dragEndTime = this._segment.endTime;\n  this._peaks.emit('segments.dragstart', {\n    segment: this._segment,\n    marker: false,\n    startMarker: false,\n    evt: event.evt\n  });\n};\nSegmentShape.prototype._onSegmentDragMove = function (event) {\n  var x = this._overlay.getX();\n  var offsetX = x - this._dragStartX;\n  var timeOffset = this._view.pixelsToTime(offsetX);\n\n  // The WaveformShape for a segment fills the canvas width\n  // but only draws a subset of the horizontal range. When dragged\n  // we need to keep the shape object in its position but\n  // update the segment start and end time so that the right\n  // subset is drawn.\n\n  // Calculate new segment start/end time based on drag position. We'll\n  // correct this later based on the drag mode, to prevent overlapping\n  // segments or to compress the adjacent segment.\n\n  var startTime = this._dragStartTime + timeOffset;\n  var endTime = this._dragEndTime + timeOffset;\n  var segmentDuration = this._segment.endTime - this._segment.startTime;\n  var dragMode;\n  var minSegmentWidth = this._view.getMinSegmentDragWidth();\n  var minSegmentDuration = this._view.pixelsToTime(minSegmentWidth);\n  var previousSegmentUpdated = false;\n  var nextSegmentUpdated = false;\n\n  // Prevent the segment from being dragged beyond the start of the waveform.\n\n  if (startTime < 0) {\n    startTime = 0;\n    endTime = segmentDuration;\n    this._overlay.setX(this._view.timeToPixelOffset(startTime));\n  }\n\n  // Adjust segment position if it now overlaps the previous segment?\n\n  if (this._previousSegment) {\n    var previousSegmentEndX = this._view.timeToPixelOffset(this._previousSegment.endTime);\n    if (startTime < this._previousSegment.endTime) {\n      dragMode = this._view.getSegmentDragMode();\n      if (dragMode === 'no-overlap' || dragMode === 'compress' && !this._previousSegment.editable) {\n        startTime = this._previousSegment.endTime;\n        endTime = startTime + segmentDuration;\n        this._overlay.setX(previousSegmentEndX);\n      } else if (dragMode === 'compress') {\n        var previousSegmentEndTime = startTime;\n        var minPreviousSegmentEndTime = this._previousSegment.startTime + minSegmentDuration;\n        if (previousSegmentEndTime < minPreviousSegmentEndTime) {\n          previousSegmentEndTime = minPreviousSegmentEndTime;\n          previousSegmentEndX = this._view.timeToPixelOffset(previousSegmentEndTime);\n          this._overlay.setX(previousSegmentEndX);\n          startTime = previousSegmentEndTime;\n          endTime = startTime + segmentDuration;\n        }\n        this._previousSegment.update({\n          endTime: previousSegmentEndTime\n        });\n        previousSegmentUpdated = true;\n      }\n    }\n  }\n\n  // Adjust segment position if it now overlaps the following segment?\n\n  if (this._nextSegment) {\n    var nextSegmentStartX = this._view.timeToPixelOffset(this._nextSegment.startTime);\n    if (endTime > this._nextSegment.startTime) {\n      dragMode = this._view.getSegmentDragMode();\n      if (dragMode === 'no-overlap' || dragMode === 'compress' && !this._nextSegment.editable) {\n        endTime = this._nextSegment.startTime;\n        startTime = endTime - segmentDuration;\n        this._overlay.setX(nextSegmentStartX - this._overlay.getWidth());\n      } else if (dragMode === 'compress') {\n        var nextSegmentStartTime = endTime;\n        var maxNextSegmentStartTime = this._nextSegment.endTime - minSegmentDuration;\n        if (nextSegmentStartTime > maxNextSegmentStartTime) {\n          nextSegmentStartTime = maxNextSegmentStartTime;\n          nextSegmentStartX = this._view.timeToPixelOffset(nextSegmentStartTime);\n          this._overlay.setX(nextSegmentStartX - this._overlay.getWidth());\n          endTime = nextSegmentStartTime;\n          startTime = endTime - segmentDuration;\n        }\n        this._nextSegment.update({\n          startTime: nextSegmentStartTime\n        });\n        nextSegmentUpdated = true;\n      }\n    }\n  }\n  this._segment._setStartTime(startTime);\n  this._segment._setEndTime(endTime);\n  this._peaks.emit('segments.dragged', {\n    segment: this._segment,\n    marker: false,\n    startMarker: false,\n    evt: event.evt\n  });\n  if (previousSegmentUpdated) {\n    this._peaks.emit('segments.dragged', {\n      segment: this._previousSegment,\n      marker: false,\n      startMarker: false,\n      evt: event.evt\n    });\n  } else if (nextSegmentUpdated) {\n    this._peaks.emit('segments.dragged', {\n      segment: this._nextSegment,\n      marker: false,\n      startMarker: false,\n      evt: event.evt\n    });\n  }\n};\nSegmentShape.prototype._onSegmentDragEnd = function (event) {\n  this._dragging = false;\n  this._peaks.emit('segments.dragend', {\n    segment: this._segment,\n    marker: false,\n    startMarker: false,\n    evt: event.evt\n  });\n};\nSegmentShape.prototype.moveMarkersToTop = function () {\n  if (this._startMarker) {\n    this._startMarker.moveToTop();\n  }\n  if (this._endMarker) {\n    this._endMarker.moveToTop();\n  }\n};\nSegmentShape.prototype.startDrag = function () {\n  if (this._endMarker) {\n    this._endMarker.startDrag();\n  }\n};\nSegmentShape.prototype.stopDrag = function () {\n  if (this._endMarker) {\n    this._endMarker.stopDrag();\n  }\n};\n\n/**\n * @param {SegmentMarker} segmentMarker\n */\n\nSegmentShape.prototype._onSegmentMarkerDragStart = function (segmentMarker, event) {\n  this._setPreviousAndNextSegments();\n\n  // Move this segment to the top of the z-order, so that it remains on top\n  // of any adjacent segments that the marker is dragged over.\n  this._moveToTop();\n  this._startMarkerX = this._startMarker.getX();\n  this._endMarkerX = this._endMarker.getX();\n  this._peaks.emit('segments.dragstart', {\n    segment: this._segment,\n    marker: true,\n    startMarker: segmentMarker.isStartMarker(),\n    evt: event.evt\n  });\n};\n\n/**\n * @param {SegmentMarker} segmentMarker\n */\n\nSegmentShape.prototype._onSegmentMarkerDragMove = function (segmentMarker, event) {\n  if (segmentMarker.isStartMarker()) {\n    this._segmentStartMarkerDragMove(segmentMarker, event);\n    segmentMarker.update({\n      startTime: this._segment.startTime\n    });\n  } else {\n    this._segmentEndMarkerDragMove(segmentMarker, event);\n    segmentMarker.update({\n      endTime: this._segment.endTime\n    });\n  }\n};\nfunction getDuration(segment) {\n  return segment.endTime - segment.startTime;\n}\nSegmentShape.prototype._segmentStartMarkerDragMove = function (segmentMarker, event) {\n  var width = this._view.getWidth();\n  var startMarkerX = this._startMarker.getX();\n  var endMarkerX = this._endMarker.getX();\n  var minSegmentDuration = this._view.pixelsToTime(50);\n  var minSegmentWidth = this._view.getMinSegmentDragWidth();\n  var upperLimit = this._endMarker.getX() - minSegmentWidth;\n  if (upperLimit > width) {\n    upperLimit = width;\n  }\n  var previousSegmentVisible = false;\n  var previousSegmentUpdated = false;\n  var previousSegmentEndX;\n  if (this._previousSegment) {\n    previousSegmentEndX = this._view.timeToPixelOffset(this._previousSegment.endTime);\n    previousSegmentVisible = previousSegmentEndX >= 0;\n  }\n  if (startMarkerX > upperLimit) {\n    segmentMarker.setX(upperLimit);\n    this._overlay.clipWidth(upperLimit - endMarkerX);\n    if (minSegmentWidth === 0 && upperLimit < width) {\n      this._segment._setStartTime(this._segment.endTime);\n    } else {\n      this._segment._setStartTime(this._view.pixelOffsetToTime(upperLimit));\n    }\n  } else if (this._previousSegment && previousSegmentVisible) {\n    var dragMode = this._view.getSegmentDragMode();\n    var fixedPreviousSegment = dragMode === 'no-overlap' || dragMode === 'compress' && !this._previousSegment.editable;\n    var compressPreviousSegment = dragMode === 'compress' && this._previousSegment.editable;\n    if (startMarkerX <= previousSegmentEndX) {\n      if (fixedPreviousSegment) {\n        segmentMarker.setX(previousSegmentEndX);\n        this._overlay.clipWidth(previousSegmentEndX - endMarkerX);\n        this._segment._setStartTime(this._previousSegment.endTime);\n      } else if (compressPreviousSegment) {\n        var previousSegmentDuration = getDuration(this._previousSegment);\n        if (previousSegmentDuration < minSegmentDuration) {\n          minSegmentDuration = previousSegmentDuration;\n        }\n        var lowerLimit = this._view.timeToPixelOffset(this._previousSegment.startTime + minSegmentDuration);\n        if (startMarkerX < lowerLimit) {\n          startMarkerX = lowerLimit;\n        }\n        segmentMarker.setX(startMarkerX);\n        this._overlay.clipWidth(endMarkerX - startMarkerX);\n        this._segment._setStartTime(this._view.pixelOffsetToTime(startMarkerX));\n        this._previousSegment.update({\n          endTime: this._view.pixelOffsetToTime(startMarkerX)\n        });\n        previousSegmentUpdated = true;\n      }\n    } else {\n      if (startMarkerX < 0) {\n        startMarkerX = 0;\n      }\n      segmentMarker.setX(startMarkerX);\n      this._overlay.clipWidth(endMarkerX - startMarkerX);\n      this._segment._setStartTime(this._view.pixelOffsetToTime(startMarkerX));\n    }\n  } else {\n    if (startMarkerX < 0) {\n      startMarkerX = 0;\n    }\n    segmentMarker.setX(startMarkerX);\n    this._overlay.clipWidth(endMarkerX - startMarkerX);\n    this._segment._setStartTime(this._view.pixelOffsetToTime(startMarkerX));\n  }\n  this._peaks.emit('segments.dragged', {\n    segment: this._segment,\n    marker: true,\n    startMarker: true,\n    evt: event.evt\n  });\n  if (previousSegmentUpdated) {\n    this._peaks.emit('segments.dragged', {\n      segment: this._previousSegment,\n      marker: true,\n      startMarker: false,\n      evt: event.evt\n    });\n  }\n};\nSegmentShape.prototype._segmentEndMarkerDragMove = function (segmentMarker, event) {\n  var width = this._view.getWidth();\n  var startMarkerX = this._startMarker.getX();\n  var endMarkerX = this._endMarker.getX();\n  var minSegmentDuration = this._view.pixelsToTime(50);\n  var minSegmentWidth = this._view.getMinSegmentDragWidth();\n  var lowerLimit = this._startMarker.getX() + minSegmentWidth;\n  if (lowerLimit < 0) {\n    lowerLimit = 0;\n  }\n  var nextSegmentVisible = false;\n  var nextSegmentUpdated = false;\n  var nextSegmentStartX;\n  if (this._nextSegment) {\n    nextSegmentStartX = this._view.timeToPixelOffset(this._nextSegment.startTime);\n    nextSegmentVisible = nextSegmentStartX < width;\n  }\n  if (endMarkerX < lowerLimit) {\n    segmentMarker.setX(lowerLimit);\n    this._overlay.clipWidth(lowerLimit - startMarkerX);\n    if (minSegmentWidth === 0 && lowerLimit > 0) {\n      this._segment._setEndTime(this._segment.startTime);\n    } else {\n      this._segment._setEndTime(this._view.pixelOffsetToTime(lowerLimit));\n    }\n  } else if (this._nextSegment && nextSegmentVisible) {\n    var dragMode = this._view.getSegmentDragMode();\n    var fixedNextSegment = dragMode === 'no-overlap' || dragMode === 'compress' && !this._nextSegment.editable;\n    var compressNextSegment = dragMode === 'compress' && this._nextSegment.editable;\n    if (endMarkerX >= nextSegmentStartX) {\n      if (fixedNextSegment) {\n        segmentMarker.setX(nextSegmentStartX);\n        this._overlay.clipWidth(nextSegmentStartX - startMarkerX);\n        this._segment._setEndTime(this._nextSegment.startTime);\n      } else if (compressNextSegment) {\n        var nextSegmentDuration = getDuration(this._nextSegment);\n        if (nextSegmentDuration < minSegmentDuration) {\n          minSegmentDuration = nextSegmentDuration;\n        }\n        var upperLimit = this._view.timeToPixelOffset(this._nextSegment.endTime - minSegmentDuration);\n        if (endMarkerX > upperLimit) {\n          endMarkerX = upperLimit;\n        }\n        segmentMarker.setX(endMarkerX);\n        this._overlay.clipWidth(endMarkerX - startMarkerX);\n        this._segment._setEndTime(this._view.pixelOffsetToTime(endMarkerX));\n        this._nextSegment.update({\n          startTime: this._view.pixelOffsetToTime(endMarkerX)\n        });\n        nextSegmentUpdated = true;\n      }\n    } else {\n      if (endMarkerX > width) {\n        endMarkerX = width;\n      }\n      segmentMarker.setX(endMarkerX);\n      this._overlay.clipWidth(endMarkerX - startMarkerX);\n      this._segment._setEndTime(this._view.pixelOffsetToTime(endMarkerX));\n    }\n  } else {\n    if (endMarkerX > width) {\n      endMarkerX = width;\n    }\n    segmentMarker.setX(endMarkerX);\n    this._overlay.clipWidth(endMarkerX - startMarkerX);\n    this._segment._setEndTime(this._view.pixelOffsetToTime(endMarkerX));\n  }\n  this._peaks.emit('segments.dragged', {\n    segment: this._segment,\n    marker: true,\n    startMarker: false,\n    evt: event.evt\n  });\n  if (nextSegmentUpdated) {\n    this._peaks.emit('segments.dragged', {\n      segment: this._nextSegment,\n      marker: true,\n      startMarker: true,\n      evt: event.evt\n    });\n  }\n};\n\n/**\n * @param {SegmentMarker} segmentMarker\n */\n\nSegmentShape.prototype._onSegmentMarkerDragEnd = function (segmentMarker, event) {\n  this._nextSegment = null;\n  this._previousSegment = null;\n  var startMarker = segmentMarker.isStartMarker();\n  this._peaks.emit('segments.dragend', {\n    segment: this._segment,\n    marker: true,\n    startMarker: startMarker,\n    evt: event.evt\n  });\n};\nSegmentShape.prototype._segmentMarkerDragBoundFunc = function (segmentMarker, pos) {\n  // Allow the marker to be moved horizontally but not vertically.\n  return {\n    x: pos.x,\n    y: segmentMarker.getAbsolutePosition().y\n  };\n};\nSegmentShape.prototype._onSegmentMarkerClick = function () {\n  // Move this segment to the top of the z-order.\n  this._moveToTop();\n};\nSegmentShape.prototype.fitToView = function () {\n  if (this._startMarker) {\n    this._startMarker.fitToView();\n  }\n  if (this._endMarker) {\n    this._endMarker.fitToView();\n  }\n  if (this._overlay) {\n    var height = this._view.getHeight();\n    var overlayRectHeight = clamp(0, height - this._overlayOffset * 2);\n    this._overlay.setAttrs({\n      y: 0,\n      height: height,\n      clipY: this._overlayOffset,\n      clipHeight: overlayRectHeight\n    });\n    this._overlayRect.setAttrs({\n      y: this._overlayOffset,\n      height: overlayRectHeight\n    });\n    if (this._overlayText) {\n      this._overlayText.setAttrs({\n        y: this._overlayOffset,\n        height: overlayRectHeight\n      });\n    }\n  }\n};\nSegmentShape.prototype.destroy = function () {\n  if (this._waveformShape) {\n    this._waveformShape.destroy();\n  }\n  if (this._label) {\n    this._label.destroy();\n  }\n  if (this._startMarker) {\n    this._startMarker.destroy();\n  }\n  if (this._endMarker) {\n    this._endMarker.destroy();\n  }\n  if (this._overlay) {\n    this._overlay.destroy();\n  }\n};\n\n/**\n * @file\n *\n * Defines the {@link SegmentsLayer} class.\n *\n * @module segments-layer\n */\n\n\n/**\n * Creates a Konva.Layer that displays segment markers against the audio\n * waveform.\n *\n * @class\n * @alias SegmentsLayer\n *\n * @param {Peaks} peaks\n * @param {WaveformOverview|WaveformZoomView} view\n * @param {Boolean} enableEditing\n */\n\nfunction SegmentsLayer(peaks, view, enableEditing) {\n  this._peaks = peaks;\n  this._view = view;\n  this._enableEditing = enableEditing;\n  this._segmentShapes = {};\n  this._layer = new Konva.Layer();\n  this._onSegmentsUpdate = this._onSegmentsUpdate.bind(this);\n  this._onSegmentsAdd = this._onSegmentsAdd.bind(this);\n  this._onSegmentsRemove = this._onSegmentsRemove.bind(this);\n  this._onSegmentsRemoveAll = this._onSegmentsRemoveAll.bind(this);\n  this._onSegmentsDragged = this._onSegmentsDragged.bind(this);\n  this._peaks.on('segments.update', this._onSegmentsUpdate);\n  this._peaks.on('segments.add', this._onSegmentsAdd);\n  this._peaks.on('segments.remove', this._onSegmentsRemove);\n  this._peaks.on('segments.remove_all', this._onSegmentsRemoveAll);\n  this._peaks.on('segments.dragged', this._onSegmentsDragged);\n}\n\n/**\n * Adds the layer to the given {Konva.Stage}.\n *\n * @param {Konva.Stage} stage\n */\n\nSegmentsLayer.prototype.addToStage = function (stage) {\n  stage.add(this._layer);\n};\nSegmentsLayer.prototype.setListening = function (listening) {\n  this._layer.listening(listening);\n};\nSegmentsLayer.prototype.enableEditing = function (enable) {\n  this._enableEditing = enable;\n};\nSegmentsLayer.prototype.isEditingEnabled = function () {\n  return this._enableEditing;\n};\nSegmentsLayer.prototype.enableSegmentDragging = function (enable) {\n  for (var segmentPid in this._segmentShapes) {\n    if (objectHasProperty(this._segmentShapes, segmentPid)) {\n      this._segmentShapes[segmentPid].enableSegmentDragging(enable);\n    }\n  }\n};\nSegmentsLayer.prototype.getSegmentShape = function (segment) {\n  return this._segmentShapes[segment.pid];\n};\nSegmentsLayer.prototype.formatTime = function (time) {\n  return this._view.formatTime(time);\n};\nSegmentsLayer.prototype._onSegmentsUpdate = function (segment, options) {\n  var frameStartTime = this._view.getStartTime();\n  var frameEndTime = this._view.getEndTime();\n  var segmentShape = this.getSegmentShape(segment);\n  var isVisible = segment.isVisible(frameStartTime, frameEndTime);\n  if (segmentShape && !isVisible) {\n    // Remove segment shape that is no longer visible.\n\n    if (!segmentShape.isDragging()) {\n      this._removeSegment(segment);\n    }\n  } else if (!segmentShape && isVisible) {\n    // Add segment shape for visible segment.\n    segmentShape = this._updateSegment(segment);\n  } else if (segmentShape && isVisible) {\n    // Update the segment shape with the changed attributes.\n    segmentShape.update(options);\n  }\n};\nSegmentsLayer.prototype._onSegmentsAdd = function (event) {\n  var self = this;\n  var frameStartTime = self._view.getStartTime();\n  var frameEndTime = self._view.getEndTime();\n  event.segments.forEach(function (segment) {\n    if (segment.isVisible(frameStartTime, frameEndTime)) {\n      var segmentShape = self._addSegmentShape(segment);\n      segmentShape.update();\n    }\n  });\n\n  // Ensure segment markers are always draggable.\n  this.moveSegmentMarkersToTop();\n};\nSegmentsLayer.prototype._onSegmentsRemove = function (event) {\n  var self = this;\n  event.segments.forEach(function (segment) {\n    self._removeSegment(segment);\n  });\n};\nSegmentsLayer.prototype._onSegmentsRemoveAll = function () {\n  this._layer.removeChildren();\n  this._segmentShapes = {};\n};\nSegmentsLayer.prototype._onSegmentsDragged = function (event) {\n  this._updateSegment(event.segment);\n};\n\n/**\n * Creates the Konva UI objects for a given segment.\n *\n * @private\n * @param {Segment} segment\n * @returns {SegmentShape}\n */\n\nSegmentsLayer.prototype._createSegmentShape = function (segment) {\n  return new SegmentShape(segment, this._peaks, this, this._view);\n};\n\n/**\n * Adds a Konva UI object to the layer for a given segment.\n *\n * @private\n * @param {Segment} segment\n * @returns {SegmentShape}\n */\n\nSegmentsLayer.prototype._addSegmentShape = function (segment) {\n  var segmentShape = this._createSegmentShape(segment);\n  segmentShape.addToLayer(this._layer);\n  this._segmentShapes[segment.pid] = segmentShape;\n  return segmentShape;\n};\n\n/**\n * Updates the positions of all displayed segments in the view.\n *\n * @param {Number} startTime The start of the visible range in the view,\n *   in seconds.\n * @param {Number} endTime The end of the visible range in the view,\n *   in seconds.\n */\n\nSegmentsLayer.prototype.updateSegments = function (startTime, endTime) {\n  // Update segments in visible time range.\n  var segments = this._peaks.segments.find(startTime, endTime);\n  segments.forEach(this._updateSegment.bind(this));\n\n  // TODO: In the overview all segments are visible, so no need to do this.\n  this._removeInvisibleSegments(startTime, endTime);\n};\n\n/**\n * @private\n * @param {Segment} segment\n */\n\nSegmentsLayer.prototype._updateSegment = function (segment) {\n  var segmentShape = this.getSegmentShape(segment);\n  if (!segmentShape) {\n    segmentShape = this._addSegmentShape(segment);\n  }\n  segmentShape.update();\n};\n\n/**\n * Removes any segments that are not visible, i.e., are not within and do not\n * overlap the given time range.\n *\n * @private\n * @param {Number} startTime The start of the visible time range, in seconds.\n * @param {Number} endTime The end of the visible time range, in seconds.\n */\n\nSegmentsLayer.prototype._removeInvisibleSegments = function (startTime, endTime) {\n  for (var segmentPid in this._segmentShapes) {\n    if (objectHasProperty(this._segmentShapes, segmentPid)) {\n      var segment = this._segmentShapes[segmentPid].getSegment();\n      if (!segment.isVisible(startTime, endTime)) {\n        this._removeSegment(segment);\n      }\n    }\n  }\n};\n\n/**\n * Removes the given segment from the view.\n *\n * @param {Segment} segment\n */\n\nSegmentsLayer.prototype._removeSegment = function (segment) {\n  var segmentShape = this._segmentShapes[segment.pid];\n  if (segmentShape) {\n    segmentShape.destroy();\n    delete this._segmentShapes[segment.pid];\n  }\n};\n\n/**\n * Moves all segment markers to the top of the z-order,\n * so the user can always drag them.\n */\n\nSegmentsLayer.prototype.moveSegmentMarkersToTop = function () {\n  for (var segmentPid in this._segmentShapes) {\n    if (objectHasProperty(this._segmentShapes, segmentPid)) {\n      this._segmentShapes[segmentPid].moveMarkersToTop();\n    }\n  }\n};\n\n/**\n * Toggles visibility of the segments layer.\n *\n * @param {Boolean} visible\n */\n\nSegmentsLayer.prototype.setVisible = function (visible) {\n  this._layer.setVisible(visible);\n};\nSegmentsLayer.prototype.segmentClicked = function (eventName, event) {\n  var segmentShape = this._segmentShapes[event.segment.pid];\n  if (segmentShape) {\n    segmentShape.segmentClicked(eventName, event);\n  }\n};\nSegmentsLayer.prototype.destroy = function () {\n  this._peaks.off('segments.update', this._onSegmentsUpdate);\n  this._peaks.off('segments.add', this._onSegmentsAdd);\n  this._peaks.off('segments.remove', this._onSegmentsRemove);\n  this._peaks.off('segments.remove_all', this._onSegmentsRemoveAll);\n  this._peaks.off('segments.dragged', this._onSegmentsDragged);\n};\nSegmentsLayer.prototype.fitToView = function () {\n  for (var segmentPid in this._segmentShapes) {\n    if (objectHasProperty(this._segmentShapes, segmentPid)) {\n      var segmentShape = this._segmentShapes[segmentPid];\n      segmentShape.fitToView();\n    }\n  }\n};\nSegmentsLayer.prototype.draw = function () {\n  this._layer.draw();\n};\nSegmentsLayer.prototype.getHeight = function () {\n  return this._layer.getHeight();\n};\n\n/**\n * @file\n *\n * Defines the {@link WaveformAxis} class.\n *\n * @module waveform-axis\n */\n\n\n/**\n * Creates the waveform axis shapes and adds them to the given view layer.\n *\n * @class\n * @alias WaveformAxis\n *\n * @param {WaveformOverview|WaveformZoomView} view\n * @param {Object} options\n * @param {String} options.axisGridlineColor\n * @param {String} options.axisLabelColor\n * @param {Boolean} options.showAxisLabels\n * @param {Function} options.formatAxisTime\n * @param {String} options.fontFamily\n * @param {Number} options.fontSize\n * @param {String} options.fontStyle\n */\n\nfunction WaveformAxis(view, options) {\n  var self = this;\n  self._axisGridlineColor = options.axisGridlineColor;\n  self._axisLabelColor = options.axisLabelColor;\n  self._showAxisLabels = options.showAxisLabels;\n  self._axisTopMarkerHeight = options.axisTopMarkerHeight;\n  self._axisBottomMarkerHeight = options.axisBottomMarkerHeight;\n  if (options.formatAxisTime) {\n    self._formatAxisTime = options.formatAxisTime;\n  } else {\n    self._formatAxisTime = function (time) {\n      // precision = 0, drops the fractional seconds\n      return formatTime(time, 0);\n    };\n  }\n  self._axisLabelFont = WaveformAxis._buildFontString(options.fontFamily, options.fontSize, options.fontStyle);\n  self._axisShape = new Konva.Shape({\n    sceneFunc: function sceneFunc(context) {\n      self._drawAxis(context, view);\n    }\n  });\n}\nWaveformAxis._buildFontString = function (fontFamily, fontSize, fontStyle) {\n  if (!fontSize) {\n    fontSize = 11;\n  }\n  if (!fontFamily) {\n    fontFamily = 'sans-serif';\n  }\n  if (!fontStyle) {\n    fontStyle = 'normal';\n  }\n  return fontStyle + ' ' + fontSize + 'px ' + fontFamily;\n};\nWaveformAxis.prototype.addToLayer = function (layer) {\n  layer.add(this._axisShape);\n};\nWaveformAxis.prototype.showAxisLabels = function (show, options) {\n  this._showAxisLabels = show;\n  if (options) {\n    if (objectHasProperty(options, 'topMarkerHeight')) {\n      this._axisTopMarkerHeight = options.topMarkerHeight;\n    }\n    if (objectHasProperty(options, 'bottomMarkerHeight')) {\n      this._axisBottomMarkerHeight = options.bottomMarkerHeight;\n    }\n  }\n};\nWaveformAxis.prototype.setAxisLabelColor = function (color) {\n  this._axisLabelColor = color;\n};\nWaveformAxis.prototype.setAxisGridlineColor = function (color) {\n  this._axisGridlineColor = color;\n};\n\n/**\n * Returns number of seconds for each x-axis marker, appropriate for the\n * current zoom level, ensuring that markers are not too close together\n * and that markers are placed at intuitive time intervals (i.e., every 1,\n * 2, 5, 10, 20, 30 seconds, then every 1, 2, 5, 10, 20, 30 minutes, then\n * every 1, 2, 5, 10, 20, 30 hours).\n *\n * @param {WaveformOverview|WaveformZoomView} view\n * @returns {Number}\n */\n\nWaveformAxis.prototype._getAxisLabelScale = function (view) {\n  var baseSecs = 1; // seconds\n  var steps = [1, 2, 5, 10, 20, 30];\n  var minSpacing = 60;\n  var index = 0;\n  var secs;\n  for (;;) {\n    secs = baseSecs * steps[index];\n    var pixels = view.timeToPixels(secs);\n    if (pixels < minSpacing) {\n      if (++index === steps.length) {\n        baseSecs *= 60; // seconds -> minutes -> hours\n        index = 0;\n      }\n    } else {\n      break;\n    }\n  }\n  return secs;\n};\n\n/**\n * Draws the time axis and labels onto a view.\n *\n * @param {Konva.Context} context The context to draw on.\n * @param {WaveformOverview|WaveformZoomView} view\n */\n\nWaveformAxis.prototype._drawAxis = function (context, view) {\n  var currentFrameStartTime = view.getStartTime();\n\n  // Time interval between axis markers (seconds)\n  var axisLabelIntervalSecs = this._getAxisLabelScale(view);\n\n  // Time of first axis marker (seconds)\n  var firstAxisLabelSecs = roundUpToNearest(currentFrameStartTime, axisLabelIntervalSecs);\n\n  // Distance between waveform start time and first axis marker (seconds)\n  var axisLabelOffsetSecs = firstAxisLabelSecs - currentFrameStartTime;\n\n  // Distance between waveform start time and first axis marker (pixels)\n  var axisLabelOffsetPixels = view.timeToPixels(axisLabelOffsetSecs);\n  context.setAttr('strokeStyle', this._axisGridlineColor);\n  context.setAttr('lineWidth', 1);\n\n  // Set text style\n  context.setAttr('font', this._axisLabelFont);\n  context.setAttr('fillStyle', this._axisLabelColor);\n  context.setAttr('textAlign', 'left');\n  context.setAttr('textBaseline', 'bottom');\n  var width = view.getWidth();\n  var height = view.getHeight();\n  var secs = firstAxisLabelSecs;\n  for (;;) {\n    // Position of axis marker (pixels)\n    var x = axisLabelOffsetPixels + view.timeToPixels(secs - firstAxisLabelSecs);\n    if (x >= width) {\n      break;\n    }\n    if (this._axisTopMarkerHeight > 0) {\n      context.beginPath();\n      context.moveTo(x + 0.5, 0);\n      context.lineTo(x + 0.5, 0 + this._axisTopMarkerHeight);\n      context.stroke();\n    }\n    if (this._axisBottomMarkerHeight > 0) {\n      context.beginPath();\n      context.moveTo(x + 0.5, height);\n      context.lineTo(x + 0.5, height - this._axisBottomMarkerHeight);\n      context.stroke();\n    }\n    if (this._showAxisLabels) {\n      var label = this._formatAxisTime(secs);\n      var labelWidth = context.measureText(label).width;\n      var labelX = x - labelWidth / 2;\n      var labelY = height - 1 - this._axisBottomMarkerHeight;\n      if (labelX >= 0) {\n        context.fillText(label, labelX, labelY);\n      }\n    }\n    secs += axisLabelIntervalSecs;\n  }\n};\n\n/**\n * @file\n *\n * Defines the {@link WaveformView} class.\n *\n * @module waveform-view\n */\n\nfunction WaveformView(waveformData, container, peaks, viewOptions) {\n  var self = this;\n  self._container = container;\n  self._peaks = peaks;\n  self._options = peaks.options;\n  self._viewOptions = viewOptions;\n  self._originalWaveformData = waveformData;\n  self._data = waveformData;\n\n  // The pixel offset of the current frame being displayed\n  self._frameOffset = 0;\n  self._width = container.clientWidth;\n  self._height = container.clientHeight;\n  self._amplitudeScale = 1.0;\n  self._waveformColor = self._viewOptions.waveformColor;\n  self._playedWaveformColor = self._viewOptions.playedWaveformColor;\n  self._timeLabelPrecision = self._viewOptions.timeLabelPrecision;\n  if (self._viewOptions.formatPlayheadTime) {\n    self._formatPlayheadTime = self._viewOptions.formatPlayheadTime;\n  } else {\n    self._formatPlayheadTime = function (time) {\n      return formatTime(time, self._timeLabelPrecision);\n    };\n  }\n  self._enableSeek = true;\n  self.initWaveformData();\n\n  // Disable warning: The stage has 6 layers.\n  // Recommended maximum number of layers is 3-5.\n  Konva.showWarnings = false;\n  self._stage = new Konva.Stage({\n    container: container,\n    width: self._width,\n    height: self._height\n  });\n  self._createWaveform();\n  if (self._viewOptions.enableSegments) {\n    self._segmentsLayer = new SegmentsLayer(peaks, self, self._viewOptions.enableEditing);\n    self._segmentsLayer.addToStage(self._stage);\n  }\n  if (self._viewOptions.enablePoints) {\n    self._pointsLayer = new PointsLayer(peaks, self, self._viewOptions.enableEditing);\n    self._pointsLayer.addToStage(self._stage);\n  }\n  self.initHighlightLayer();\n  self._createAxisLabels();\n  self._playheadLayer = new PlayheadLayer(self._peaks.player, self, self._viewOptions);\n  self._playheadLayer.addToStage(self._stage);\n  self._onClick = self._onClick.bind(self);\n  self._onDblClick = self._onDblClick.bind(self);\n  self._onContextMenu = self._onContextMenu.bind(self);\n  self._stage.on('click', self._onClick);\n  self._stage.on('dblclick', self._onDblClick);\n  self._stage.on('contextmenu', self._onContextMenu);\n}\nWaveformView.prototype.getViewOptions = function () {\n  return this._viewOptions;\n};\n\n/**\n * @returns {WaveformData} The view's waveform data.\n */\n\nWaveformView.prototype.getWaveformData = function () {\n  return this._data;\n};\nWaveformView.prototype.setWaveformData = function (waveformData) {\n  this._data = waveformData;\n};\n\n/**\n * Returns the pixel index for a given time, for the current zoom level.\n *\n * @param {Number} time Time, in seconds.\n * @returns {Number} Pixel index.\n */\n\nWaveformView.prototype.timeToPixels = function (time) {\n  return Math.floor(time * this._data.sample_rate / this._data.scale);\n};\n\n/**\n * Returns the time for a given pixel index, for the current zoom level.\n *\n * @param {Number} pixels Pixel index.\n * @returns {Number} Time, in seconds.\n */\n\nWaveformView.prototype.pixelsToTime = function (pixels) {\n  return pixels * this._data.scale / this._data.sample_rate;\n};\n\n/**\n * Returns the time for a given pixel offset (relative to the\n * current scroll position), for the current zoom level.\n *\n * @param {Number} offset Offset from left-visible-edge of view\n * @returns {Number} Time, in seconds.\n */\n\nWaveformView.prototype.pixelOffsetToTime = function (offset) {\n  var pixels = this._frameOffset + offset;\n  return pixels * this._data.scale / this._data.sample_rate;\n};\nWaveformView.prototype.timeToPixelOffset = function (time) {\n  return Math.floor(time * this._data.sample_rate / this._data.scale) - this._frameOffset;\n};\n\n/**\n * @returns {Number} The start position of the waveform shown in the view,\n *   in pixels.\n */\n\nWaveformView.prototype.getFrameOffset = function () {\n  return this._frameOffset;\n};\n\n/**\n * @returns {Number} The width of the view, in pixels.\n */\n\nWaveformView.prototype.getWidth = function () {\n  return this._width;\n};\n\n/**\n * @returns {Number} The height of the view, in pixels.\n */\n\nWaveformView.prototype.getHeight = function () {\n  return this._height;\n};\n\n/**\n * @returns {Number} The time at the left edge of the waveform view.\n */\n\nWaveformView.prototype.getStartTime = function () {\n  return this.pixelOffsetToTime(0);\n};\n\n/**\n * @returns {Number} The time at the right edge of the waveform view.\n */\n\nWaveformView.prototype.getEndTime = function () {\n  return this.pixelOffsetToTime(this._width);\n};\n\n/**\n * @returns {Number} The media duration, in seconds.\n */\n\nWaveformView.prototype._getDuration = function () {\n  return this._peaks.player.getDuration();\n};\nWaveformView.prototype._createWaveform = function () {\n  this._waveformLayer = new Konva.Layer({\n    listening: false\n  });\n  this._createWaveformShapes();\n  this._stage.add(this._waveformLayer);\n};\nWaveformView.prototype._createWaveformShapes = function () {\n  if (!this._waveformShape) {\n    this._waveformShape = new WaveformShape({\n      color: this._waveformColor,\n      view: this\n    });\n    this._waveformShape.addToLayer(this._waveformLayer);\n  }\n  if (this._playedWaveformColor && !this._playedWaveformShape) {\n    var time = this._peaks.player.getCurrentTime();\n    this._playedSegment = {\n      startTime: 0,\n      endTime: time\n    };\n    this._unplayedSegment = {\n      startTime: time,\n      endTime: this._getDuration()\n    };\n    this._waveformShape.setSegment(this._unplayedSegment);\n    this._playedWaveformShape = new WaveformShape({\n      color: this._playedWaveformColor,\n      view: this,\n      segment: this._playedSegment\n    });\n    this._playedWaveformShape.addToLayer(this._waveformLayer);\n  }\n};\nWaveformView.prototype.setWaveformColor = function (color) {\n  this._waveformColor = color;\n  this._waveformShape.setWaveformColor(color);\n};\nWaveformView.prototype.setPlayedWaveformColor = function (color) {\n  this._playedWaveformColor = color;\n  if (color) {\n    if (!this._playedWaveformShape) {\n      this._createWaveformShapes();\n    }\n    this._playedWaveformShape.setWaveformColor(color);\n  } else {\n    if (this._playedWaveformShape) {\n      this._destroyPlayedWaveformShape();\n    }\n  }\n};\nWaveformView.prototype._destroyPlayedWaveformShape = function () {\n  this._waveformShape.setSegment(null);\n  this._playedWaveformShape.destroy();\n  this._playedWaveformShape = null;\n  this._playedSegment = null;\n  this._unplayedSegment = null;\n};\nWaveformView.prototype._createAxisLabels = function () {\n  this._axisLayer = new Konva.Layer({\n    listening: false\n  });\n  this._axis = new WaveformAxis(this, this._viewOptions);\n  this._axis.addToLayer(this._axisLayer);\n  this._stage.add(this._axisLayer);\n};\nWaveformView.prototype.showAxisLabels = function (show, options) {\n  this._axis.showAxisLabels(show, options);\n  this._axisLayer.draw();\n};\nWaveformView.prototype.setAxisLabelColor = function (color) {\n  this._axis.setAxisLabelColor(color);\n  this._axisLayer.draw();\n};\nWaveformView.prototype.setAxisGridlineColor = function (color) {\n  this._axis.setAxisGridlineColor(color);\n  this._axisLayer.draw();\n};\nWaveformView.prototype.showPlayheadTime = function (show) {\n  this._playheadLayer.showPlayheadTime(show);\n};\nWaveformView.prototype.setTimeLabelPrecision = function (precision) {\n  this._timeLabelPrecision = precision;\n  this._playheadLayer.updatePlayheadText();\n};\nWaveformView.prototype.formatTime = function (time) {\n  return this._formatPlayheadTime(time);\n};\n\n/**\n * Adjusts the amplitude scale of waveform shown in the view, which allows\n * users to zoom the waveform vertically.\n *\n * @param {Number} scale The new amplitude scale factor\n */\n\nWaveformView.prototype.setAmplitudeScale = function (scale) {\n  if (!isNumber(scale) || !isFinite(scale)) {\n    throw new Error('view.setAmplitudeScale(): Scale must be a valid number');\n  }\n  this._amplitudeScale = scale;\n  this.drawWaveformLayer();\n  if (this._segmentsLayer) {\n    this._segmentsLayer.draw();\n  }\n};\nWaveformView.prototype.getAmplitudeScale = function () {\n  return this._amplitudeScale;\n};\nWaveformView.prototype.enableSeek = function (enable) {\n  this._enableSeek = enable;\n};\nWaveformView.prototype.isSeekEnabled = function () {\n  return this._enableSeek;\n};\nWaveformView.prototype._onClick = function (event) {\n  this._clickHandler(event, 'click');\n};\nWaveformView.prototype._onDblClick = function (event) {\n  this._clickHandler(event, 'dblclick');\n};\nWaveformView.prototype._onContextMenu = function (event) {\n  this._clickHandler(event, 'contextmenu');\n};\nWaveformView.prototype._clickHandler = function (event, eventName) {\n  var offsetX = event.evt.offsetX;\n  if (offsetX < 0) {\n    offsetX = 0;\n  }\n  var emitViewEvent = true;\n  if (event.target !== this._stage) {\n    var marker = getMarkerObject(event.target);\n    if (marker) {\n      if (marker.attrs.name === 'point-marker') {\n        var point = marker.getAttr('point');\n        if (point) {\n          this._peaks.emit('points.' + eventName, {\n            point: point,\n            evt: event.evt,\n            preventViewEvent: function preventViewEvent() {\n              emitViewEvent = false;\n            }\n          });\n        }\n      } else if (marker.attrs.name === 'segment-overlay') {\n        var segment = marker.getAttr('segment');\n        if (segment) {\n          var clickEvent = {\n            segment: segment,\n            evt: event.evt,\n            preventViewEvent: function preventViewEvent() {\n              emitViewEvent = false;\n            }\n          };\n          if (this._segmentsLayer) {\n            this._segmentsLayer.segmentClicked(eventName, clickEvent);\n          }\n        }\n      }\n    }\n  }\n  if (emitViewEvent) {\n    var time = this.pixelOffsetToTime(offsetX);\n    var viewName = this.getName();\n    this._peaks.emit(viewName + '.' + eventName, {\n      time: time,\n      evt: event.evt\n    });\n  }\n};\nWaveformView.prototype.updatePlayheadTime = function (time) {\n  this._playheadLayer.updatePlayheadTime(time);\n};\nWaveformView.prototype.playheadPosChanged = function (time) {\n  if (this._playedWaveformShape) {\n    this._playedSegment.endTime = time;\n    this._unplayedSegment.startTime = time;\n    this.drawWaveformLayer();\n  }\n};\nWaveformView.prototype.drawWaveformLayer = function () {\n  this._waveformLayer.draw();\n};\nWaveformView.prototype.enableMarkerEditing = function (enable) {\n  if (this._segmentsLayer) {\n    this._segmentsLayer.enableEditing(enable);\n  }\n  if (this._pointsLayer) {\n    this._pointsLayer.enableEditing(enable);\n  }\n};\n\n/**\n * Called when the user starts or stops dragging the playhead.\n * We use this to disable interaction with the points and segments layers,\n * e.g., so that when the user drags the playhead over a marker, the timestamp\n * labels don't appear.\n */\n\nWaveformView.prototype.dragSeek = function (dragging) {\n  if (this._segmentsLayer) {\n    this._segmentsLayer.setListening(!dragging);\n  }\n  if (this._pointsLayer) {\n    this._pointsLayer.setListening(!dragging);\n  }\n};\nWaveformView.prototype.fitToContainer = function () {\n  if (this._container.clientWidth === 0 && this._container.clientHeight === 0) {\n    return;\n  }\n  var updateWaveform = false;\n  if (this._container.clientWidth !== this._width) {\n    this._width = this._container.clientWidth;\n    this._stage.setWidth(this._width);\n    updateWaveform = this.containerWidthChange();\n  }\n  var heightChanged = false;\n  if (this._container.clientHeight !== this._height) {\n    this._height = this._container.clientHeight;\n    this._stage.setHeight(this._height);\n    this._waveformShape.fitToView();\n    this._playheadLayer.fitToView();\n    this.containerHeightChange();\n    heightChanged = true;\n  }\n  if (updateWaveform) {\n    this.updateWaveform(this._frameOffset, true);\n  } else if (heightChanged) {\n    if (this._segmentsLayer) {\n      this._segmentsLayer.fitToView();\n    }\n    if (this._pointsLayer) {\n      this._pointsLayer.fitToView();\n    }\n  }\n};\nWaveformView.prototype.destroy = function () {\n  this._playheadLayer.destroy();\n  if (this._segmentsLayer) {\n    this._segmentsLayer.destroy();\n  }\n  if (this._pointsLayer) {\n    this._pointsLayer.destroy();\n  }\n  if (this._stage) {\n    this._stage.destroy();\n    this._stage = null;\n  }\n};\n\n/**\n * @file\n *\n * Defines the {@link MouseDragHandler} class.\n *\n * @module mouse-drag-handler\n */\n\n\n/**\n * An object to receive callbacks on mouse drag events. Each function is\n * called with the current mouse X position, relative to the stage's\n * container HTML element.\n *\n * @typedef {Object} MouseDragHandlers\n * @global\n * @property {Function} onMouseDown Mouse down event handler.\n * @property {Function} onMouseMove Mouse move event handler.\n * @property {Function} onMouseUp Mouse up event handler.\n */\n\n/**\n * Creates a handler for mouse events to allow interaction with the waveform\n * views by clicking and dragging the mouse.\n *\n * @class\n * @alias MouseDragHandler\n *\n * @param {Konva.Stage} stage\n * @param {MouseDragHandlers} handlers\n */\n\nfunction MouseDragHandler(stage, handlers) {\n  this._stage = stage;\n  this._handlers = handlers;\n  this._dragging = false;\n  this._mouseDown = this._mouseDown.bind(this);\n  this._mouseUp = this._mouseUp.bind(this);\n  this._mouseMove = this._mouseMove.bind(this);\n  this._stage.on('mousedown', this._mouseDown);\n  this._stage.on('touchstart', this._mouseDown);\n  this._lastMouseClientX = null;\n}\n\n/**\n * Mouse down event handler.\n *\n * @param {MouseEvent} event\n */\n\nMouseDragHandler.prototype._mouseDown = function (event) {\n  var segment = null;\n  if (event.type === 'mousedown' && event.evt.button !== 0) {\n    // Mouse drag only applies to the primary mouse button.\n    // The secondary button may be used to show a context menu\n    // and we don't want to also treat this as a mouse drag operation.\n    return;\n  }\n  var marker = getMarkerObject(event.target);\n  if (marker) {\n    // Avoid interfering with drag/drop of point and segment markers.\n    if (marker.attrs.name === 'point-marker' || marker.attrs.name === 'segment-marker') {\n      return;\n    }\n\n    // Check if we're dragging a segment.\n    if (marker.attrs.name === 'segment-overlay') {\n      segment = marker;\n    }\n  }\n  this._lastMouseClientX = Math.floor(event.type === 'touchstart' ? event.evt.touches[0].clientX : event.evt.clientX);\n  if (this._handlers.onMouseDown) {\n    var mouseDownPosX = this._getMousePosX(this._lastMouseClientX);\n    this._handlers.onMouseDown(mouseDownPosX, segment);\n  }\n\n  // Use the window mousemove and mouseup handlers instead of the\n  // Konva.Stage ones so that we still receive events if the user moves the\n  // mouse outside the stage.\n  window.addEventListener('mousemove', this._mouseMove, {\n    capture: false,\n    passive: true\n  });\n  window.addEventListener('touchmove', this._mouseMove, {\n    capture: false,\n    passive: true\n  });\n  window.addEventListener('mouseup', this._mouseUp, {\n    capture: false,\n    passive: true\n  });\n  window.addEventListener('touchend', this._mouseUp, {\n    capture: false /* , passive: true */\n  });\n  window.addEventListener('blur', this._mouseUp, {\n    capture: false,\n    passive: true\n  });\n};\n\n/**\n * Mouse move event handler.\n *\n * @param {MouseEvent} event\n */\n\nMouseDragHandler.prototype._mouseMove = function (event) {\n  var clientX = Math.floor(event.type === 'touchmove' ? event.changedTouches[0].clientX : event.clientX);\n\n  // Don't update on vertical mouse movement.\n  if (clientX === this._lastMouseClientX) {\n    return;\n  }\n  this._lastMouseClientX = clientX;\n  this._dragging = true;\n  if (this._handlers.onMouseMove) {\n    var mousePosX = this._getMousePosX(clientX);\n    this._handlers.onMouseMove(mousePosX);\n  }\n};\n\n/**\n * Mouse up event handler.\n *\n * @param {MouseEvent} event\n */\n\nMouseDragHandler.prototype._mouseUp = function (event) {\n  var clientX;\n  if (event.type === 'touchend') {\n    clientX = Math.floor(event.changedTouches[0].clientX);\n    if (event.cancelable) {\n      event.preventDefault();\n    }\n  } else {\n    clientX = Math.floor(event.clientX);\n  }\n  if (this._handlers.onMouseUp) {\n    var mousePosX = this._getMousePosX(clientX);\n    this._handlers.onMouseUp(mousePosX);\n  }\n  window.removeEventListener('mousemove', this._mouseMove, {\n    capture: false\n  });\n  window.removeEventListener('touchmove', this._mouseMove, {\n    capture: false\n  });\n  window.removeEventListener('mouseup', this._mouseUp, {\n    capture: false\n  });\n  window.removeEventListener('touchend', this._mouseUp, {\n    capture: false\n  });\n  window.removeEventListener('blur', this._mouseUp, {\n    capture: false\n  });\n  this._dragging = false;\n};\n\n/**\n * @returns {Number} The mouse X position, relative to the container that\n * received the mouse down event.\n *\n * @private\n * @param {Number} clientX Mouse client X position.\n */\n\nMouseDragHandler.prototype._getMousePosX = function (clientX) {\n  var containerPos = this._stage.getContainer().getBoundingClientRect();\n  return Math.floor(clientX - containerPos.left);\n};\n\n/**\n * Returns <code>true</code> if the mouse is being dragged, i.e., moved with\n * the mouse button held down.\n *\n * @returns {Boolean}\n */\n\nMouseDragHandler.prototype.isDragging = function () {\n  return this._dragging;\n};\nMouseDragHandler.prototype.destroy = function () {\n  this._stage.off('mousedown', this._mouseDown);\n  this._stage.off('touchstart', this._mouseDown);\n};\n\n/**\n * @file\n *\n * Defines the {@link SeekMouseDragHandler} class.\n *\n * @module seek-mouse-drag-handler\n */\n\n\n/**\n * Creates a handler for mouse events to allow seeking the waveform\n * views by clicking and dragging the mouse.\n *\n * @class\n * @alias SeekMouseDragHandler\n *\n * @param {Peaks} peaks\n * @param {WaveformOverview} view\n */\n\nfunction SeekMouseDragHandler(peaks, view) {\n  this._peaks = peaks;\n  this._view = view;\n  this._firstMove = false;\n  this._onMouseDown = this._onMouseDown.bind(this);\n  this._onMouseMove = this._onMouseMove.bind(this);\n  this._onMouseUp = this._onMouseUp.bind(this);\n  this._mouseDragHandler = new MouseDragHandler(view._stage, {\n    onMouseDown: this._onMouseDown,\n    onMouseMove: this._onMouseMove,\n    onMouseUp: this._onMouseUp\n  });\n}\nSeekMouseDragHandler.prototype._onMouseDown = function (mousePosX) {\n  this._firstMove = true;\n  this._seek(mousePosX);\n};\nSeekMouseDragHandler.prototype._onMouseMove = function (mousePosX) {\n  if (this._firstMove) {\n    this._view.dragSeek(true);\n    this._firstMove = false;\n  }\n  this._seek(mousePosX);\n};\nSeekMouseDragHandler.prototype._onMouseUp = function () {\n  this._view.dragSeek(false);\n};\nSeekMouseDragHandler.prototype._seek = function (mousePosX) {\n  if (!this._view.isSeekEnabled()) {\n    return;\n  }\n  mousePosX = clamp(mousePosX, 0, this._width);\n  var time = this._view.pixelsToTime(mousePosX);\n  var duration = this._peaks.player.getDuration();\n\n  // Prevent the playhead position from jumping by limiting click\n  // handling to the waveform duration.\n  if (time > duration) {\n    time = duration;\n  }\n\n  // Update the playhead position. This gives a smoother visual update\n  // than if we only use the player.timeupdate event.\n  this._view.updatePlayheadTime(time);\n  this._peaks.player.seek(time);\n};\nSeekMouseDragHandler.prototype.destroy = function () {\n  this._mouseDragHandler.destroy();\n};\n\n/**\n * @file\n *\n * Defines the {@link WaveformOverview} class.\n *\n * @module waveform-overview\n */\n\n\n/**\n * Creates the overview waveform view.\n *\n * @class\n * @alias WaveformOverview\n *\n * @param {WaveformData} waveformData\n * @param {HTMLElement} container\n * @param {Peaks} peaks\n */\n\nfunction WaveformOverview(waveformData, container, peaks) {\n  var self = this;\n  WaveformView.call(self, waveformData, container, peaks, peaks.options.overview);\n\n  // Bind event handlers\n  self._onTimeUpdate = self._onTimeUpdate.bind(self);\n  self._onPlaying = self._onPlaying.bind(self);\n  self._onPause = self._onPause.bind(self);\n  self._onZoomviewUpdate = self._onZoomviewUpdate.bind(self);\n\n  // Register event handlers\n  peaks.on('player.timeupdate', self._onTimeUpdate);\n  peaks.on('player.playing', self._onPlaying);\n  peaks.on('player.pause', self._onPause);\n  peaks.on('zoomview.update', self._onZoomviewUpdate);\n  var time = self._peaks.player.getCurrentTime();\n  self._playheadLayer.updatePlayheadTime(time);\n  self._mouseDragHandler = new SeekMouseDragHandler(peaks, self);\n  var zoomview = peaks.views.getView('zoomview');\n  if (zoomview) {\n    self._highlightLayer.showHighlight(zoomview.getStartTime(), zoomview.getEndTime());\n  }\n}\nWaveformOverview.prototype = Object.create(WaveformView.prototype);\nWaveformOverview.prototype.initWaveformData = function () {\n  if (this._width !== 0) {\n    this._resampleAndSetWaveformData(this._originalWaveformData, this._width);\n  }\n};\nWaveformOverview.prototype.initHighlightLayer = function () {\n  this._highlightLayer = new HighlightLayer(this, this._viewOptions);\n  this._highlightLayer.addToStage(this._stage);\n};\nWaveformOverview.prototype.isSegmentDraggingEnabled = function () {\n  return false;\n};\nWaveformOverview.prototype.getName = function () {\n  return 'overview';\n};\nWaveformOverview.prototype._onTimeUpdate = function (time) {\n  this._playheadLayer.updatePlayheadTime(time);\n};\nWaveformOverview.prototype._onPlaying = function (time) {\n  this._playheadLayer.updatePlayheadTime(time);\n};\nWaveformOverview.prototype._onPause = function (time) {\n  this._playheadLayer.stop(time);\n};\nWaveformOverview.prototype._onZoomviewUpdate = function (event) {\n  this.showHighlight(event.startTime, event.endTime);\n};\nWaveformOverview.prototype.showHighlight = function (startTime, endTime) {\n  this._highlightLayer.showHighlight(startTime, endTime);\n};\nWaveformOverview.prototype.setWaveformData = function (waveformData) {\n  this._originalWaveformData = waveformData;\n  if (this._width !== 0) {\n    this._resampleAndSetWaveformData(waveformData, this._width);\n  } else {\n    this._data = waveformData;\n  }\n  this.updateWaveform();\n};\nWaveformOverview.prototype._resampleAndSetWaveformData = function (waveformData, width) {\n  try {\n    this._data = waveformData.resample({\n      width: width\n    });\n    return true;\n  } catch (error) {\n    // eslint-disable-line no-unused-vars\n    // This error usually indicates that the waveform length\n    // is less than the container width. Ignore, and use the\n    // given waveform data\n    this._data = waveformData;\n    return false;\n  }\n};\nWaveformOverview.prototype.removeHighlightRect = function () {\n  this._highlightLayer.removeHighlight();\n};\nWaveformOverview.prototype.updateWaveform = function /* frameOffset, forceUpdate */\n() {\n  this._waveformLayer.draw();\n  this._axisLayer.draw();\n  var playheadTime = this._peaks.player.getCurrentTime();\n  this._playheadLayer.updatePlayheadTime(playheadTime);\n  this._highlightLayer.updateHighlight();\n  var frameStartTime = 0;\n  var frameEndTime = this.pixelsToTime(this._width);\n  if (this._pointsLayer) {\n    this._pointsLayer.updatePoints(frameStartTime, frameEndTime);\n  }\n  if (this._segmentsLayer) {\n    this._segmentsLayer.updateSegments(frameStartTime, frameEndTime);\n  }\n};\nWaveformOverview.prototype.containerWidthChange = function () {\n  return this._resampleAndSetWaveformData(this._originalWaveformData, this._width);\n};\nWaveformOverview.prototype.containerHeightChange = function () {\n  this._highlightLayer.fitToView();\n};\nWaveformOverview.prototype.destroy = function () {\n  // Unregister event handlers\n  this._peaks.off('player.playing', this._onPlaying);\n  this._peaks.off('player.pause', this._onPause);\n  this._peaks.off('player.timeupdate', this._onTimeUpdate);\n  this._peaks.off('zoomview.update', this._onZoomviewUpdate);\n  this._mouseDragHandler.destroy();\n  WaveformView.prototype.destroy.call(this);\n};\n\n/**\n * @file\n *\n * Defines the {@link InsertSegmentMouseDragHandler} class.\n *\n * @module insert-segment-mouse-drag-handler\n */\n\n\n/**\n * Creates a handler for mouse events to allow inserting new waveform\n * segments by clicking and dragging the mouse.\n *\n * @class\n * @alias InsertSegmentMouseDragHandler\n *\n * @param {Peaks} peaks\n * @param {WaveformZoomView} view\n */\n\nfunction InsertSegmentMouseDragHandler(peaks, view) {\n  this._peaks = peaks;\n  this._view = view;\n  this._onMouseDown = this._onMouseDown.bind(this);\n  this._onMouseMove = this._onMouseMove.bind(this);\n  this._onMouseUp = this._onMouseUp.bind(this);\n  this._mouseDragHandler = new MouseDragHandler(view._stage, {\n    onMouseDown: this._onMouseDown,\n    onMouseMove: this._onMouseMove,\n    onMouseUp: this._onMouseUp\n  });\n}\nInsertSegmentMouseDragHandler.prototype.isDragging = function () {\n  return this._mouseDragHandler.isDragging();\n};\nInsertSegmentMouseDragHandler.prototype._reset = function () {\n  this._insertSegment = null;\n  this._insertSegmentShape = null;\n  this._segmentIsDraggable = false;\n  this._peaks.segments.setInserting(false);\n};\nInsertSegmentMouseDragHandler.prototype._onMouseDown = function (mousePosX, segment) {\n  this._reset();\n  this._segment = segment;\n  if (this._segment) {\n    if (this._view.getSegmentDragMode() !== 'overlap') {\n      return;\n    } else {\n      // The user has clicked within a segment. We want to prevent\n      // the segment from being dragged while the user inserts a new\n      // segment. So we temporarily make the segment non-draggable,\n      // and restore its draggable state in onMouseUp().\n      this._segmentIsDraggable = this._segment.draggable();\n      this._segment.draggable(false);\n    }\n  }\n  var time = this._view.pixelsToTime(mousePosX + this._view.getFrameOffset());\n  this._peaks.segments.setInserting(true);\n  this._insertSegment = this._peaks.segments.add({\n    startTime: time,\n    endTime: time,\n    editable: true\n  });\n  this._insertSegmentShape = this._view._segmentsLayer.getSegmentShape(this._insertSegment);\n  if (this._insertSegmentShape) {\n    this._insertSegmentShape.moveMarkersToTop();\n    this._insertSegmentShape.startDrag();\n  }\n};\nInsertSegmentMouseDragHandler.prototype._onMouseMove = function () {};\nInsertSegmentMouseDragHandler.prototype._onMouseUp = function () {\n  if (!this._insertSegment) {\n    return;\n  }\n  if (this._insertSegmentShape) {\n    this._insertSegmentShape.stopDrag();\n    this._insertSegmentShape = null;\n  }\n\n  // If the user was dragging within an existing segment,\n  // restore the segment's original draggable state.\n  if (this._segment && this._segmentIsDraggable) {\n    this._segment.draggable(true);\n  }\n  this._peaks.emit('segments.insert', {\n    segment: this._insertSegment\n  });\n  this._peaks.segments.setInserting(false);\n};\nInsertSegmentMouseDragHandler.prototype.destroy = function () {\n  this._mouseDragHandler.destroy();\n};\n\n/**\n * @file\n *\n * Defines the {@link ScrollMouseDragHandler} class.\n *\n * @module scroll-mouse-drag-handler\n */\n\n\n/**\n * Creates a handler for mouse events to allow scrolling the zoomable\n * waveform view by clicking and dragging the mouse.\n *\n * @class\n * @alias ScrollMouseDragHandler\n *\n * @param {Peaks} peaks\n * @param {WaveformZoomView} view\n */\n\nfunction ScrollMouseDragHandler(peaks, view) {\n  this._peaks = peaks;\n  this._view = view;\n  this._seeking = false;\n  this._firstMove = false;\n  this._segment = null;\n  this._segmentIsDraggable = false;\n  this._initialFrameOffset = 0;\n  this._mouseDownX = 0;\n  this._onMouseDown = this._onMouseDown.bind(this);\n  this._onMouseMove = this._onMouseMove.bind(this);\n  this._onMouseUp = this._onMouseUp.bind(this);\n  this._mouseDragHandler = new MouseDragHandler(view._stage, {\n    onMouseDown: this._onMouseDown,\n    onMouseMove: this._onMouseMove,\n    onMouseUp: this._onMouseUp\n  });\n}\nScrollMouseDragHandler.prototype.isDragging = function () {\n  return this._mouseDragHandler.isDragging();\n};\nScrollMouseDragHandler.prototype._onMouseDown = function (mousePosX, segment) {\n  this._seeking = false;\n  this._firstMove = true;\n  if (segment && !segment.attrs.draggable) {\n    this._segment = null;\n  } else {\n    this._segment = segment;\n  }\n  var playheadOffset = this._view.getPlayheadOffset();\n  if (this._view.isSeekEnabled() && Math.abs(mousePosX - playheadOffset) <= this._view.getPlayheadClickTolerance()) {\n    this._seeking = true;\n\n    // The user has clicked near the playhead, and the playhead is within\n    // a segment. In this case we want to allow the playhead to move, but\n    // prevent the segment from being dragged. So we temporarily make the\n    // segment non-draggable, and restore its draggable state in onMouseUp().\n    if (this._segment) {\n      this._segmentIsDraggable = this._segment.draggable();\n      this._segment.draggable(false);\n    }\n  }\n  if (this._seeking) {\n    mousePosX = clamp(mousePosX, 0, this._view.getWidth());\n    var time = this._view.pixelsToTime(mousePosX + this._view.getFrameOffset());\n    this._seek(time);\n  } else {\n    this._initialFrameOffset = this._view.getFrameOffset();\n    this._mouseDownX = mousePosX;\n  }\n};\nScrollMouseDragHandler.prototype._onMouseMove = function (mousePosX) {\n  // Prevent scrolling the waveform if the user is dragging a segment.\n  if (this._segment && !this._seeking) {\n    return;\n  }\n  if (this._seeking) {\n    if (this._firstMove) {\n      this._view.dragSeek(true);\n      this._firstMove = false;\n    }\n    mousePosX = clamp(mousePosX, 0, this._view.getWidth());\n    var time = this._view.pixelsToTime(mousePosX + this._view.getFrameOffset());\n    this._seek(time);\n  } else {\n    // TODO: Prevent scrolling when zoomed to fit the waveform to the\n    // view width. Sometimes the waveform is a few pixels longer.\n    if (!this._view.isAutoZoom()) {\n      // Moving the mouse to the left increases the time position of the\n      // left-hand edge of the visible waveform.\n      var diff = this._mouseDownX - mousePosX;\n      var newFrameOffset = this._initialFrameOffset + diff;\n      if (newFrameOffset !== this._initialFrameOffset) {\n        this._view.updateWaveform(newFrameOffset);\n      }\n    }\n  }\n};\nScrollMouseDragHandler.prototype._onMouseUp = function () {\n  if (this._seeking) {\n    this._view.dragSeek(false);\n  } else {\n    // Set playhead position only on click release, when not dragging.\n    if (this._view._enableSeek && !this._mouseDragHandler.isDragging()) {\n      var time = this._view.pixelOffsetToTime(this._mouseDownX);\n      this._seek(time);\n    }\n  }\n\n  // If the user was dragging within an existing segment,\n  // restore the segment's original draggable state.\n  if (this._segment && this._seeking) {\n    if (this._segmentIsDraggable) {\n      this._segment.draggable(true);\n    }\n  }\n};\nScrollMouseDragHandler.prototype._seek = function (time) {\n  var duration = this._peaks.player.getDuration();\n\n  // Prevent the playhead position from jumping by limiting click\n  // handling to the waveform duration.\n  if (time > duration) {\n    time = duration;\n  }\n\n  // Update the playhead position. This gives a smoother visual update\n  // than if we only use the player.timeupdate event.\n  this._view.updatePlayheadTime(time);\n  this._peaks.player.seek(time);\n};\nScrollMouseDragHandler.prototype.destroy = function () {\n  this._mouseDragHandler.destroy();\n};\n\n/**\n * @file\n *\n * Defines the {@link WaveformZoomView} class.\n *\n * @module waveform-zoomview\n */\n\n\n/**\n * Creates a zoomable waveform view.\n *\n * @class\n * @alias WaveformZoomView\n *\n * @param {WaveformData} waveformData\n * @param {HTMLElement} container\n * @param {Peaks} peaks\n */\n\nfunction WaveformZoomView(waveformData, container, peaks) {\n  var self = this;\n  WaveformView.call(self, waveformData, container, peaks, peaks.options.zoomview);\n\n  // Bind event handlers\n  self._onTimeUpdate = self._onTimeUpdate.bind(self);\n  self._onPlaying = self._onPlaying.bind(self);\n  self._onPause = self._onPause.bind(self);\n  self._onKeyboardLeft = self._onKeyboardLeft.bind(self);\n  self._onKeyboardRight = self._onKeyboardRight.bind(self);\n  self._onKeyboardShiftLeft = self._onKeyboardShiftLeft.bind(self);\n  self._onKeyboardShiftRight = self._onKeyboardShiftRight.bind(self);\n\n  // Register event handlers\n  self._peaks.on('player.timeupdate', self._onTimeUpdate);\n  self._peaks.on('player.playing', self._onPlaying);\n  self._peaks.on('player.pause', self._onPause);\n  self._peaks.on('keyboard.left', self._onKeyboardLeft);\n  self._peaks.on('keyboard.right', self._onKeyboardRight);\n  self._peaks.on('keyboard.shift_left', self._onKeyboardShiftLeft);\n  self._peaks.on('keyboard.shift_right', self._onKeyboardShiftRight);\n  self._autoScroll = self._viewOptions.autoScroll;\n  self._autoScrollOffset = self._viewOptions.autoScrollOffset;\n  self._enableSegmentDragging = false;\n  self._segmentDragMode = 'overlap';\n  self._minSegmentDragWidth = 0;\n  self._insertSegmentShape = null;\n  self._playheadClickTolerance = self._viewOptions.playheadClickTolerance;\n  self._zoomLevelAuto = false;\n  self._zoomLevelSeconds = null;\n  var time = self._peaks.player.getCurrentTime();\n  self._syncPlayhead(time);\n  self._mouseDragHandler = new ScrollMouseDragHandler(peaks, self);\n  self._onWheel = self._onWheel.bind(self);\n  self._onWheelCaptureVerticalScroll = self._onWheelCaptureVerticalScroll.bind(self);\n  self.setWheelMode(self._viewOptions.wheelMode);\n  self._peaks.emit('zoomview.update', {\n    startTime: 0,\n    endTime: self.getEndTime()\n  });\n}\nWaveformZoomView.prototype = Object.create(WaveformView.prototype);\nWaveformZoomView.prototype.initWaveformData = function () {\n  this._enableWaveformCache = this._options.waveformCache;\n  this._initWaveformCache();\n  var initialZoomLevel = this._peaks.zoom.getZoomLevel();\n  this._resampleData({\n    scale: initialZoomLevel\n  });\n};\nWaveformZoomView.prototype._initWaveformCache = function () {\n  if (this._enableWaveformCache) {\n    this._waveformData = new Map();\n    this._waveformData.set(this._originalWaveformData.scale, this._originalWaveformData);\n    this._waveformScales = [this._originalWaveformData.scale];\n  }\n};\nWaveformZoomView.prototype.initHighlightLayer = function () {};\nWaveformZoomView.prototype.setWheelMode = function (mode, options) {\n  if (!options) {\n    options = {};\n  }\n  if (mode !== this._wheelMode || options.captureVerticalScroll !== this._captureVerticalScroll) {\n    this._stage.off('wheel');\n    this._wheelMode = mode;\n    this._captureVerticalScroll = options.captureVerticalScroll;\n    switch (mode) {\n      case 'scroll':\n        if (options.captureVerticalScroll) {\n          this._stage.on('wheel', this._onWheelCaptureVerticalScroll);\n        } else {\n          this._stage.on('wheel', this._onWheel);\n        }\n        break;\n    }\n  }\n};\nWaveformZoomView.prototype._onWheel = function (event) {\n  var wheelEvent = event.evt;\n  var delta;\n  if (wheelEvent.shiftKey) {\n    if (wheelEvent.deltaY !== 0) {\n      delta = wheelEvent.deltaY;\n    } else if (wheelEvent.deltaX !== 0) {\n      delta = wheelEvent.deltaX;\n    } else {\n      return;\n    }\n  } else {\n    // Ignore the event if it looks like the user is scrolling vertically\n    // down the page\n    if (Math.abs(wheelEvent.deltaX) < Math.abs(wheelEvent.deltaY)) {\n      return;\n    }\n    delta = wheelEvent.deltaX;\n  }\n  if (wheelEvent.deltaMode === WheelEvent.DOM_DELTA_PAGE) {\n    delta *= this._width;\n  }\n  wheelEvent.preventDefault();\n  var frameOffset = clamp(this._frameOffset + Math.floor(delta), 0, this._pixelLength - this._width);\n  this.updateWaveform(frameOffset, false);\n};\nWaveformZoomView.prototype._onWheelCaptureVerticalScroll = function (event) {\n  var wheelEvent = event.evt;\n  var delta = Math.abs(wheelEvent.deltaX) < Math.abs(wheelEvent.deltaY) ? wheelEvent.deltaY : wheelEvent.deltaX;\n  wheelEvent.preventDefault();\n  var frameOffset = clamp(this._frameOffset + Math.floor(delta), 0, this._pixelLength - this._width);\n  this.updateWaveform(frameOffset, false);\n};\nWaveformZoomView.prototype.setWaveformDragMode = function (mode) {\n  if (this._segmentsLayer) {\n    this._mouseDragHandler.destroy();\n    this.dragSeek(false);\n    if (mode === 'insert-segment') {\n      this._mouseDragHandler = new InsertSegmentMouseDragHandler(this._peaks, this);\n    } else {\n      this._mouseDragHandler = new ScrollMouseDragHandler(this._peaks, this);\n    }\n  }\n};\nWaveformZoomView.prototype.enableSegmentDragging = function (enable) {\n  this._enableSegmentDragging = enable;\n\n  // Update all existing segments\n  if (this._segmentsLayer) {\n    this._segmentsLayer.enableSegmentDragging(enable);\n  }\n};\nWaveformZoomView.prototype.isSegmentDraggingEnabled = function () {\n  return this._enableSegmentDragging;\n};\nWaveformZoomView.prototype.setSegmentDragMode = function (mode) {\n  this._segmentDragMode = mode;\n};\nWaveformZoomView.prototype.getSegmentDragMode = function () {\n  return this._segmentDragMode;\n};\nWaveformZoomView.prototype.getName = function () {\n  return 'zoomview';\n};\nWaveformZoomView.prototype._onTimeUpdate = function (time) {\n  if (this._mouseDragHandler.isDragging()) {\n    return;\n  }\n  this._syncPlayhead(time);\n};\nWaveformZoomView.prototype._onPlaying = function (time) {\n  this._playheadLayer.updatePlayheadTime(time);\n};\nWaveformZoomView.prototype._onPause = function (time) {\n  this._playheadLayer.stop(time);\n};\nWaveformZoomView.prototype._onKeyboardLeft = function () {\n  this._keyboardScroll(-1, false);\n};\nWaveformZoomView.prototype._onKeyboardRight = function () {\n  this._keyboardScroll(1, false);\n};\nWaveformZoomView.prototype._onKeyboardShiftLeft = function () {\n  this._keyboardScroll(-1, true);\n};\nWaveformZoomView.prototype._onKeyboardShiftRight = function () {\n  this._keyboardScroll(1, true);\n};\nWaveformZoomView.prototype._keyboardScroll = function (direction, large) {\n  var increment;\n  if (large) {\n    increment = direction * this._width;\n  } else {\n    increment = direction * this.timeToPixels(this._options.nudgeIncrement);\n  }\n  this.scrollWaveform({\n    pixels: increment\n  });\n};\nWaveformZoomView.prototype.setWaveformData = function (waveformData) {\n  this._originalWaveformData = waveformData;\n  // Clear cached waveforms\n  this._initWaveformCache();\n\n  // Don't update the UI here, call setZoom().\n};\n\n/**\n * Returns the position of the playhead marker, in pixels relative to the\n * left hand side of the waveform view.\n *\n * @return {Number}\n */\n\nWaveformZoomView.prototype.getPlayheadOffset = function () {\n  return this._playheadLayer.getPlayheadPixel() - this._frameOffset;\n};\nWaveformZoomView.prototype.getPlayheadClickTolerance = function () {\n  return this._playheadClickTolerance;\n};\nWaveformZoomView.prototype._syncPlayhead = function (time) {\n  this._playheadLayer.updatePlayheadTime(time);\n  if (this._autoScroll && !this._zoomLevelAuto) {\n    // Check for the playhead reaching the right-hand side of the window.\n\n    var pixelIndex = this.timeToPixels(time);\n\n    // TODO: move this code to animation function?\n    // TODO: don't scroll if user has positioned view manually (e.g., using\n    // the keyboard)\n    var endThreshold = this._frameOffset + this._width - this._autoScrollOffset;\n    var frameOffset = this._frameOffset;\n    if (pixelIndex >= endThreshold || pixelIndex < frameOffset) {\n      // Put the playhead at 100 pixels from the left edge\n      frameOffset = pixelIndex - this._autoScrollOffset;\n      if (frameOffset < 0) {\n        frameOffset = 0;\n      }\n      this.updateWaveform(frameOffset, false);\n    }\n  }\n};\nWaveformZoomView.prototype._getScale = function (duration) {\n  return Math.floor(duration * this._data.sample_rate / this._width);\n};\nfunction isAutoScale(options) {\n  return objectHasProperty(options, 'scale') && options.scale === 'auto' || objectHasProperty(options, 'seconds') && options.seconds === 'auto';\n}\n\n/**\n * Options for [WaveformZoomView.setZoom]{@link WaveformZoomView#setZoom}.\n *\n * @typedef {Object} SetZoomOptions\n * @global\n * @property {Number|String} scale Zoom level, in samples per pixel, or 'auto'\n *   to fit the entire waveform to the view width\n * @property {Number|String} seconds Number of seconds to fit to the view width,\n *   or 'auto' to fit the entire waveform to the view width\n */\n\n/**\n * Changes the zoom level.\n *\n * @param {SetZoomOptions} options\n * @returns {Boolean}\n */\n\nWaveformZoomView.prototype.setZoom = function (options) {\n  var scale;\n  if (isAutoScale(options)) {\n    // Use waveform duration, to match WaveformOverview\n    var seconds = this._originalWaveformData.duration;\n    this._zoomLevelAuto = true;\n    this._zoomLevelSeconds = null;\n    scale = this._getScale(seconds);\n  } else {\n    if (objectHasProperty(options, 'scale')) {\n      this._zoomLevelSeconds = null;\n      scale = Math.floor(options.scale);\n    } else if (objectHasProperty(options, 'seconds')) {\n      if (!isValidTime(options.seconds)) {\n        return false;\n      }\n      this._zoomLevelSeconds = options.seconds;\n      scale = this._getScale(options.seconds);\n    }\n    this._zoomLevelAuto = false;\n  }\n  if (scale < this._originalWaveformData.scale) {\n    // eslint-disable-next-line @stylistic/js/max-len\n    this._peaks._logger('peaks.zoomview.setZoom(): zoom level must be at least ' + this._originalWaveformData.scale);\n    scale = this._originalWaveformData.scale;\n  }\n  var currentTime = this._peaks.player.getCurrentTime();\n  var apexTime;\n  var playheadOffsetPixels = this.getPlayheadOffset();\n  if (playheadOffsetPixels >= 0 && playheadOffsetPixels < this._width) {\n    // Playhead is visible. Change the zoom level while keeping the\n    // playhead at the same position in the window.\n    apexTime = currentTime;\n  } else {\n    // Playhead is not visible. Change the zoom level while keeping the\n    // centre of the window at the same position in the waveform.\n    playheadOffsetPixels = Math.floor(this._width / 2);\n    apexTime = this.pixelOffsetToTime(playheadOffsetPixels);\n  }\n  var prevScale = this._scale;\n  this._resampleData({\n    scale: scale\n  });\n  var apexPixel = this.timeToPixels(apexTime);\n  var frameOffset = apexPixel - playheadOffsetPixels;\n  this.updateWaveform(frameOffset, true);\n  this._playheadLayer.zoomLevelChanged();\n\n  // Update the playhead position after zooming.\n  this._playheadLayer.updatePlayheadTime(currentTime);\n  this._peaks.emit('zoom.update', {\n    currentZoom: scale,\n    previousZoom: prevScale\n  });\n  return true;\n};\nWaveformZoomView.prototype._resampleData = function (options) {\n  var scale = options.scale;\n  if (this._enableWaveformCache) {\n    if (!this._waveformData.has(scale)) {\n      var sourceWaveform = this._originalWaveformData;\n\n      // Resample from the next lowest available zoom level\n\n      for (var i = 0; i < this._waveformScales.length; i++) {\n        if (this._waveformScales[i] < scale) {\n          sourceWaveform = this._waveformData.get(this._waveformScales[i]);\n        } else {\n          break;\n        }\n      }\n      this._waveformData.set(scale, sourceWaveform.resample(options));\n      this._waveformScales.push(scale);\n      this._waveformScales.sort(function (a, b) {\n        return a - b; // Ascending order\n      });\n    }\n    this._data = this._waveformData.get(scale);\n  } else {\n    this._data = this._originalWaveformData.resample(options);\n  }\n  this._scale = this._data.scale;\n  this._pixelLength = this._data.length;\n};\nWaveformZoomView.prototype.isAutoZoom = function () {\n  return this._zoomLevelAuto;\n};\nWaveformZoomView.prototype.setStartTime = function (time) {\n  if (time < 0) {\n    time = 0;\n  }\n  if (this._zoomLevelAuto) {\n    time = 0;\n  }\n  this.updateWaveform(this.timeToPixels(time), false);\n};\n\n/**\n * @returns {Number} The length of the waveform, in pixels.\n */\n\nWaveformZoomView.prototype.getPixelLength = function () {\n  return this._pixelLength;\n};\n\n/**\n * Scrolls the region of waveform shown in the view.\n *\n * @param {Number} scrollAmount How far to scroll, in pixels\n */\n\nWaveformZoomView.prototype.scrollWaveform = function (options) {\n  var scrollAmount;\n  if (objectHasProperty(options, 'pixels')) {\n    scrollAmount = Math.floor(options.pixels);\n  } else if (objectHasProperty(options, 'seconds')) {\n    scrollAmount = this.timeToPixels(options.seconds);\n  } else {\n    throw new TypeError('view.scrollWaveform(): Missing umber of pixels or seconds');\n  }\n  this.updateWaveform(this._frameOffset + scrollAmount, false);\n};\n\n/**\n * Updates the region of waveform shown in the view.\n *\n * @param {Number} frameOffset The new frame offset, in pixels.\n * @param {Boolean} forceUpdate Forces the waveform view to be redrawn, if the\n *   frameOffset is unchanged.\n */\n\nWaveformZoomView.prototype.updateWaveform = function (frameOffset, forceUpdate) {\n  var upperLimit;\n  if (this._pixelLength < this._width) {\n    // Total waveform is shorter than viewport, so reset the offset to 0.\n    frameOffset = 0;\n    upperLimit = this._width;\n  } else {\n    // Calculate the very last possible position.\n    upperLimit = this._pixelLength - this._width;\n  }\n  frameOffset = clamp(frameOffset, 0, upperLimit);\n  if (!forceUpdate && frameOffset === this._frameOffset) {\n    return;\n  }\n  this._frameOffset = frameOffset;\n\n  // Display playhead if it is within the zoom frame width.\n  var playheadPixel = this._playheadLayer.getPlayheadPixel();\n  this._playheadLayer.updatePlayheadTime(this.pixelsToTime(playheadPixel));\n  this.drawWaveformLayer();\n  this._axisLayer.draw();\n  var frameStartTime = this.getStartTime();\n  var frameEndTime = this.getEndTime();\n  if (this._pointsLayer) {\n    this._pointsLayer.updatePoints(frameStartTime, frameEndTime);\n  }\n  if (this._segmentsLayer) {\n    this._segmentsLayer.updateSegments(frameStartTime, frameEndTime);\n  }\n  this._peaks.emit('zoomview.update', {\n    startTime: frameStartTime,\n    endTime: frameEndTime\n  });\n};\nWaveformZoomView.prototype.enableAutoScroll = function (enable, options) {\n  if (!options) {\n    options = {};\n  }\n  this._autoScroll = enable;\n  if (objectHasProperty(options, 'offset')) {\n    this._autoScrollOffset = options.offset;\n  }\n};\nWaveformZoomView.prototype.getMinSegmentDragWidth = function () {\n  return this._insertSegmentShape ? 0 : this._minSegmentDragWidth;\n};\nWaveformZoomView.prototype.setMinSegmentDragWidth = function (width) {\n  this._minSegmentDragWidth = width;\n};\nWaveformZoomView.prototype.containerWidthChange = function () {\n  var resample = false;\n  var resampleOptions;\n  if (this._zoomLevelAuto) {\n    resample = true;\n    resampleOptions = {\n      width: this._width\n    };\n  } else if (this._zoomLevelSeconds !== null) {\n    resample = true;\n    resampleOptions = {\n      scale: this._getScale(this._zoomLevelSeconds)\n    };\n  }\n  if (resample) {\n    try {\n      this._resampleData(resampleOptions);\n    } catch (error) {// eslint-disable-line no-unused-vars\n      // Ignore, and leave this._data as it was\n    }\n  }\n  return true;\n};\nWaveformZoomView.prototype.containerHeightChange = function () {\n  // Nothing\n};\nWaveformZoomView.prototype.getStage = function () {\n  return this._stage;\n};\nWaveformZoomView.prototype.getSegmentsLayer = function () {\n  return this._segmentsLayer;\n};\nWaveformZoomView.prototype.destroy = function () {\n  // Unregister event handlers\n  this._peaks.off('player.playing', this._onPlaying);\n  this._peaks.off('player.pause', this._onPause);\n  this._peaks.off('player.timeupdate', this._onTimeUpdate);\n  this._peaks.off('keyboard.left', this._onKeyboardLeft);\n  this._peaks.off('keyboard.right', this._onKeyboardRight);\n  this._peaks.off('keyboard.shift_left', this._onKeyboardShiftLeft);\n  this._peaks.off('keyboard.shift_right', this._onKeyboardShiftRight);\n  if (this._enableWaveformCache) {\n    this._waveformData.clear();\n    delete this._waveformData;\n    delete this._waveformScales;\n  } else {\n    delete this._data;\n  }\n  this._mouseDragHandler.destroy();\n  WaveformView.prototype.destroy.call(this);\n};\n\n/**\n * @file\n *\n * Defines the {@link Scrollbar} class.\n *\n * @module scrollbar\n */\n\n\n/**\n * Creates a scrollbar.\n *\n * @class\n * @alias Scrollbar\n *\n * @param {HTMLElement} container\n * @param {Peaks} peaks\n */\n\nfunction Scrollbar(container, peaks) {\n  this._container = container;\n  this._peaks = peaks;\n  this._options = peaks.options.scrollbar;\n  this._zoomview = peaks.views.getView('zoomview');\n  this._dragBoundFunc = this._dragBoundFunc.bind(this);\n  this._onScrollboxDragStart = this._onScrollboxDragStart.bind(this);\n  this._onScrollboxDragMove = this._onScrollboxDragMove.bind(this);\n  this._onScrollboxDragEnd = this._onScrollboxDragEnd.bind(this);\n  this._onZoomviewUpdate = this._onZoomviewUpdate.bind(this);\n  this._onScrollbarClick = this._onScrollbarClick.bind(this);\n  this._peaks.on('zoomview.update', this._onZoomviewUpdate);\n  this._width = container.clientWidth;\n  this._height = container.clientHeight;\n  this._stage = new Konva.Stage({\n    container: container,\n    width: this._width,\n    height: this._height\n  });\n  this._layer = new Konva.Layer();\n  this._stage.on('click', this._onScrollbarClick);\n  this._stage.add(this._layer);\n  this._color = this._options.color;\n  this._scrollboxX = 0;\n  this._minScrollboxWidth = this._options.minWidth;\n  this._offsetY = 0;\n  this._scrollbox = new Konva.Group({\n    draggable: true,\n    dragBoundFunc: this._dragBoundFunc\n  });\n  this._scrollboxRect = new Rect({\n    x: this._scrollboxX,\n    y: this._offsetY,\n    width: 0,\n    height: this._height,\n    fill: this._color\n  });\n  this._scrollbox.add(this._scrollboxRect);\n  this._setScrollboxWidth();\n  this._scrollbox.on('dragstart', this._onScrollboxDragStart);\n  this._scrollbox.on('dragmove', this._onScrollboxDragMove);\n  this._scrollbox.on('dragend', this._onScrollboxDragEnd);\n  this._layer.add(this._scrollbox);\n  this._updateScrollbarWidthAndPosition();\n}\nScrollbar.prototype.setZoomview = function (zoomview) {\n  this._zoomview = zoomview;\n  this._updateScrollbarWidthAndPosition();\n};\n\n/**\n * Sets the width of the scrollbox, based on the visible waveform region\n * in the zoomview and minimum scrollbox width option.\n */\n\nScrollbar.prototype._setScrollboxWidth = function () {\n  if (this._zoomview) {\n    this._scrollboxWidth = Math.floor(this._width * this._zoomview.pixelsToTime(this._zoomview.getWidth()) / this._peaks.player.getDuration());\n    if (this._scrollboxWidth < this._minScrollboxWidth) {\n      this._scrollboxWidth = this._minScrollboxWidth;\n    }\n  } else {\n    this._scrollboxWidth = this._width;\n  }\n  this._scrollboxRect.width(this._scrollboxWidth);\n};\n\n/**\n * @returns {Number} The maximum scrollbox position, in pixels.\n */\n\nScrollbar.prototype._getScrollbarRange = function () {\n  return this._width - this._scrollboxWidth;\n};\nScrollbar.prototype._dragBoundFunc = function (pos) {\n  // Allow the scrollbar to be moved horizontally but not vertically.\n  return {\n    x: pos.x,\n    y: 0\n  };\n};\nScrollbar.prototype._onScrollboxDragStart = function () {\n  this._dragging = true;\n};\nScrollbar.prototype._onScrollboxDragEnd = function () {\n  this._dragging = false;\n};\nScrollbar.prototype._onScrollboxDragMove = function () {\n  var range = this._getScrollbarRange();\n  var x = clamp(this._scrollbox.x(), 0, range);\n  this._scrollbox.x(x);\n  if (x !== this._scrollboxX) {\n    this._scrollboxX = x;\n    if (this._zoomview) {\n      this._updateWaveform(x);\n    }\n  }\n};\nScrollbar.prototype._onZoomviewUpdate = function /* event */\n() {\n  if (!this._dragging) {\n    this._updateScrollbarWidthAndPosition();\n  }\n};\nScrollbar.prototype._updateScrollbarWidthAndPosition = function () {\n  this._setScrollboxWidth();\n  if (this._zoomview) {\n    var startTime = this._zoomview.getStartTime();\n    var zoomviewRange = this._zoomview.getPixelLength() - this._zoomview.getWidth();\n    var scrollBoxPos = Math.floor(this._zoomview.timeToPixels(startTime) * this._getScrollbarRange() / zoomviewRange);\n    this._scrollbox.x(scrollBoxPos);\n    this._layer.draw();\n  }\n};\nScrollbar.prototype._onScrollbarClick = function (event) {\n  // Handle clicks on the scrollbar outside the scrollbox.\n  if (event.target === this._stage) {\n    if (this._zoomview) {\n      // Centre the scrollbox where the user clicked.\n      var x = Math.floor(event.evt.offsetX - this._scrollboxWidth / 2);\n      if (x < 0) {\n        x = 0;\n      }\n      this._updateWaveform(x);\n    }\n  }\n};\n\n/**\n * Sets the zoomview waveform position based on scrollbar position.\n */\n\nScrollbar.prototype._updateWaveform = function (x) {\n  var offset = Math.floor((this._zoomview.getPixelLength() - this._zoomview.getWidth()) * x / this._getScrollbarRange());\n  this._zoomview.updateWaveform(offset);\n};\nScrollbar.prototype.fitToContainer = function () {\n  if (this._container.clientWidth === 0 && this._container.clientHeight === 0) {\n    return;\n  }\n  if (this._container.clientWidth !== this._width) {\n    this._width = this._container.clientWidth;\n    this._stage.width(this._width);\n    this._updateScrollbarWidthAndPosition();\n  }\n  this._height = this._container.clientHeight;\n  this._stage.height(this._height);\n};\nScrollbar.prototype.destroy = function () {\n  this._peaks.off('zoomview.update', this._onZoomviewUpdate);\n  this._layer.destroy();\n  this._stage.destroy();\n  this._stage = null;\n};\n\n/**\n * @file\n *\n * Defines the {@link ViewController} class.\n *\n * @module view-controller\n */\n\n\n/**\n * Creates an object that allows users to create and manage waveform views.\n *\n * @class\n * @alias ViewController\n *\n * @param {Peaks} peaks\n */\n\nfunction ViewController(peaks) {\n  this._peaks = peaks;\n  this._overview = null;\n  this._zoomview = null;\n  this._scrollbar = null;\n}\nViewController.prototype.createOverview = function (container) {\n  if (this._overview) {\n    return this._overview;\n  }\n  var waveformData = this._peaks.getWaveformData();\n  this._overview = new WaveformOverview(waveformData, container, this._peaks);\n  if (this._zoomview) {\n    this._overview.showHighlight(this._zoomview.getStartTime(), this._zoomview.getEndTime());\n  }\n  return this._overview;\n};\nViewController.prototype.createZoomview = function (container) {\n  if (this._zoomview) {\n    return this._zoomview;\n  }\n  var waveformData = this._peaks.getWaveformData();\n  this._zoomview = new WaveformZoomView(waveformData, container, this._peaks);\n  if (this._scrollbar) {\n    this._scrollbar.setZoomview(this._zoomview);\n  }\n  return this._zoomview;\n};\nViewController.prototype.createScrollbar = function (container) {\n  this._scrollbar = new Scrollbar(container, this._peaks);\n  return this._scrollbar;\n};\nViewController.prototype.destroyOverview = function () {\n  if (!this._overview) {\n    return;\n  }\n  if (!this._zoomview) {\n    return;\n  }\n  this._overview.destroy();\n  this._overview = null;\n};\nViewController.prototype.destroyZoomview = function () {\n  if (!this._zoomview) {\n    return;\n  }\n  if (!this._overview) {\n    return;\n  }\n  this._zoomview.destroy();\n  this._zoomview = null;\n  this._overview.removeHighlightRect();\n};\nViewController.prototype.destroy = function () {\n  if (this._overview) {\n    this._overview.destroy();\n    this._overview = null;\n  }\n  if (this._zoomview) {\n    this._zoomview.destroy();\n    this._zoomview = null;\n  }\n  if (this._scrollbar) {\n    this._scrollbar.destroy();\n    this._scrollbar = null;\n  }\n};\nViewController.prototype.getView = function (name) {\n  if (isNullOrUndefined(name)) {\n    if (this._overview && this._zoomview) {\n      return null;\n    } else if (this._overview) {\n      return this._overview;\n    } else if (this._zoomview) {\n      return this._zoomview;\n    } else {\n      return null;\n    }\n  } else {\n    switch (name) {\n      case 'overview':\n        return this._overview;\n      case 'zoomview':\n        return this._zoomview;\n      default:\n        return null;\n    }\n  }\n};\nViewController.prototype.getScrollbar = function () {\n  return this._scrollbar;\n};\n\n/**\n * @file\n *\n * Defines the {@link ZoomController} class.\n *\n * @module zoom-controller\n */\n\n/**\n * Creates an object to control zoom levels in a {@link WaveformZoomView}.\n *\n * @class\n * @alias ZoomController\n *\n * @param {Peaks} peaks\n * @param {Array<Integer>} zoomLevels\n */\n\nfunction ZoomController(peaks, zoomLevels) {\n  this._peaks = peaks;\n  this._zoomLevels = zoomLevels;\n  this._zoomLevelIndex = 0;\n}\nZoomController.prototype.setZoomLevels = function (zoomLevels) {\n  this._zoomLevels = zoomLevels;\n  this.setZoom(0, true);\n};\n\n/**\n * Zoom in one level.\n */\n\nZoomController.prototype.zoomIn = function () {\n  this.setZoom(this._zoomLevelIndex - 1, false);\n};\n\n/**\n * Zoom out one level.\n */\n\nZoomController.prototype.zoomOut = function () {\n  this.setZoom(this._zoomLevelIndex + 1, false);\n};\n\n/**\n * Given a particular zoom level, triggers a resampling of the data in the\n * zoomed view.\n *\n * @param {number} zoomLevelIndex An index into the options.zoomLevels array.\n */\n\nZoomController.prototype.setZoom = function (zoomLevelIndex, forceUpdate) {\n  if (zoomLevelIndex >= this._zoomLevels.length) {\n    zoomLevelIndex = this._zoomLevels.length - 1;\n  }\n  if (zoomLevelIndex < 0) {\n    zoomLevelIndex = 0;\n  }\n  if (!forceUpdate && zoomLevelIndex === this._zoomLevelIndex) {\n    // Nothing to do.\n    return;\n  }\n  this._zoomLevelIndex = zoomLevelIndex;\n  var zoomview = this._peaks.views.getView('zoomview');\n  if (!zoomview) {\n    return;\n  }\n  zoomview.setZoom({\n    scale: this._zoomLevels[zoomLevelIndex]\n  });\n};\n\n/**\n * Returns the current zoom level index.\n *\n * @returns {Number}\n */\n\nZoomController.prototype.getZoom = function () {\n  return this._zoomLevelIndex;\n};\n\n/**\n * Returns the current zoom level, in samples per pixel.\n *\n * @returns {Number}\n */\n\nZoomController.prototype.getZoomLevel = function () {\n  return this._zoomLevels[this._zoomLevelIndex];\n};\n\n/**\n * @file\n *\n * Defines the {@link WaveformBuilder} class.\n *\n * @module waveform-builder\n */\n\nvar isXhr2 = 'withCredentials' in new XMLHttpRequest();\n\n/**\n * Creates and returns a WaveformData object, either by requesting the\n * waveform data from the server, or by creating the waveform data using the\n * Web Audio API.\n *\n * @class\n * @alias WaveformBuilder\n *\n * @param {Peaks} peaks\n */\n\nfunction WaveformBuilder(peaks) {\n  this._peaks = peaks;\n}\n\n/**\n * Options for requesting remote waveform data.\n *\n * @typedef {Object} RemoteWaveformDataOptions\n * @global\n * @property {String=} arraybuffer\n * @property {String=} json\n */\n\n/**\n * Options for supplying local waveform data.\n *\n * @typedef {Object} LocalWaveformDataOptions\n * @global\n * @property {ArrayBuffer=} arraybuffer\n * @property {Object=} json\n */\n\n/**\n * Options for the Web Audio waveform builder.\n *\n * @typedef {Object} WaveformBuilderWebAudioOptions\n * @global\n * @property {AudioContext} audioContext\n * @property {AudioBuffer=} audioBuffer\n * @property {Number=} scale\n * @property {Boolean=} multiChannel\n */\n\n/**\n * Options for [WaveformBuilder.init]{@link WaveformBuilder#init}.\n *\n * @typedef {Object} WaveformBuilderInitOptions\n * @global\n * @property {RemoteWaveformDataOptions=} dataUri\n * @property {LocalWaveformDataOptions=} waveformData\n * @property {WaveformBuilderWebAudioOptions=} webAudio\n * @property {Boolean=} withCredentials\n * @property {Array<Number>=} zoomLevels\n */\n\n/**\n * Callback for receiving the waveform data.\n *\n * @callback WaveformBuilderInitCallback\n * @global\n * @param {Error} error\n * @param {WaveformData} waveformData\n */\n\n/**\n * Loads or creates the waveform data.\n *\n * @private\n * @param {WaveformBuilderInitOptions} options\n * @param {WaveformBuilderInitCallback} callback\n */\n\nWaveformBuilder.prototype.init = function (options, callback) {\n  if (options.dataUri && (options.webAudio || options.audioContext) || options.waveformData && (options.webAudio || options.audioContext) || options.dataUri && options.waveformData) {\n    // eslint-disable-next-line @stylistic/js/max-len\n    callback(new TypeError('Peaks.init(): You may only pass one source (webAudio, dataUri, or waveformData) to render waveform data.'));\n    return;\n  }\n  if (options.audioContext) {\n    // eslint-disable-next-line @stylistic/js/max-len\n    this._peaks._logger('Peaks.init(): The audioContext option is deprecated, please pass a webAudio object instead');\n    options.webAudio = {\n      audioContext: options.audioContext\n    };\n  }\n  if (options.dataUri) {\n    return this._getRemoteWaveformData(options, callback);\n  } else if (options.waveformData) {\n    return this._buildWaveformFromLocalData(options, callback);\n  } else if (options.webAudio) {\n    if (options.webAudio.audioBuffer) {\n      return this._buildWaveformDataFromAudioBuffer(options, callback);\n    } else {\n      return this._buildWaveformDataUsingWebAudio(options, callback);\n    }\n  } else {\n    // eslint-disable-next-line @stylistic/js/max-len\n    callback(new Error('Peaks.init(): You must pass an audioContext, or dataUri, or waveformData to render waveform data'));\n  }\n};\nfunction hasValidContentRangeHeader(xhr) {\n  var contentRange = xhr.getResponseHeader('content-range');\n  if (!contentRange) {\n    return false;\n  }\n  var matches = contentRange.match(/^bytes (\\d+)-(\\d+)\\/(\\d+)$/);\n  if (matches && matches.length === 4) {\n    var firstPos = parseInt(matches[1], 10);\n    var lastPos = parseInt(matches[2], 10);\n    var length = parseInt(matches[3], 10);\n    if (firstPos === 0 && lastPos + 1 === length) {\n      return true;\n    }\n    return false;\n  }\n  return false;\n}\n\n/* eslint-disable @stylistic/js/max-len */\n\n/**\n * Fetches waveform data, based on the given options.\n *\n * @private\n * @param {Object} options\n * @param {String|Object} options.dataUri\n * @param {String} options.dataUri.arraybuffer Waveform data URL\n *   (binary format)\n * @param {String} options.dataUri.json Waveform data URL (JSON format)\n * @param {String} options.defaultUriFormat Either 'arraybuffer' (for binary\n *   data) or 'json'\n * @param {WaveformBuilderInitCallback} callback\n *\n * @see Refer to the <a href=\"https://codeberg.org/chrisn/audiowaveform/src/branch/master/doc/DataFormat.md\">data format documentation</a>\n *   for details of the binary and JSON waveform data formats.\n */\n\n/* eslint-enable @stylistic/js/max-len */\n\nWaveformBuilder.prototype._getRemoteWaveformData = function (options, callback) {\n  var self = this;\n  var dataUri = null;\n  var requestType = null;\n  var url;\n  if (isObject(options.dataUri)) {\n    dataUri = options.dataUri;\n  } else {\n    callback(new TypeError('Peaks.init(): The dataUri option must be an object'));\n    return;\n  }\n  ['ArrayBuffer', 'JSON'].some(function (connector) {\n    if (window[connector]) {\n      requestType = connector.toLowerCase();\n      url = dataUri[requestType];\n      return Boolean(url);\n    }\n  });\n  if (!url) {\n    // eslint-disable-next-line @stylistic/js/max-len\n    callback(new Error('Peaks.init(): Unable to determine a compatible dataUri format for this browser'));\n    return;\n  }\n  self._xhr = self._createXHR(url, requestType, options.withCredentials, function (event) {\n    if (this.readyState !== 4) {\n      return;\n    }\n\n    // See https://codeberg.org/chrisn/peaks.js/issues/491\n\n    if (this.status !== 200 && !(this.status === 206 && hasValidContentRangeHeader(this))) {\n      callback(new Error('Unable to fetch remote data. HTTP status ' + this.status));\n      return;\n    }\n    self._xhr = null;\n    var waveformData = WaveformData.create(event.target.response);\n    if (waveformData.channels !== 1 && waveformData.channels !== 2) {\n      callback(new Error('Peaks.init(): Only mono or stereo waveforms are currently supported'));\n      return;\n    } else if (waveformData.bits !== 8) {\n      callback(new Error('Peaks.init(): 16-bit waveform data is not supported'));\n      return;\n    }\n    callback(undefined, waveformData);\n  }, function () {\n    callback(new Error('XHR failed'));\n  }, function () {\n    callback(new Error('XHR aborted'));\n  });\n  self._xhr.send();\n};\n\n/* eslint-disable @stylistic/js/max-len */\n\n/**\n * Creates a waveform from given data, based on the given options.\n *\n * @private\n * @param {Object} options\n * @param {Object} options.waveformData\n * @param {ArrayBuffer} options.waveformData.arraybuffer Waveform data (binary format)\n * @param {Object} options.waveformData.json Waveform data (JSON format)\n * @param {WaveformBuilderInitCallback} callback\n *\n * @see Refer to the <a href=\"https://codeberg.org/chrisn/audiowaveform/src/branch/master/doc/DataFormat.md\">data format documentation</a>\n *   for details of the binary and JSON waveform data formats.\n */\n\n/* eslint-enable @stylistic/js/max-len */\n\nWaveformBuilder.prototype._buildWaveformFromLocalData = function (options, callback) {\n  var waveformData = null;\n  var data = null;\n  if (isObject(options.waveformData)) {\n    waveformData = options.waveformData;\n  } else {\n    callback(new Error('Peaks.init(): The waveformData option must be an object'));\n    return;\n  }\n  if (isObject(waveformData.json)) {\n    data = waveformData.json;\n  } else if (isArrayBuffer(waveformData.arraybuffer)) {\n    data = waveformData.arraybuffer;\n  }\n  if (!data) {\n    callback(new Error('Peaks.init(): Unable to determine a compatible waveformData format'));\n    return;\n  }\n  try {\n    var createdWaveformData = WaveformData.create(data);\n    if (createdWaveformData.channels !== 1 && createdWaveformData.channels !== 2) {\n      callback(new Error('Peaks.init(): Only mono or stereo waveforms are currently supported'));\n      return;\n    } else if (createdWaveformData.bits !== 8) {\n      callback(new Error('Peaks.init(): 16-bit waveform data is not supported'));\n      return;\n    }\n    callback(undefined, createdWaveformData);\n  } catch (err) {\n    callback(err);\n  }\n};\n\n/**\n * Creates waveform data using the Web Audio API.\n *\n * @private\n * @param {Object} options\n * @param {AudioContext} options.audioContext\n * @param {HTMLMediaElement} options.mediaElement\n * @param {WaveformBuilderInitCallback} callback\n */\n\nWaveformBuilder.prototype._buildWaveformDataUsingWebAudio = function (options, callback) {\n  var self = this;\n  var audioContext = window.AudioContext || window.webkitAudioContext;\n  if (!(options.webAudio.audioContext instanceof audioContext)) {\n    // eslint-disable-next-line @stylistic/js/max-len\n    callback(new TypeError('Peaks.init(): The webAudio.audioContext option must be a valid AudioContext'));\n    return;\n  }\n  var webAudioOptions = options.webAudio;\n  if (webAudioOptions.scale !== options.zoomLevels[0]) {\n    webAudioOptions.scale = options.zoomLevels[0];\n  }\n\n  // If the media element has already selected which source to play, its\n  // currentSrc attribute will contain the source media URL. Otherwise,\n  // we wait for a canplay event to tell us when the media is ready.\n\n  var mediaSourceUrl = self._peaks.options.mediaElement.currentSrc;\n  if (mediaSourceUrl) {\n    self._requestAudioAndBuildWaveformData(mediaSourceUrl, webAudioOptions, options.withCredentials, callback);\n  } else {\n    self._peaks.once('player.canplay', function () {\n      self._requestAudioAndBuildWaveformData(self._peaks.options.mediaElement.currentSrc, webAudioOptions, options.withCredentials, callback);\n    });\n  }\n};\nWaveformBuilder.prototype._buildWaveformDataFromAudioBuffer = function (options, callback) {\n  var webAudioOptions = options.webAudio;\n  if (webAudioOptions.scale !== options.zoomLevels[0]) {\n    webAudioOptions.scale = options.zoomLevels[0];\n  }\n  var webAudioBuilderOptions = {\n    audio_buffer: webAudioOptions.audioBuffer,\n    split_channels: webAudioOptions.multiChannel,\n    scale: webAudioOptions.scale,\n    disable_worker: true\n  };\n  WaveformData.createFromAudio(webAudioBuilderOptions, callback);\n};\n\n/**\n * Fetches the audio content, based on the given options, and creates waveform\n * data using the Web Audio API.\n *\n * @private\n * @param {url} The media source URL\n * @param {WaveformBuilderWebAudioOptions} webAudio\n * @param {Boolean} withCredentials\n * @param {WaveformBuilderInitCallback} callback\n */\n\nWaveformBuilder.prototype._requestAudioAndBuildWaveformData = function (url, webAudio, withCredentials, callback) {\n  var self = this;\n  if (!url) {\n    self._peaks._logger('Peaks.init(): The mediaElement src is invalid');\n    return;\n  }\n  self._xhr = self._createXHR(url, 'arraybuffer', withCredentials, function (event) {\n    if (this.readyState !== 4) {\n      return;\n    }\n\n    // See https://codeberg.org/chrisn/peaks.js/issues/491\n\n    if (this.status !== 200 && !(this.status === 206 && hasValidContentRangeHeader(this))) {\n      callback(new Error('Unable to fetch remote data. HTTP status ' + this.status));\n      return;\n    }\n    self._xhr = null;\n    var webAudioBuilderOptions = {\n      audio_context: webAudio.audioContext,\n      array_buffer: event.target.response,\n      split_channels: webAudio.multiChannel,\n      scale: webAudio.scale\n    };\n    WaveformData.createFromAudio(webAudioBuilderOptions, callback);\n  }, function () {\n    callback(new Error('XHR failed'));\n  }, function () {\n    callback(new Error('XHR aborted'));\n  });\n  self._xhr.send();\n};\nWaveformBuilder.prototype.abort = function () {\n  if (this._xhr) {\n    this._xhr.abort();\n  }\n};\n\n/**\n * @private\n * @param {String} url\n * @param {String} requestType\n * @param {Boolean} withCredentials\n * @param {Function} onLoad\n * @param {Function} onError\n *\n * @returns {XMLHttpRequest}\n */\n\nWaveformBuilder.prototype._createXHR = function (url, requestType, withCredentials, onLoad, onError, onAbort) {\n  var xhr = new XMLHttpRequest();\n\n  // open an XHR request to the data source file\n  xhr.open('GET', url, true);\n  if (isXhr2) {\n    try {\n      xhr.responseType = requestType;\n    } catch (error) {// eslint-disable-line no-unused-vars\n      // Some browsers like Safari 6 do handle XHR2 but not the json\n      // response type, doing only a try/catch fails in IE9\n    }\n  }\n  xhr.onload = onLoad;\n  xhr.onerror = onError;\n  if (isXhr2 && withCredentials) {\n    xhr.withCredentials = true;\n  }\n  xhr.addEventListener('abort', onAbort);\n  return xhr;\n};\n\n/**\n * @file\n *\n * Defines the {@link Peaks} class.\n *\n * @module main\n */\n\n\n/**\n * Initialises a new Peaks instance with default option settings.\n *\n * @class\n * @alias Peaks\n *\n * @param {Object} opts Configuration options\n */\n\nfunction Peaks() {\n  EventEmitter.call(this);\n\n  // Set default options\n  this.options = {\n    zoomLevels: [512, 1024, 2048, 4096],\n    waveformCache: true,\n    mediaElement: null,\n    mediaUrl: null,\n    dataUri: null,\n    withCredentials: false,\n    waveformData: null,\n    webAudio: null,\n    nudgeIncrement: 1.0,\n    pointMarkerColor: '#39cccc',\n    createSegmentMarker: createSegmentMarker,\n    createSegmentLabel: createSegmentLabel,\n    createPointMarker: createPointMarker,\n    // eslint-disable-next-line no-console\n    logger: console.error.bind(console)\n  };\n  return this;\n}\nPeaks.prototype = Object.create(EventEmitter.prototype);\nvar defaultViewOptions = {\n  playheadColor: '#111111',\n  playheadTextColor: '#aaaaaa',\n  playheadBackgroundColor: 'transparent',\n  playheadPadding: 2,\n  playheadWidth: 1,\n  axisGridlineColor: '#cccccc',\n  showAxisLabels: true,\n  axisTopMarkerHeight: 10,\n  axisBottomMarkerHeight: 10,\n  axisLabelColor: '#aaaaaa',\n  fontFamily: 'sans-serif',\n  fontSize: 11,\n  fontStyle: 'normal',\n  timeLabelPrecision: 2,\n  enablePoints: true,\n  enableSegments: true\n};\nvar defaultZoomviewOptions = {\n  // showPlayheadTime:    true,\n  playheadClickTolerance: 3,\n  waveformColor: 'rgba(0, 225, 128, 1)',\n  wheelMode: 'none',\n  autoScroll: true,\n  autoScrollOffset: 100,\n  enableEditing: true\n};\nvar defaultOverviewOptions = {\n  // showPlayheadTime:    false,\n  waveformColor: 'rgba(0, 0, 0, 0.2)',\n  highlightColor: '#aaaaaa',\n  highlightStrokeColor: 'transparent',\n  highlightOpacity: 0.3,\n  highlightOffset: 11,\n  highlightCornerRadius: 2,\n  enableEditing: false\n};\nvar defaultSegmentOptions = {\n  overlay: false,\n  markers: true,\n  startMarkerColor: '#aaaaaa',\n  endMarkerColor: '#aaaaaa',\n  waveformColor: '#0074d9',\n  overlayColor: '#ff0000',\n  overlayOpacity: 0.3,\n  overlayBorderColor: '#ff0000',\n  overlayBorderWidth: 2,\n  overlayCornerRadius: 5,\n  overlayOffset: 25,\n  overlayLabelAlign: 'left',\n  overlayLabelVerticalAlign: 'top',\n  overlayLabelPadding: 8,\n  overlayLabelColor: '#000000',\n  overlayFontFamily: 'sans-serif',\n  overlayFontSize: 12,\n  overlayFontStyle: 'normal'\n};\nvar defaultScrollbarOptions = {\n  color: '#888888',\n  minWidth: 50\n};\nfunction getOverviewOptions(opts) {\n  var overviewOptions = {};\n  if (opts.overview && opts.overview.showPlayheadTime) {\n    overviewOptions.showPlayheadTime = opts.overview.showPlayheadTime;\n  }\n  var optNames = ['container', 'waveformColor', 'playedWaveformColor', 'playheadColor', 'playheadTextColor', 'playheadBackgroundColor', 'playheadPadding', 'playheadWidth', 'formatPlayheadTime', 'timeLabelPrecision', 'axisGridlineColor', 'showAxisLabels', 'axisTopMarkerHeight', 'axisBottomMarkerHeight', 'axisLabelColor', 'formatAxisTime', 'fontFamily', 'fontSize', 'fontStyle', 'highlightColor', 'highlightStrokeColor', 'highlightOpacity', 'highlightCornerRadius', 'highlightOffset', 'enablePoints', 'enableSegments', 'enableEditing'];\n  optNames.forEach(function (optName) {\n    if (opts.overview && objectHasProperty(opts.overview, optName)) {\n      overviewOptions[optName] = opts.overview[optName];\n    } else if (objectHasProperty(opts, optName)) {\n      overviewOptions[optName] = opts[optName];\n    } else if (!objectHasProperty(overviewOptions, optName)) {\n      if (objectHasProperty(defaultOverviewOptions, optName)) {\n        overviewOptions[optName] = defaultOverviewOptions[optName];\n      } else if (objectHasProperty(defaultViewOptions, optName)) {\n        overviewOptions[optName] = defaultViewOptions[optName];\n      }\n    }\n  });\n  return overviewOptions;\n}\nfunction getZoomviewOptions(opts) {\n  var zoomviewOptions = {};\n  if (opts.showPlayheadTime) {\n    zoomviewOptions.showPlayheadTime = opts.showPlayheadTime;\n  } else if (opts.zoomview && opts.zoomview.showPlayheadTime) {\n    zoomviewOptions.showPlayheadTime = opts.zoomview.showPlayheadTime;\n  }\n  var optNames = ['container', 'waveformColor', 'playedWaveformColor', 'playheadColor', 'playheadTextColor', 'playheadBackgroundColor', 'playheadPadding', 'playheadWidth', 'formatPlayheadTime', 'playheadClickTolerance', 'timeLabelPrecision', 'axisGridlineColor', 'showAxisLabels', 'axisTopMarkerHeight', 'axisBottomMarkerHeight', 'axisLabelColor', 'formatAxisTime', 'fontFamily', 'fontSize', 'fontStyle', 'wheelMode', 'autoScroll', 'autoScrollOffset', 'enablePoints', 'enableSegments', 'enableEditing'];\n  optNames.forEach(function (optName) {\n    if (opts.zoomview && objectHasProperty(opts.zoomview, optName)) {\n      zoomviewOptions[optName] = opts.zoomview[optName];\n    } else if (objectHasProperty(opts, optName)) {\n      zoomviewOptions[optName] = opts[optName];\n    } else if (!objectHasProperty(zoomviewOptions, optName)) {\n      if (objectHasProperty(defaultZoomviewOptions, optName)) {\n        zoomviewOptions[optName] = defaultZoomviewOptions[optName];\n      } else if (objectHasProperty(defaultViewOptions, optName)) {\n        zoomviewOptions[optName] = defaultViewOptions[optName];\n      }\n    }\n  });\n  return zoomviewOptions;\n}\nfunction getScrollbarOptions(opts) {\n  if (!objectHasProperty(opts, 'scrollbar')) {\n    return null;\n  }\n  var scrollbarOptions = {};\n  var optNames = ['container', 'color', 'minWidth'];\n  optNames.forEach(function (optName) {\n    if (objectHasProperty(opts.scrollbar, optName)) {\n      scrollbarOptions[optName] = opts.scrollbar[optName];\n    } else {\n      scrollbarOptions[optName] = defaultScrollbarOptions[optName];\n    }\n  });\n  return scrollbarOptions;\n}\nfunction extendOptions(to, from) {\n  for (var key in from) {\n    if (objectHasProperty(from, key) && objectHasProperty(to, key)) {\n      to[key] = from[key];\n    }\n  }\n  return to;\n}\nfunction addSegmentOptions(options, opts) {\n  options.segmentOptions = {};\n  extend(options.segmentOptions, defaultSegmentOptions);\n  if (opts.segmentOptions) {\n    extendOptions(options.segmentOptions, opts.segmentOptions);\n  }\n  options.zoomview.segmentOptions = {};\n  extend(options.zoomview.segmentOptions, options.segmentOptions);\n  if (opts.zoomview && opts.zoomview.segmentOptions) {\n    extendOptions(options.zoomview.segmentOptions, opts.zoomview.segmentOptions);\n  }\n  options.overview.segmentOptions = {};\n  extend(options.overview.segmentOptions, options.segmentOptions);\n  if (opts.overview && opts.overview.segmentOptions) {\n    extendOptions(options.overview.segmentOptions, opts.overview.segmentOptions);\n  }\n}\nfunction checkContainerElements(options) {\n  var zoomviewContainer = options.zoomview.container;\n  var overviewContainer = options.overview.container;\n  if (!isHTMLElement(zoomviewContainer) && !isHTMLElement(overviewContainer)) {\n    // eslint-disable-next-line @stylistic/js/max-len\n    return new TypeError('Peaks.init(): The zoomview and/or overview container options must be valid HTML elements');\n  }\n  if (zoomviewContainer && (zoomviewContainer.clientWidth <= 0 || zoomviewContainer.clientHeight <= 0)) {\n    // eslint-disable-next-line @stylistic/js/max-len\n    return new Error('Peaks.init(): The zoomview container must be visible and have non-zero width and height');\n  }\n  if (overviewContainer && (overviewContainer.clientWidth <= 0 || overviewContainer.clientHeight <= 0)) {\n    // eslint-disable-next-line @stylistic/js/max-len\n    return new Error('Peaks.init(): The overview container must be visible and have non-zero width and height');\n  }\n}\n\n/**\n * Creates and initialises a new Peaks instance with the given options.\n *\n * @param {Object} opts Configuration options\n * @param {Function} callback\n *\n * @return {Peaks}\n */\n\nPeaks.init = function (opts, callback) {\n  if (!callback) {\n    throw new Error('Peaks.init(): Missing callback function');\n  }\n  var instance = new Peaks();\n  var err = instance._setOptions(opts);\n  if (!err) {\n    err = checkContainerElements(instance.options);\n  }\n  if (err) {\n    callback(err);\n    return;\n  }\n  var scrollbarContainer = null;\n  if (instance.options.scrollbar) {\n    scrollbarContainer = instance.options.scrollbar.container;\n    if (!isHTMLElement(scrollbarContainer)) {\n      // eslint-disable-next-line @stylistic/js/max-len\n      callback(new TypeError('Peaks.init(): The scrollbar container option must be a valid HTML element'));\n      return;\n    }\n    if (scrollbarContainer.clientWidth <= 0) {\n      // eslint-disable-next-line @stylistic/js/max-len\n      callback(new TypeError('Peaks.init(): The scrollbar container must be visible and have non-zero width'));\n      return;\n    }\n  }\n  if (opts.keyboard) {\n    instance._keyboardHandler = new KeyboardHandler(instance);\n  }\n  var player = opts.player ? opts.player : new MediaElementPlayer(instance.options.mediaElement);\n  instance.player = new Player(instance, player);\n  instance.segments = new WaveformSegments(instance);\n  instance.points = new WaveformPoints(instance);\n  instance.zoom = new ZoomController(instance, instance.options.zoomLevels);\n  instance.views = new ViewController(instance);\n\n  // Setup the UI components\n  instance._waveformBuilder = new WaveformBuilder(instance);\n  instance.player.init(instance).then(function () {\n    instance._waveformBuilder.init(instance.options, function (err, waveformData) {\n      if (err) {\n        callback(err);\n        return;\n      }\n      err = checkContainerElements(instance.options);\n      if (err) {\n        callback(err);\n        return;\n      }\n      instance._waveformBuilder = null;\n      instance._waveformData = waveformData;\n      var zoomviewContainer = instance.options.zoomview.container;\n      var overviewContainer = instance.options.overview.container;\n      if (zoomviewContainer) {\n        instance.views.createZoomview(zoomviewContainer);\n      }\n      if (overviewContainer) {\n        instance.views.createOverview(overviewContainer);\n      }\n      if (scrollbarContainer) {\n        instance.views.createScrollbar(scrollbarContainer);\n      }\n      if (opts.segments) {\n        instance.segments.add(opts.segments);\n      }\n      if (opts.points) {\n        instance.points.add(opts.points);\n      }\n      if (opts.emitCueEvents) {\n        instance._cueEmitter = new CueEmitter(instance);\n      }\n      callback(null, instance);\n    });\n  }).catch(function (err) {\n    callback(err);\n  });\n};\nPeaks.prototype._setOptions = function (opts) {\n  if (!isObject(opts)) {\n    return new TypeError('Peaks.init(): The options parameter should be an object');\n  }\n  if (!opts.player) {\n    if (!opts.mediaElement) {\n      return new Error('Peaks.init(): Missing mediaElement option');\n    }\n    if (!(opts.mediaElement instanceof HTMLMediaElement)) {\n      return new TypeError('Peaks.init(): The mediaElement option should be an HTMLMediaElement');\n    }\n  }\n  if (opts.logger && !isFunction(opts.logger)) {\n    return new TypeError('Peaks.init(): The logger option should be a function');\n  }\n  if (opts.segments && !Array.isArray(opts.segments)) {\n    return new TypeError('Peaks.init(): options.segments must be an array of segment objects');\n  }\n  if (opts.points && !Array.isArray(opts.points)) {\n    return new TypeError('Peaks.init(): options.points must be an array of point objects');\n  }\n  extendOptions(this.options, opts);\n  this.options.overview = getOverviewOptions(opts);\n  this.options.zoomview = getZoomviewOptions(opts);\n  this.options.scrollbar = getScrollbarOptions(opts);\n  addSegmentOptions(this.options, opts);\n  if (!Array.isArray(this.options.zoomLevels)) {\n    return new TypeError('Peaks.init(): The zoomLevels option should be an array');\n  } else if (this.options.zoomLevels.length === 0) {\n    return new Error('Peaks.init(): The zoomLevels array must not be empty');\n  } else {\n    if (!isInAscendingOrder(this.options.zoomLevels)) {\n      return new Error('Peaks.init(): The zoomLevels array must be sorted in ascending order');\n    }\n  }\n  this._logger = this.options.logger;\n};\n\n/**\n * Remote waveform data options for [Peaks.setSource]{@link Peaks#setSource}.\n *\n * @typedef {Object} RemoteWaveformDataOptions\n * @global\n * @property {String=} arraybuffer\n * @property {String=} json\n */\n\n/**\n * Local waveform data options for [Peaks.setSource]{@link Peaks#setSource}.\n *\n * @typedef {Object} LocalWaveformDataOptions\n * @global\n * @property {ArrayBuffer=} arraybuffer\n * @property {Object=} json\n */\n\n/**\n * Web Audio options for [Peaks.setSource]{@link Peaks#setSource}.\n *\n * @typedef {Object} WebAudioOptions\n * @global\n * @property {AudioContext=} audioContext\n * @property {AudioBuffer=} audioBuffer\n * @property {Number=} scale\n * @property {Boolean=} multiChannel\n */\n\n/**\n * Options for [Peaks.setSource]{@link Peaks#setSource}.\n *\n * @typedef {Object} PeaksSetSourceOptions\n * @global\n * @property {String=} mediaUrl\n * @property {RemoteWaveformDataOptions=} dataUri\n * @property {LocalWaveformDataOptions=} waveformData\n * @property {WebAudioOptions=} webAudio\n * @property {Boolean=} withCredentials\n * @property {Array<Number>=} zoomLevels\n */\n\n/**\n * Changes the audio or video media source associated with the {@link Peaks}\n * instance.\n *\n * @see SetSourceHandler\n *\n * @param {PeaksSetSourceOptions} options\n * @param {Function} callback\n */\n\nPeaks.prototype.setSource = function (options, callback) {\n  var self = this;\n  self.player._setSource(options).then(function () {\n    if (!options.zoomLevels) {\n      options.zoomLevels = self.options.zoomLevels;\n    }\n    self._waveformBuilder = new WaveformBuilder(self);\n    self._waveformBuilder.init(options, function (err, waveformData) {\n      if (err) {\n        callback(err);\n        return;\n      }\n      self._waveformBuilder = null;\n      self._waveformData = waveformData;\n      ['overview', 'zoomview'].forEach(function (viewName) {\n        var view = self.views.getView(viewName);\n        if (view) {\n          view.setWaveformData(waveformData);\n        }\n      });\n      self.zoom.setZoomLevels(options.zoomLevels);\n      callback();\n    });\n  }).catch(function (err) {\n    callback(err);\n  });\n};\nPeaks.prototype.getWaveformData = function () {\n  return this._waveformData;\n};\n\n/**\n * Cleans up a Peaks instance after use.\n */\n\nPeaks.prototype.destroy = function () {\n  if (this._waveformBuilder) {\n    this._waveformBuilder.abort();\n  }\n  if (this._keyboardHandler) {\n    this._keyboardHandler.destroy();\n  }\n  if (this.views) {\n    this.views.destroy();\n  }\n  if (this.player) {\n    this.player.destroy();\n  }\n  if (this._cueEmitter) {\n    this._cueEmitter.destroy();\n  }\n};\n\nexport { Peaks as default };\n"],
  "mappings": "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",
  "names": ["Konva", "pos", "isNumber", "isString", "SET", "events", "nodes", "shapes", "STAGE", "MOUSELEAVE", "MOUSEENTER", "POINTERLEAVE", "POINTERENTER", "events", "time", "idCounter", "Konva", "Konva", "SPACE", "dummyContext", "getDummyContext", "_fillFunc", "_strokeFunc", "lineArray", "channel", "o", "WorkerFactory", "callback", "self", "time", "EventEmitter", "eventNames", "events", "_typeof", "o", "time", "isFinite", "isNullOrUndefined", "requestAnimationFrame", "self", "segment", "get", "pointOptions", "segmentOptions", "filter", "SPACE", "channel", "createSegmentMarker", "resample", "err"]
}
