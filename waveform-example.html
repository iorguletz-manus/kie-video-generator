<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Waveform Example - Current Implementation</title>
  
  <!-- Peaks.js CSS -->
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      padding: 40px;
      background: #f5f5f5;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      padding: 30px;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    
    h1 {
      margin-bottom: 10px;
      color: #333;
    }
    
    .description {
      margin-bottom: 30px;
      color: #666;
      line-height: 1.6;
    }
    
    .video-container {
      margin-bottom: 20px;
    }
    
    video {
      width: 100%;
      max-width: 800px;
      border-radius: 4px;
      background: #000;
    }
    
    /* Waveform Container */
    #waveform-container {
      height: 120px;
      width: 100%;
      border: 1px solid #d1d5db;
      border-radius: 4px;
      background: #ffffff;
      position: relative;
      overflow: hidden;
    }
    
    /* Peaks.js default styles override */
    #waveform-container canvas {
      display: block;
    }
    
    .config-info {
      margin-top: 30px;
      padding: 20px;
      background: #f9fafb;
      border-radius: 4px;
      border: 1px solid #e5e7eb;
    }
    
    .config-info h2 {
      font-size: 18px;
      margin-bottom: 15px;
      color: #374151;
    }
    
    .config-info pre {
      background: #1f2937;
      color: #f3f4f6;
      padding: 15px;
      border-radius: 4px;
      overflow-x: auto;
      font-size: 13px;
      line-height: 1.5;
    }
    
    .section {
      margin-bottom: 20px;
    }
    
    .section h3 {
      font-size: 14px;
      font-weight: 600;
      color: #6b7280;
      margin-bottom: 8px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ðŸŽµ Waveform Example - Current Implementation</h1>
    <div class="description">
      <p>This is the <strong>exact waveform configuration</strong> currently used in the KIE Video Generator app (VideoEditorV2 component).</p>
      <p>Library: <strong>Peaks.js</strong> | Style: Default waveform rendering</p>
    </div>
    
    <div class="video-container">
      <video id="video" controls>
        <source src="https://www.w3schools.com/html/mov_bbb.mp4" type="video/mp4">
        Your browser does not support the video tag.
      </video>
    </div>
    
    <div id="waveform-container"></div>
    
    <div class="config-info">
      <h2>ðŸ“‹ Current Configuration</h2>
      
      <div class="section">
        <h3>HTML Container</h3>
        <pre>&lt;div id="waveform-container"
     style="height: 120px; width: 100%; border: 1px solid #d1d5db; border-radius: 4px;"&gt;
&lt;/div&gt;</pre>
      </div>
      
      <div class="section">
        <h3>Peaks.js Initialization Options</h3>
        <pre>const options = {
  zoomview: {
    container: document.getElementById('waveform-container'),
    waveformColor: '#cccccc',
    playheadColor: 'transparent',
    wheelMode: 'none',
    segmentOptions: {
      startMarkerColor: 'transparent',
      endMarkerColor: 'transparent',
      waveformColor: 'transparent',
      overlayColor: 'transparent',
    },
  },
  mediaElement: videoElement,
  dataUri: {
    json: 'waveform-data.json', // Generated by audiowaveform CLI
  },
  keyboard: true,
  showPlayheadTime: false,
  zoomLevels: [1024, 2048, 4096, 8192, 16384, 32768, 65536, 131072],
  segmentOptions: {
    startMarkerColor: 'transparent',
    endMarkerColor: 'transparent',
    waveformColor: 'transparent',
    overlayColor: 'transparent',
  },
};</pre>
      </div>
      
      <div class="section">
        <h3>Key Styling Properties</h3>
        <pre>â€¢ Container height: 120px
â€¢ Waveform color: #cccccc (light gray)
â€¢ Background: white
â€¢ Border: 1px solid #d1d5db (gray-300)
â€¢ Border radius: 4px
â€¢ Playhead: transparent (hidden)
â€¢ Markers: transparent (custom overlay used instead)</pre>
      </div>
      
      <div class="section">
        <h3>Waveform Data Generation</h3>
        <pre>// Generated server-side with audiowaveform CLI:
audiowaveform -i audio.wav -o waveform.json --pixels-per-second 1000 -b 8

// Result: JSON with amplitude data for Peaks.js rendering</pre>
      </div>
    </div>
  </div>
  
  <!-- Peaks.js Library -->
  <script src="https://cdn.jsdelivr.net/npm/peaks.js@3.4.1/peaks.min.js"></script>
  
  <script>
    // Sample waveform data (minimal example - normally generated by audiowaveform)
    const sampleWaveformData = {
      "version": 2,
      "channels": 1,
      "sample_rate": 48000,
      "samples_per_pixel": 48,
      "bits": 8,
      "length": 1000,
      "data": Array.from({ length: 1000 }, (_, i) => {
        // Generate sample waveform pattern (sine-like)
        const t = i / 1000;
        const amplitude = Math.sin(t * Math.PI * 10) * 0.8 + Math.random() * 0.2;
        return Math.floor(Math.abs(amplitude) * 127);
      })
    };
    
    // Convert to Blob URL for Peaks.js
    const blob = new Blob([JSON.stringify(sampleWaveformData)], { type: 'application/json' });
    const waveformDataUrl = URL.createObjectURL(blob);
    
    // Initialize Peaks.js
    const videoElement = document.getElementById('video');
    const container = document.getElementById('waveform-container');
    
    const options = {
      zoomview: {
        container: container,
        waveformColor: '#cccccc',
        playheadColor: 'transparent',
        wheelMode: 'none',
        segmentOptions: {
          startMarkerColor: 'transparent',
          endMarkerColor: 'transparent',
          waveformColor: 'transparent',
          overlayColor: 'transparent',
        },
      },
      mediaElement: videoElement,
      dataUri: {
        json: waveformDataUrl,
      },
      keyboard: true,
      showPlayheadTime: false,
      zoomLevels: [1024, 2048, 4096, 8192, 16384, 32768, 65536, 131072],
      segmentOptions: {
        startMarkerColor: 'transparent',
        endMarkerColor: 'transparent',
        waveformColor: 'transparent',
        overlayColor: 'transparent',
      },
    };
    
    Peaks.init(options, (err, peaks) => {
      if (err) {
        console.error('Peaks.js initialization error:', err);
        container.innerHTML = '<div style="padding: 20px; color: red;">Error loading waveform. Check console for details.</div>';
        return;
      }
      
      console.log('Peaks.js initialized successfully!');
      console.log('Peaks instance:', peaks);
      
      // Optional: Add a segment for visual reference
      peaks.segments.add({
        startTime: 2,
        endTime: 8,
        editable: false,
        color: 'rgba(59, 130, 246, 0.2)', // Light blue overlay
        labelText: 'Trim Region',
      });
    });
  </script>
</body>
</html>
